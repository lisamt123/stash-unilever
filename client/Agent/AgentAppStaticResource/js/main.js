function Config(configFile){function content(tag,removeMultispaces){var r="";return tag&&tag.firstChild&&tag.firstChild.nodeValue&&(r=tag.firstChild.nodeValue),removeMultispaces&&(r=r.replace(multispaceRe," ")),r}function getArrayValues(tag){for(var childNodes=DOMHelpers.getAllChildElements(tag),returnValue=new Array,i=0;i<childNodes.length;i++){var childNode=childNodes[i];returnValue[childNode.nodeName]=XMLHelpers.nodeToObject(childNode)}return returnValue}function resolveMacrosInString(string,macros){for(i in macros){var value=macros[i];value||(value="");var reString="@"+i+"@",re=new RegExp(reString,"g");string=string.replace(re,value)}return string}function setValue(name,valueToSet){values[name]=valueToSet}function parseConfigXML(configDoc){if(configDoc){var configTag=configDoc.getElementsByTagName("config")[0];if(!configTag)return void alert("no config tag in XML");var tags=configTag.childNodes;index(tags,"")}}function getOuterConfigRequestHandler(){req&&req.readyState==ReadyState.COMPLETED&&(req.status==HttpCode.OK||req.status==HttpCode.LOCAL_OK?(xml=req.responseXML,parseConfigXML(xml),req=null,loadEventHandler()):req.status==HttpCode.NOT_FOUND?alert("config: "+fileName+" not found"):alert("config: an unknown error has occured"))}function index(tags,prefix){if(tags)for(var i=0;i<tags.length;i++){var theTag=tags[i];if(theTag.nodeType==DOMNode.ELEMENT_NODE){var tagName=theTag.nodeName,childNodes=DOMHelpers.getAllChildElements(theTag),datatype=DOMHelpers.getAttributeValue(theTag,"datatype"),removeMultispaces="true"==DOMHelpers.getAttributeValue(theTag,"removeMultispaces");"array"==datatype?setValue(prefix+"."+tagName,getArrayValues(theTag)):0==childNodes.length?setValue(prefix+"."+tagName,content(theTag,removeMultispaces)):""==prefix?index(childNodes,tagName):index(childNodes,prefix+"."+tagName)}}}function loadEventHandler(){for(var i=0;i<funcArray.length;i++)funcArray[i]()}var req,me=this,fileName=configFile,multispaceRe=/\s{2,}/g,values=new Array,xml=null,funcArray=new Array;me.getXML=function(){return xml},me.getValue=function(s,defaultValue){if(values){var theValue=values[s];return null!=theValue?theValue:defaultValue}return defaultValue?defaultValue:null},me.getNormalizedValue=function(s,defaultValue){var crRe=new RegExp("\n","g"),r=me.getValue(s,defaultValue);return"string"==typeof r?r.replace(crRe," "):r},me.getScriptedValue=function(s,macros,defaultValue){var r=me.getNormalizedValue(s,defaultValue);switch(typeof r){case"string":return resolveMacrosInString(r,macros);case"object":var arr=me.getValue(s,defaultValue),cloneArr=new Array;for(var i in arr){var obj=arr[i],cloneObj=new Object;for(var property in obj)"string"==typeof obj[property]&&(cloneObj[property]=resolveMacrosInString(obj[property],macros));cloneArr[i]=cloneObj}return cloneArr;default:return null}},me.getScriptedValueByPriority=function(newMacro,oldMacro,macros,defaultValue){var newMacroValue=me.getScriptedValue(newMacro,macros,defaultValue);return newMacroValue?newMacroValue:me.getScriptedValue(oldMacro,macros,defaultValue)},me.getIntegerValue=function(s,defaultValue){return parseInt(me.getValue(s,defaultValue))},me.init=function(){fileName=configFile,req=XMLHelpers.getXMLHttpRequest(fileName,getOuterConfigRequestHandler,"GET","",!1),getOuterConfigRequestHandler()},me.addLoadEvent=function(func){funcArray.push(func)};var StringHelpers=new function(){var me=this;me.initWhitespaceRe=/^\s\s*/,me.endWhitespaceRe=/\s\s*$/,me.whitespaceRe=/\s/,me.uncommentHTML=function(s){return-1!=s.indexOf("-->")&&-1!=s.indexOf("<!--")?s.replace("<!--","").replace("-->",""):s}},XMLHelpers=new function(){var me=this,JSPcommentRe=new RegExp("<%(--)?([\\w\\W]*?)(--)?%>","g"),beginningHTMLCommentRe=new RegExp("<!--"),endHTMLCommentRe=new RegExp("-->");me.getXMLHttpRequest=function(url,processReqChange){var req;if(window.XMLHttpRequest)req=new XMLHttpRequest;else{if(!window.ActiveXObject)return null;try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(ex){req=new ActiveXObject("Microsoft.XMLHTTP")}}return req.onreadystatechange=processReqChange,req.open("GET",url,!1),req.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),req.send(""),req},me.nodeToObject=function(node){for(var descendants=node.childNodes,result=new Object,i=0;i<descendants.length;i++){var descendant=descendants[i];descendant.nodeType==DOMNode.ELEMENT_NODE&&(result[descendant.nodeName]=DOMHelpers.getTextContent(descendant))}return result},me.parseXMLDataIsland=function(obj){return me.parseXML(obj.innerHTML.replace(JSPcommentRe,"").replace(beginningHTMLCommentRe,"").replace(endHTMLCommentRe,""))},me.parseXML=function(xmlString){var myDocument;if(document.implementation&&document.implementation.createDocument){var parser=new DOMParser;myDocument=parser.parseFromString(xmlString,"text/xml")}else window.ActiveXObject&&(myDocument=new ActiveXObject("Microsoft.XMLDOM"),myDocument.async="false",myDocument.loadXML(xmlString));return myDocument}},DOMHelpers=new function(){var me=this;me.getAllChildElements=function(obj){for(var allNodes=obj.childNodes,childElements=new Array,i=0;i<allNodes.length;i++){var node=allNodes[i];node.nodeType==DOMNode.ELEMENT_NODE&&childElements.push(node)}return childElements},me.getAttributeByName=function(obj,attrName){var i,attributes=obj.attributes;for(i=0;i<attributes.length;i++){var attr=attributes[i];if(attr.nodeName==attrName&&attr.specified)return attr}return null},me.getAttributeValue=function(obj,attrName){var attr=me.getAttributeByName(obj,attrName);return null!=attr?attr.nodeValue:null},me.getTextContent=function(tag){if(!tag||!tag.firstChild)return"";for(var children=tag.childNodes,s="",i=0;i<children.length;i++){var child=children[i],nodeType=child.nodeType;(nodeType==DOMNode.TEXT_NODE||nodeType==DOMNode.CDATA_SECTION_NODE)&&(s+=child.nodeValue)}return s}},DOMNode=new function(){this.ELEMENT_NODE=1,this.ATTRIBUTE_NODE=2,this.TEXT_NODE=3,this.CDATA_SECTION_NODE=4,this.ENTITY_REFERENCE_NODE=5,this.ENTITY_NODE=6,this.PROCESSING_INSTRUCTION_NODE=7,this.COMMENT_NODE=8,this.DOCUMENT_NODE=9,this.DOCUMENT_TYPE_NODE=10,this.DOCUMENT_FRAGMENT_NODE=11,this.NOTATION_NODE=12},ReadyState=new function(){var me=this;me.UNINITIALIZED=0,me.LOADING=1,me.LOADED=2,me.INTERACTIVE=3,me.COMPLETED=4},HttpCode=new function(){var me=this;me.LOCAL_OK=0,me.CONTINUE=100,me.SWITCHING_PROTOCOLS=101,me.PROCESSING=102,me.OK=200,me.CREATED=201,me.ACCEPTED=202,me.NONAUTHORITATIVE_INFO=203,me.NO_CONTENT=204,me.RESET_CONTENT=205,me.PARTIAL_CONTENT=206,me.MULTI_STATUS=207,me.MULTIPLE_CHOICES=300,me.MOVED_PERMANENTLY=301,me.FOUND=302,me.SEE_OTHER=303,me.NOT_MODIFIED=304,me.USE_PROXY=305,me.SWITCH_PROXY,me.TEMPORARY_REDIRECT=307,me.BAD_REQUEST=400,me.UNAUTHORIZED=401,me.PAYMENT_REQUIRED=402,me.FORBIDDEN=403,me.NOT_FOUND=404,me.METHOD_NOT_ALLOWED=405,me.NOT_ACCEPTABLE=406,me.PROXY_AUTHENTICATION=407,me.REQUEST_TIMEOUT=408,me.CONFLICT=409,me.GONE=410,me.LENGTH_REQUIRED=411,me.PRECONDITION_FAILED=412,me.REQUEST_ENTITY_TOO_LARGE=413,me.REQUEST_URI_TOO_LONG=414,me.UNSUPPORTED_MEDIA_TYPE=415,me.REQUESTED_RANGE_NOT_SATISFIABLE=416,me.EXPECTATION_FAILED=417,me.UNPROCESSABLE_ENTITY=422,me.LOCKED=423,me.FAILED_DEPENDENCY=424,me.UNORDERED_COLLECTION=425,me.UPGRADE_REQUIRED=426,me.RETRY_WITH=449,me.INTERNAL_SERVER_ERROR=500,me.NOT_IMPLEMENTED=501,me.BAD_GATEWAY=502,me.SERVICE_UNAVAILABLE=503,me.GATEWAY_TIMEOUT=504,me.HTTP_VERSION_NOT_SUPPORTED=505,me.INSUFFICIENT_STORAGE=507,me.BANDWIDTH_LIMIT_EXCEEDED=509,me.isInformational=function(n){return n>=100&&199>=n},me.isSuccessful=function(n){return n>=200&&299>=n},me.isRedirection=function(n){return n>=300&&399>=n},me.isClientError=function(n){return n>=400&&499>=n},me.isServerError=function(n){return n>=500&&599>=n}};String.prototype.trim=function(){var str=this;if(this.length>6e3){str=this.replace(StringHelpers.initWhitespaceRe,"");for(var i=str.length;StringHelpers.whitespaceRe.test(str.charAt(--i)););return str.slice(0,i+1)}return this.replace(StringHelpers.initWhitespaceRe,"").replace(StringHelpers.endWhitespaceRe,"")}}function init_map(){findUserLocation()}function findUserLocation(){"undefined"!=typeof sforce&&null!=sforce?navigator.geolocation?navigator.geolocation.getCurrentPosition(function(position){currentLatitude=position.coords.latitude,currentLongitude=position.coords.longitude,codeLatLng()},function(position){alert("Geolocation not available")}):alert("navigator.geolocation is not available"):(console.log("mocking a location for browser session"),currentLatitude=52.1899,currentLongitude=.1253,codeLatLng())}function codeLatLng(){currentlocation=new google.maps.LatLng(currentLatitude,currentLongitude);var mapOptions={zoom:13,center:currentlocation,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map"),mapOptions),geocoder.geocode({latLng:currentlocation},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results[1]){marker=new google.maps.Marker({position:currentlocation,map:map,icon:"https://maps.google.com/mapfiles/arrow.png",title:"You are Here"}),map.setCenter(currentlocation);var address_components=results[1].address_components,components={};jQuery.each(address_components,function(k,v1){jQuery.each(v1.types,function(k2,v2){components[v2]=v1.long_name,"locality"==v2&&(townName=v1.long_name),"country"==v2&&(countryValue=v1.long_name)})}),infowindow.setContent(results[1].formatted_address),infowindow.open(map,marker)}else alert("No results found");else alert("Geocoder failed due to: "+status)})}define("config-js",function(){}),define("module/module",["angular","angular-resource","angular-ui-router","angular-animate","angular-growl","ui-bootstrap"],function(angular){return angular.module("myApp",["ui.router","ngAnimate","angular-growl","ui.bootstrap"])}),define("beans/agentReportForm",[],function(){function agentForm(reportName,reportDesc,unileverBrandId,retailer,reportinOn,countryId,town,longitude,latitude,contentDocumentId,userSelectedTag,topicSelctedTag,clusterId){if(!(this instanceof agentForm))throw new TypeError("agentForm constructor cannot be called as a function.");this.ReportName=reportName,this.ReportDesc=reportDesc,this.UnileverBrandId=unileverBrandId,this.Retailer=retailer,this.ReportingOn=reportinOn,this.CountryId=countryId,this.Town=town,this.Longitude=longitude,this.Latitude=latitude,this.ContentDocumentId=contentDocumentId,this.usertomentionIds=userSelectedTag,this.topicIds=topicSelctedTag,this.ClusterId=clusterId}return agentForm.prototype={constructor:agentForm,setReportName:function(reportName){this.ReportName=reportName},setReportDesc:function(reportDesc){this.ReportDesc=reportDesc},setUnileverBrandId:function(unileverBrandId){this.UnileverBrandId=unileverBrandId},setRetailer:function(retailer){this.Retailer=retailer},setReportingOn:function(reportinOn){this.ReportingOn=reportinOn},setCountryId:function(countryId){this.CountryId=countryId},setTown:function(town){this.Town=town},setLongitude:function(longitude){this.Longitude=longitude},setLatitude:function(latitude){this.Latitude=latitude},setContentDocumentId:function(contentDocumentId){this.ContentDocumentId=contentDocumentId},setUsertomentionIds:function(userSelectedTag){this.usertomentionIds=userSelectedTag},setTopicIds:function(topicSelctedTag){this.topicIds=topicSelctedTag},setClusterId:function(clusterId){this.ClusterId=clusterId},toRequest:function(){var agentFormJson=new Object;return agentFormJson.agentReportToInsert=this,agentFormJson}},agentForm}),define("beans/getUserListBean",[],function(){function getUserListToSearch(searchTerm,searchTopic){if(!(this instanceof getUserListToSearch))throw new TypeError("agentForm constructor cannot be called as a function.");this.searchString=searchTerm,this.searchType=searchTopic}return getUserListToSearch.prototype={constructor:getUserListToSearch,setSearchString:function(searchTerm){this.SearchString=searchTerm},setSearchType:function(searchTopic){this.SearchType=searchTopic},toRequest:function(){var getUserListReqJson=new Object;return getUserListReqJson.agentReportToInsert=this,getUserListReqJson}},getUserListToSearch}),define("directive/agentReportAutocompleteDirective",["require","module/module"],function(require){var myApp=require("module/module");myApp.directive("autocomplete",function($timeout){var index=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect",selecteddata:"=selData",autocompleteRequired:"=",brandFlag:"=brandFlag",errMsg:"=errorMsg",reterrMsg:"=retMsg",retailerdata:"=retData"},controller:["$scope",function($scope){$scope.selectedIndex=-1,$scope.initLock=!0,$scope.searchParamEnterd=$scope.searchParam,$scope.setIndex=function(i){$scope.selectedIndex=parseInt(i)},this.setIndex=function(i){$scope.setIndex(i),$scope.$apply()},$scope.getIndex=function(i){return $scope.selectedIndex};var watching=!0;$scope.completing=!1,$scope.$watch("searchParam",function(newValue,oldValue){$scope.showList=!0,oldValue===newValue||!oldValue&&$scope.initLock||(watching&&"undefined"!=typeof $scope.searchParam&&null!==$scope.searchParam&&($scope.completing=!0,$scope.searchFilter=$scope.searchParam,$scope.selectedIndex=-1),$scope.onType&&$scope.searchParam.length?$scope.onType($scope.searchParam):($scope.onType(),$scope.suggestions=void 0))}),this.preSelect=function(suggestion){watching=!1,$scope.$apply(),watching=!0},$scope.preSelect=this.preSelect,this.preSelectOff=function(){watching=!0},$scope.preSelectOff=this.preSelectOff,$scope.select=function(suggestion){suggestion&&($scope.searchParam=suggestion,$scope.searchFilter=suggestion,$scope.onSelect&&$scope.onSelect(suggestion),"true"==$scope.brandFlag?$scope.selecteddata($scope.searchParam):$scope.retailerdata($scope.searchParam)),watching=!1,$scope.completing=!1,setTimeout(function(){watching=!0},1e3),$scope.setIndex(-1)},$scope.errorMsg=!1,$scope.matchDataVal=function(){if($scope.blurCalled=!0,null!=$scope.suggestions)for(var i=0;i<$scope.suggestions.length;i++){if($scope.listName=$scope.suggestions[i].Name,$scope.searchParam==$scope.listName||""==$scope.searchParam){$scope.errorMsg=!1,"true"==$scope.brandFlag?$scope.errMsg($scope.errorMsg):$scope.reterrMsg($scope.errorMsg),console.log(" equal  list");break}$scope.errorMsg=!0,"true"==$scope.brandFlag?$scope.errMsg($scope.errorMsg):$scope.reterrMsg($scope.errorMsg),console.log("please enter the value from list")}}}],link:function(scope,element,attrs){setTimeout(function(){scope.initLock=!1,scope.$apply()},250);var attr="";scope.attrs={placeholder:"start typing...","class":"",id:"",inputclass:"",inputid:""};for(var a in attrs)attr=a.replace("attr","").toLowerCase(),0===a.indexOf("attr")&&(scope.attrs[attr]=attrs[a]);attrs.clickActivation&&(element[0].onclick=function(e){scope.searchParam||setTimeout(function(){scope.completing=!0,scope.$apply()},200)});var key={left:37,up:38,right:39,down:40,enter:13,esc:27,tab:9};document.addEventListener("keydown",function(e){var keycode=e.keyCode||e.which;switch(keycode){case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}},!0),document.addEventListener("mouseup",function(e){setTimeout(function(){scope.errorMsg=!1,scope.select(),scope.setIndex(-1),scope.showList=!1,scope.$apply()},150)}),element[0].addEventListener("keydown",function(e){scope.hovered=!1;var keycode=e.keyCode||e.which,l=angular.element(this).find("li").length;if(scope.completing&&0!=l){switch(keycode){case key.up:if(index=scope.getIndex()-1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text()),scope.$apply();break;case key.down:if(index=scope.getIndex()+1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff(),scope.$apply();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text());break;case key.left:break;case key.right:case key.enter:case key.tab:index=scope.getIndex(),-1!==index?(scope.select(angular.element(angular.element(this).find("li")[index]).text()),keycode==key.enter&&e.preventDefault()):keycode==key.enter&&scope.select(),scope.setIndex(-1),scope.$apply();break;case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}return 13==keycode?void setTimeout(function(){scope.select(),scope.setIndex(-1),scope.showList=!1,scope.$apply()},150):void 0}})},template:'        <div class="autocomplete {{ attrs.class }}" id="{{ attrs.id }}">          <input                                  class="form-control"            type="text"            ng-model="searchParam"			ng-class="{invalidbox : errorMsg}"			ng-blur="matchDataVal()"			placeholder="{{ attrs.placeholder }}"            class="{{ attrs.inputclass }}"            id="{{ attrs.inputid }}"            ng-required="{{ autocompleteRequired }}" />          <ul ng-if="searchFilter && showList" class="barndList">            <li              ng-repeat="suggestion in suggestions  | filter:searchFilter  track by $index "              index="{{ $index }}"              val=" suggestion.Name "              ng-class="{activeList: ($index === selectedIndex)}"              ng-click="select(suggestion.Name)"			  ng-mouseover="setIndex($index)">{{suggestion.Name}}</li>          </ul>        </div>'}}),myApp.filter("unique",function(){return function(arr,field){var i,o={},l=arr.length,r=[];for(i=0;l>i;i+=1)o[arr[i][field]]=arr[i];for(i in o)r.push(o[i]);return r}}),myApp.filter("highlight",["$sce",function($sce){return function(input,searchParam){if("function"==typeof input)return"";if(searchParam){var words=searchParam;exp=new RegExp(words,"gi"),words.length&&(input=input.replace(exp,"<span style='color:red'>$1</span>"))}return $sce.trustAsHtml(input)}}]),myApp.directive("suggestion",function(){return{restrict:"A",require:"^autocomplete",link:function(scope,element,attrs,autoCtrl){element.bind("mouseenter",function(){autoCtrl.preSelect(attrs.val),autoCtrl.setIndex(attrs.index)}),element.bind("mouseleave",function(){autoCtrl.preSelectOff()})}}})}),define("directive/autoCompleteStandardDirective",["require","module/module"],function(require){var myApp=require("module/module");myApp.directive("typeahead",function($timeout){var index=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect",selectedtagdata:"=selData",autocompleteRequired:"=",brandFlag:"=brandFlag",errMsg:"=errorMsg",reterrMsg:"=retMsg",retailerdata:"=retData",userTagsData:"=utagdata",userTopicsData:"=utopicdata"},controller:["$scope",function($scope){console.log("Suggessions:=====>"+$scope.suggestions),$scope.selectedIndex=-1,$scope.initLock=!0,$scope.searchParamEnterd=$scope.searchParam,$scope.setIndex=function(i){$scope.selectedIndex=parseInt(i)},this.setIndex=function(i){$scope.setIndex(i),$scope.$apply()},$scope.getIndex=function(i){return $scope.selectedIndex};var watching=!0;$scope.completing=!1,$scope.$watch("searchParam",function(newValue,oldValue){$scope.showList=!0,oldValue===newValue||!oldValue&&$scope.initLock||(watching&&"undefined"!=typeof $scope.searchParam&&null!==$scope.searchParam&&($scope.completing=!0,$scope.searchFilter=$scope.searchParam,$scope.selectedIndex=-1),$scope.onType&&$scope.searchParam.length?(console.log("OnTypeDirectives:=====>"+$scope.suggestions),$scope.onType($scope.searchParam)):($scope.onType(),$scope.suggestions=void 0))}),this.preSelect=function(suggestion){watching=!1,$scope.$apply(),watching=!0},$scope.preSelect=this.preSelect,this.preSelectOff=function(){watching=!0},$scope.preSelectOff=this.preSelectOff,$scope.select=function(suggestion){suggestion&&($scope.searchParam=suggestion,$scope.searchFilter=suggestion,$scope.onSelect&&$scope.onSelect(suggestion),$scope.selectedtagdata($scope.searchParam)),watching=!1,$scope.completing=!1,setTimeout(function(){watching=!0},1e3),$scope.setIndex(-1)},$scope.errorMsg=!1,$scope.matchDataVal=function(){}}],link:function(scope,element,attrs){setTimeout(function(){scope.initLock=!1,scope.$apply()},250);var attr="";scope.attrs={placeholder:"start typing...","class":"",id:"",inputclass:"",inputid:""};for(var a in attrs)attr=a.replace("attr","").toLowerCase(),0===a.indexOf("attr")&&(scope.attrs[attr]=attrs[a]);attrs.clickActivation&&(element[0].onclick=function(e){scope.searchParam||setTimeout(function(){scope.completing=!0,scope.$apply()},200)});var key={left:37,up:38,right:39,down:40,enter:13,esc:27,tab:9};document.addEventListener("keydown",function(e){var keycode=e.keyCode||e.which;switch(keycode){case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}},!0),document.addEventListener("mouseup",function(e){setTimeout(function(){scope.errorMsg=!1,scope.select(),scope.setIndex(-1),scope.showList=!1,scope.$apply()},150)}),element[0].addEventListener("keydown",function(e){scope.hovered=!1;var keycode=e.keyCode||e.which,l=angular.element(this).find("li").length;if(scope.completing&&0!=l){switch(keycode){case key.up:if(index=scope.getIndex()-1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text()),scope.$apply();break;case key.down:if(index=scope.getIndex()+1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff(),scope.$apply();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text());break;case key.left:break;case key.right:case key.enter:case key.tab:index=scope.getIndex(),-1!==index?(scope.select(angular.element(angular.element(this).find("li")[index]).text()),keycode==key.enter&&e.preventDefault()):keycode==key.enter&&scope.select(),scope.setIndex(-1),scope.$apply();break;case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}return 13==keycode?void setTimeout(function(){scope.select(),scope.setIndex(-1),scope.showList=!1,scope.$apply()},150):void 0}})},template:'        <div class="autocomplete {{ attrs.class }}" id="{{ attrs.id }}">          <input                                  class="form-control"            type="text"            ng-model="searchParam"			ng-class="{invalidbox : errorMsg}"			ng-blur="matchDataVal()"			placeholder="{{ attrs.placeholder }}"            class="{{ attrs.inputclass }}"            id="{{ attrs.inputid }}"            ng-required="{{ autocompleteRequired }}" />          <ul ng-if="showList" class="barndList">            <li              ng-repeat="suggestion in suggestions"              index="{{ $index }}"              val=" suggestion.Name "              ng-class="{activeList: ($index === selectedIndex)}"              ng-click="select(suggestion.Name)"			  ng-mouseover="setIndex($index)">{{suggestion.Name}}</li>          </ul>        </div>'}}),myApp.filter("unique",function(){return function(arr,field){var i,o={},l=arr.length,r=[];for(i=0;l>i;i+=1)o[arr[i][field]]=arr[i];for(i in o)r.push(o[i]);return r}}),myApp.filter("highlight",["$sce",function($sce){return function(input,searchParam){if("function"==typeof input)return"";if(searchParam){var words=searchParam;exp=new RegExp(words,"gi"),words.length&&(input=input.replace(exp,"<span style='color:red'>$1</span>"))}return $sce.trustAsHtml(input)}}]),myApp.directive("suggestion",function(){return{restrict:"A",require:"^autocomplete",link:function(scope,element,attrs,autoCtrl){element.bind("mouseenter",function(){autoCtrl.preSelect(attrs.val),autoCtrl.setIndex(attrs.index)}),element.bind("mouseleave",function(){autoCtrl.preSelectOff()})}}})}),define("helper/serviceHelper",["require","module/module"],function(require){var myApp=require("module/module");myApp.factory("serviceHelper",function(growl){var statusErrorMap={400:"1. Exception occured. Please contact system admin.",401:"2. Exception occured. Please contact system admin.",403:"3. Exception occured. Please contact system admin.",500:"4. Exception occured. Please contact system admin.",503:"5. Exception occured. Please contact system admin."},parseClientError=function(status,exception){var message;return status?(message=statusErrorMap[status],message||(message="Unknown Error \n.")):message="parsererror"==exception?"Error.\nParsing JSON Request failed.":"timeout"==exception?"Request Time out.":"abort"==exception?"Request was aborted by the server":0===status?"Not connect. Verify Network.":"Unknown Error \n.",message},isServerError=function(status){var hasError=!1;return(404==status||400==status)&&(hasError=!0),hasError},displayServiceError=function(data){data&&isServerError(data.StatusCode)&&(data.ErrorMessage?growl.error(data.ErrorMessage,{referenceId:999,ttl:1e4,clear:!0}):growl.error(config.getValue("alertMessages.serviceError"),{referenceId:999,ttl:1e4,clear:!0}))},displayServiceFailedError=function(jqXHR,exception){if(jqXHR.status&&exception){var message=parseClientError(jqXHR.status,exception);growl.error(message,{referenceId:999,ttl:1e4,clear:!0})}else growl.error(config.getValue("alertMessages.serviceError"),{referenceId:999,ttl:1e4,clear:!0})};return{invokeService:function(data,path,method,successCB,errorCB,hideErrorMsg){console.log("Invoke Request:====>"+JSON.stringify(data)),remoteTKClient.invokeService(data,path,method,function(data){console.log("Remote TK Invoke Request:====>"+JSON.stringify(data)),hideErrorMsg||displayServiceError(data),successCB(data)},function(jqXHR,exception){displayServiceFailedError(jqXHR,exception),errorCB(jqXHR)})},invokeServiceWithURLParameter:function(data,path,method,urlParameter,successCB,errorCB,hideErrorMsg){remoteTKClient.invokeServiceWithURLParameter(data,path,method,urlParameter,function(data){hideErrorMsg||displayServiceError(data),successCB(data)},function(jqXHR,exception){displayServiceFailedError(jqXHR,exception),errorCB(jqXHR)})}}})}),define("service/angentRepFormService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("agentReprotData",function($http,$q,$rootScope,serviceHelper){var agentRepReqJson=null,agentRepdata=null;return{setAgentReportReq:function(agentRepReq){agentRepReqJson=agentRepReq},setAgentRepData:function(successCB,errorCB){var url=config.getValue("webServiceEndpoints.agentBrandListGetService");serviceHelper.invokeService("",url,"POST",function(data){agentRepdata=data,successCB(data)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)}}})}),define("service/angentRequestFormService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("agentReportReqFormData",function($http,$q,$rootScope,serviceHelper){var agentRepReqJson=null,agentRepdata=null;return{setAgentReportReqJson:function(agentRepReq){agentRepReqJson=agentRepReq},setAgentRequestData:function(successCB,errorCB,scope){var stringifiedJSON=JSON.stringify(agentRepReqJson);console.log("====REquest Service==="+stringifiedJSON);var url=config.getValue("webServiceEndpoints.agentReportService");serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){agentRepdata=data,successCB(data)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getAgentData:function(data){return agentRepdata}}})}),define("service/reportDisplayService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("reportDisplayDataService",function($http,$q,$rootScope,serviceHelper){var reportTypeVal,sortTypeVal,clickTypeVal,reportDispRepdata=null,reportDispReqJson=null;return{setReportTypeReq:function(reportReqRes){reportDispReqJson=reportReqRes},setReportDisplayData:function(successCB,errorCB){"myReport"==reportTypeVal||"filterReports"==reportTypeVal||"showMostLiked"==sortTypeVal||"applyFilter"==reportTypeVal||"AllReports"==reportTypeVal?stringifiedJSON=JSON.stringify(reportDispReqJson):stringifiedJSON="";var url;url="showMostLiked"==sortTypeVal?config.getValue("webServiceEndpoints.reportDispalyService"):config.getValue("webServiceEndpoints.reportDispalyService"),console.log("Report===>"+stringifiedJSON),serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){reportDispRepdata=data,console.log("====Report data ===>"+JSON.stringify(data)),successCB(reportDispRepdata)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},setReportLikeUpdate:function(successCB,errorCB){var url=config.getValue("webServiceEndpoints.updateAgentReportLike"),stringifiedJSON=JSON.stringify(reportDispReqJson);console.log("Request"+JSON.stringify(reportDispReqJson)),serviceHelper.invokeService(stringifiedJSON,url,"post",function(data){console.log("data"+JSON.stringify(data)),successCB(data)},function(jqXHR){console.log("Like service Error"),$rootScope.$apply(),errorCB()},!0)},setReportUnLikeUpdate:function(successCB,errorCB){var url=config.getValue("webServiceEndpoints.updateAgentReportUnLike"),stringifiedJSON=JSON.stringify(reportDispReqJson);console.log("unlikeRequest"+JSON.stringify(reportDispReqJson)),serviceHelper.invokeService(stringifiedJSON,url,"post",function(data){successCB(data)},function(jqXHR){console.log("Like service Error"),$rootScope.$apply(),errorCB()},!0)},getReportDispData:function(data){return reportDispRepdata},setReportType:function(reportType){reportTypeVal=reportType},getReportType:function(){return reportTypeVal},setSortType:function(reportType){sortTypeVal=reportType},getSortType:function(){return sortTypeVal},setClickedClass:function(clickVal){clickTypeVal=clickVal},getClickedClass:function(){return clickTypeVal}}})}),define("service/getUserListService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("getUserListRequestService",function($http,$q,$rootScope,serviceHelper){var typeaHeadParam=null,userListData=null;return{setUserListReqJson:function(typeaHeadText){typeaHeadParam=typeaHeadText,console.log("Service Data REquest:====>"+JSON.stringify(typeaHeadText))},setUserListRequestData:function(successCB,errorCB,scope){var stringifiedJSON=JSON.stringify(typeaHeadParam);console.log("Before Invoke Service:====>"+stringifiedJSON);var url=config.getValue("webServiceEndpoints.getUserListService");serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){console.log("UserListData:====>"+JSON.stringify(data)),userListData=data,successCB(userListData)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getUserListData:function(data){return userListData}}})}),define("controller/confirmationModalCtrl",["require","module/module"],function(require){var myApp=require("module/module");myApp.controller("confirmationModalCtrl",function($scope,$modalInstance,overlayDetails,$rootScope,$timeout){$scope.overlayDetails=overlayDetails,$timeout(function(){$modalInstance.close()},config.getValue("global.timeout"))})});var countryValue=null,townName=null,currentlocation,currentLatitude=0,currentLongitude=0,cityMap=null,countryMap=null,rtId,rtName,map,geocoder=new google.maps.Geocoder,marker,infowindow=new google.maps.InfoWindow;define("lib/agentReportCreate",function(){}),define("controller/agentReportCreateController",["require","module/module","beans/agentReportForm","beans/getUserListBean","directive/agentReportAutocompleteDirective","directive/autoCompleteStandardDirective","service/angentRepFormService","service/angentRequestFormService","service/reportDisplayService","service/getUserListService","controller/confirmationModalCtrl","lib/agentReportCreate"],function(require){var myApp=require("module/module"),agentReq=require("beans/agentReportForm"),userListReq=require("beans/getUserListBean");require("directive/agentReportAutocompleteDirective"),require("directive/autoCompleteStandardDirective"),require("service/angentRepFormService"),
require("service/angentRequestFormService"),require("service/reportDisplayService"),require("service/getUserListService"),require("controller/confirmationModalCtrl"),require("lib/agentReportCreate"),myApp.controller("agentReportCreateController",["$scope","$rootScope","$location","$filter","reportDisplayDataService","agentReprotData","$modal","$timeout","agentReportReqFormData","growl","getUserListRequestService",function($scope,$rootScope,$location,$filter,reportDisplayDataService,agentReprotData,$modal,$timeout,agentReportReqFormData,growl,getUserListRequestService){$scope.safariBroser=!1,$rootScope.rootVars={},$rootScope.rootVars.dataLoading=!1,$scope.mapHidden=!0,$scope.invalidMsg=!1,$scope.invalidMsg1=!1,$scope.invalidClusterMsg=!1,$scope.matchRetword=!1,$scope.matchWord=!1,$scope.brandId,$scope.retailerId,$scope.countryId,$scope.report,$scope.isClusterIdNull=!1,$scope.afterSubmitForm=!1,$scope.isGlobalCountry=!1;var agentRdata=null;$scope.autoCompleteUserListData=null,$scope.tagsData={},Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0&&($scope.safariBroser=!0),agentReprotData.setAgentRepData(function(data){if($rootScope.rootVars.dataLoading=!1,agentRdata=data,data&&null!=data.objGetAgentDataResponse){$scope.uniliverBrandLists=$filter("orderBy")(data.objGetAgentDataResponse.unileverBrandList,"Name"),$scope.retailerLists=$filter("orderBy")(data.objGetAgentDataResponse.unileverRetailerList,"Name"),$scope.reportList=["Select reporting on"].concat(data.objGetAgentDataResponse.reportingOnPicklistValues),$scope.reportlist=$scope.reportList[0],$scope.sortedCountry=$filter("orderBy")(data.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry),$scope.selectedcountry=$scope.Country[0];for(var i=0;i<$scope.Country.length;i++)$scope.countryId=$scope.Country[i].Id}else growl.error("No Data found");null!=data.objGetAgentDataResponse.clusterList&&($scope.sortedClusterList=$filter("orderBy")(data.objGetAgentDataResponse.clusterList,"Name"),$scope.clusterList=[{Id:"",Name:"Select a cluster"}].concat($scope.sortedClusterList),$scope.selectedCluster=$scope.clusterList[0]),$scope.showMap(),$scope.$apply()},function(){console.log("error")}),$scope.selectedCountryList=function(){for(var countryArr=[],i=0;i<agentRdata.objGetAgentDataResponse.countryList.length;i++)$scope.selectedCluster.Id===agentRdata.objGetAgentDataResponse.countryList[i].Cluster_Id__c&&(countryArr=[{Id:agentRdata.objGetAgentDataResponse.countryList[i].Id,Name:agentRdata.objGetAgentDataResponse.countryList[i].Name}].concat(countryArr));$scope.sortedCountry=$filter("orderBy")(countryArr,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry),$scope.selectedCluster==$scope.clusterList[0]&&($scope.sortedCountry1=$filter("orderBy")(agentRdata.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry1),$scope.selectedcountry=$scope.Country[0]),$scope.selectedcountry=$scope.Country[0];for(var i=0;i<$scope.Country.length;i++)$scope.countryId=$scope.Country[i].Id;"Global"==$scope.selectedCluster.Name?($scope.isClusterIdNull=!0,$scope.invalidMsg=!1,$scope.report.town=""):$scope.isClusterIdNull=!1},$scope.uniliverBrand=function(typedthings){if(!typedthings)return void($scope.agentUniliverBrand=void 0);if($scope.uniliverdata.length>=3){$scope.agentUniliverBrand=$scope.uniliverBrandLists,$scope.brandValueId=getBrandValueId($scope.agentUniliverBrand);for(var i=0;i<$scope.agentUniliverBrand.length;i++)$scope.brandId=$scope.agentUniliverBrand[i].Id}else $scope.agentUniliverBrand=""},$scope.uniliverRetailer=function(typedthings){if($scope.Retailer.length>=3){$scope.uniliverRetailerData=$scope.retailerLists,$scope.retailerValueId=getRetailerValueId($scope.uniliverRetailerData);for(var i=0;i<$scope.uniliverRetailerData.length;i++)$scope.retailerId=$scope.uniliverRetailerData[i].Id}else $scope.uniliverRetailerData=""},$scope.callJQueryBtn=function(obj,divId){$("#"+obj).click()},$scope.doSomethingElse=function(suggestion){},$scope.selectedTemplate=function(){},$scope.closePrev=function(){$scope.isHidden=!$scope.isHidden},$scope.showMap=function(){$scope.mapHidden?$("#adressblock").hide():$("#adressblock").show(),$scope.mapHidden=!$scope.mapHidden,$scope.mapHidden||init_map()};var getBrandValueId=function(inputJson){for(var brandValueId={},i=0;i<inputJson.length;i++)brandValueId[inputJson[i].Name]=inputJson[i].Id;return brandValueId},getRetailerValueId=function(inputJson){for(var retailerValueId={},i=0;i<inputJson.length;i++)retailerValueId[inputJson[i].Name]=inputJson[i].Id;return retailerValueId};$scope.errMsg=function(data){1==data&&($scope.matchWord=!0),0==data&&($scope.matchWord=!1)},$scope.reterrMsg=function(data){1==data&&($scope.matchRetword=!0),0==data&&($scope.matchRetword=!1)},$scope.retailerdata=function(data){$scope.matchRetword=!1},$scope.selecteddata=function(brandModelName){$scope.matchWord=!1},$scope.Cancel=function(){$scope.clearForm(),$location.url("/landingPage")},$scope.clearForm=function(){if($scope.report="",$scope.uniliverdata="",$scope.Retailer="",$scope.reportlist="",$scope.selectedcountry="",!$scope.mapHidden)for(var i=0;i<$scope.Country.length;i++)country=$scope.Country[i].Id="",window.townName="";window.ImageRes&&(window.ImageRes.id="")},$scope.getSelectCountry=function(){"Global"==$scope.selectedcountry.Name?($scope.report.town="",$scope.isGlobalCountry=!0):($scope.report.town="",$scope.isGlobalCountry=!1)},$scope.successReportMessage=function(){var overlayData={message:"Success",message1:"The report is submitted successfully"},confirmModalInstance=$modal.open({templateUrl:RESOURCE_ROOT+"/pages/modal/confirmationPopUp.html",controller:"confirmationModalCtrl",backdrop:"static",resolve:{overlayDetails:function(){return overlayData}}});confirmModalInstance.result.then(function(){$location.url("/landingPage")},function(){})},$scope.reportTitleAtMention=function(typedthings){console.log("search string:"+$scope.reportTitleModel);var searchType="",searchString="";if(!($scope.reportTitleModel.length<=2)){if($scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("@"))var searchType="users";searchString=$scope.reportTitleModel.substring(1);var userListReqData=new userListReq(searchString,searchType);getUserListRequestService.setUserListReqJson(userListReqData.toRequest()),getUserListRequestService.setUserListRequestData(function(data,scope){$scope.autoCompleteUserListData=data.objGetAgentDataResponse.autocompleteList,$scope.$apply()})}};var getRetailerValueId=function(inputJson){for(var retailerValueId={},i=0;i<inputJson.length;i++)retailerValueId[inputJson[i].Name]=inputJson[i].Id;return retailerValueId};$scope.usersTag=[],$scope.topicsTag=[],$scope.userTagData=[],$scope.topicsTagData=[],$scope.selectedtagdata=function(selectedItem){$scope.matchWord=!1;var autocompleteAllDisplayedData=getRetailerValueId($scope.autoCompleteUserListData),selectedUserId=autocompleteAllDisplayedData[selectedItem];$scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("@")?(console.log("Before:"+JSON.stringify($scope.usersTag)),$scope.usersTag.length>0?1!=checkIfTagExist(selectedUserId,"users")&&($scope.usersTag=[{Id:selectedUserId,Name:selectedItem}].concat($scope.usersTag)):$scope.usersTag=[{Id:selectedUserId,Name:selectedItem}],console.log("After:"+JSON.stringify($scope.usersTag))):$scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("#")&&(console.log("Before:"+JSON.stringify($scope.topicsTag)),$scope.topicsTag.length>0?1!=checkIfTagExist(selectedUserId,"topics")&&($scope.topicsTag=[{Id:selectedUserId,Name:selectedItem}].concat($scope.topicsTag)):$scope.topicsTag=[{Id:selectedUserId,Name:selectedItem}]),$scope.reportTitleModel=""};var checkIfTagExist=function(id,type){if("users"==type){for(var i=0;i<$scope.usersTag.length;i++)if(id==$scope.usersTag[i].Id)return!0}else if("topics"==type)for(var i=0;i<$scope.topicsTag.length;i++)if(id==$scope.topicsTag[i].Id)return!0;return!1};$scope.removeUserTag=function(idx){$scope.usersTag.splice(idx,1)},$scope.removeTopicsTag=function(idxT){$scope.topicsTag.splice(idxT,1)},$scope.submitForm=function(myForm){var country,clusterId,agentReportFormReq=null;if($scope.mapHidden)$scope.mapHidden?(($scope.selectedcountry==$scope.Country[0]||$scope.selectedCluster==$scope.clusterList[0])&&(country="",clusterId="",$scope.invalidMsg=!0,$scope.invalidClusterMsg=!0),($scope.selectedcountry!=$scope.Country[0]||$scope.selectedCluster!=$scope.clusterList[0])&&(""!=$scope.selectedcountry.Id&&(country=$scope.selectedcountry.Id),""!=$scope.selectedCluster.Id&&(clusterId=$scope.selectedCluster.Id),$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1)):(country=$scope.selectedcountry.Id,clusterId=$scope.selectedCluster.Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1);else{for(var i=0;i<$scope.Country.length;i++)$scope.Country[i].Name==window.countryValue&&(country=$scope.Country[i].Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1);if(null==country)return growl.error("Unable to copy country from map view while submitting report. Please select county manually by turning off map view."),!1}var reportName;if(null==$scope.report.reportTitle||"undefined"==$scope.report.reportTitle?(reportName="",$scope.invalidMsg1=!0):""!=$scope.report.reportTitle&&($scope.invalidMsg1=!1,reportName=$scope.report.reportTitle),$scope.report.reportDesc)var reportdesc=$scope.report.reportDesc;if($scope.uniliverdata)var unliverBrandId=$scope.brandValueId[$scope.uniliverdata];if($scope.Retailer)var retailerId=$scope.retailerValueId[$scope.Retailer];var reportingOn;reportingOn=$scope.reportlist==$scope.reportList[0]?"":$scope.reportlist;var town;town=$scope.mapHidden?$scope.report.town:townName;var log="",lat="",file=$("#file").val(),file1=$("#file1").val(),file2=$("#file2").val();if((""!=file||""!=file1||""!=file2)&&window.ImageRes)var uploadImageId=window.ImageRes.id;if(1==$scope.invalidMsg1||1==$scope.invalidMsg||1==$scope.matchWord||1==$scope.matchRetword||1==$scope.invalidClusterMsg)return!1;for(var i=0;i<$scope.usersTag.length;i++)$scope.userTagData.push($scope.usersTag[i].Id);for(var i=0;i<$scope.topicsTag.length;i++)$scope.topicsTagData.push($scope.topicsTag[i].Id);$scope.afterSubmitForm=!0,agentReportFormReq=new agentReq(reportName,reportdesc,unliverBrandId,retailerId,reportingOn,country,town,log,lat,uploadImageId,$scope.userTagData,$scope.topicsTagData,clusterId),console.log("====Request ===="+agentReportFormReq.toRequest()),agentReportReqFormData.setAgentReportReqJson(agentReportFormReq.toRequest()),$rootScope.rootVars.dataLoading=!0,agentReportReqFormData.setAgentRequestData(function(data,scope){$rootScope.rootVars.dataLoading=!1,reportDisplayDataService.setReportTypeReq("AllReports"),$scope.successReportMessage(),$scope.$apply()},function(){console.log("error")}),$scope.report.myForm.$valid&&($scope.invalidMsg=!1,$scope.invalidClusterMsg=!1,$scope.invalidMsg1=!1,$scope.invalidMsg2=!1)}}])}),define("beans/competatorReportForm",[],function(){function competatorForm(reportName,reportDesc,competitorBrandId,competitorName,categoryId,retailer,topicId,subTopic,source,countryId,codeOfConduct,town,longitude,latitude,contentDocumentId,otherBrandName,otherCompetitor,userSelectedTag,topicSelctedTag,clusterId){if(!(this instanceof competatorForm))throw new TypeError("agentForm constructor cannot be called as a function.");this.ReportName=reportName,this.ReportDesc=reportDesc,this.CompetitorBrandId=competitorBrandId,this.CompetitorId=competitorName,this.CategoryId=categoryId,this.Retailer=retailer,this.TopicId=topicId,this.SubTopic=subTopic,this.Source=source,this.CountryId=countryId,this.CodeOfConduct=codeOfConduct,this.Town=town,this.Longitude=longitude,this.Latitude=latitude,this.ContentDocumentId=contentDocumentId,this.OtherBrandName=otherBrandName,this.OtherCompetitor=otherCompetitor,this.usertomentionIds=userSelectedTag,this.topicIds=topicSelctedTag,this.ClusterId=clusterId}return competatorForm.prototype={constructor:competatorForm,setReportName:function(reportName){this.ReportName=reportName},setReportDesc:function(reportDesc){this.ReportDesc=reportDesc},setCompetitorBrandId:function(competitorBrandId){this.CompetitorBrandId=competitorBrandId},setCompetitorId:function(competitorName){this.CompetitorId=competitorName},setCategoryId:function(categoryId){this.CategoryId=categoryId},setRetailer:function(retailer){this.Retailer=retailer},setTopicId:function(topicId){this.TopicId=topicId},setSubTopic:function(subTopic){this.SubTopic=subTopic},setSource:function(source){this.Source=source},setCountryId:function(countryId){this.CountryId=countryId},setCodeOfConduct:function(codeOfConduct){this.CodeOfConduct=codeOfConduct},setTown:function(town){this.Town=town},setLongitude:function(longitude){this.Longitude=longitude},setLatitude:function(latitude){this.Latitude=latitude},setContentDocumentId:function(contentDocumentId){this.ContentDocumentId=contentDocumentId},setOtherBrandName:function(otherBrandName){this.OtherBrandName=otherBrandName},setOtherCompetitor:function(otherCompetitor){this.OtherCompetitor=otherCompetitor},setUsertomentionIds:function(userSelectedTag){this.usertomentionIds=userSelectedTag},setTopicIds:function(topicSelctedTag){this.topicIds=topicSelctedTag},setClusterId:function(clusterId){this.ClusterId=clusterId},toRequest:function(){var competatorReqJson=new Object;return competatorReqJson.AgentAppDataRequest=this,competatorReqJson}},competatorForm}),define("beans/compBrandSel",[],function(){function compBrandSelect(competitorBrandId){if(!(this instanceof compBrandSelect))throw new TypeError("agentForm constructor cannot be called as a function.");this.CompetitorBrandId=competitorBrandId}return compBrandSelect.prototype={constructor:compBrandSelect,setCompetitorBrandId:function(competitorBrandId){this.CompetitorBrandId=competitorBrandId},toRequest:function(){var compBrandSelectReqJson=new Object;return compBrandSelectReqJson.AgentAppDataRequest=this,compBrandSelectReqJson}},compBrandSelect}),define("service/competatorRequestService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("competatorRequestService",function($http,$q,$rootScope,serviceHelper){var competatorRepReqJson=null,competatorRepdata=null;return{setCompetatorReportReqJson:function(agentRepReq){competatorRepReqJson=agentRepReq},setCompetatorRequestData:function(successCB,errorCB,scope){var url=config.getValue("webServiceEndpoints.competatorGetCatList");serviceHelper.invokeService("",url,"POST",function(data){competatorRepdata=data,successCB(competatorRepdata)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getCompetatorData:function(data){return competatorRepdata}}})}),define("service/competatorRequestFormService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("competatorRequestFormService",function($http,$q,$rootScope,serviceHelper){var competatorRepReqJson=null,competatorRepdata=null;return{setCompetatorReportReqJson:function(competatorRepReq){competatorRepReqJson=competatorRepReq},setCompetatorReqRespData:function(successCB,errorCB,scope){var stringifiedJSON=JSON.stringify(competatorRepReqJson);console.log("RequestData:==>"+stringifiedJSON);var url=config.getValue("webServiceEndpoints.competitorReportService");serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){competatorRepdata=data,successCB(competatorRepdata)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getCompetatorRespData:function(data){return competatorRepdata}}})}),define("service/competatorOnBrandSeleService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("competatorbrandSelService",function($http,$q,$rootScope,serviceHelper){var competatorBrandReqJson=null,competatorRepdata=null;return{setCompetatorBrandSelReportReqJson:function(competatorRepReq){competatorBrandReqJson=competatorRepReq},setCompetatorBrandReqRespData:function(successCB,errorCB,scope){var stringifiedJSON=JSON.stringify(competatorBrandReqJson),url=config.getValue("webServiceEndpoints.competitorGetBrandListService");serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){competatorRepdata=data,successCB(competatorRepdata)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getCompetatorRespData:function(data){return competatorRepdata}}})}),define("controller/competatorReportController",["require","module/module","beans/competatorReportForm","beans/compBrandSel","beans/getUserListBean","directive/agentReportAutocompleteDirective","directive/autoCompleteStandardDirective","service/competatorRequestService","service/competatorRequestFormService","service/competatorOnBrandSeleService","service/reportDisplayService","service/getUserListService","controller/confirmationModalCtrl"],function(require){var myApp=require("module/module"),competatorReq=require("beans/competatorReportForm"),compBrandSelReq=require("beans/compBrandSel"),userListReq=require("beans/getUserListBean");require("directive/agentReportAutocompleteDirective"),require("directive/autoCompleteStandardDirective"),require("service/competatorRequestService"),require("service/competatorRequestFormService"),require("service/competatorOnBrandSeleService"),require("service/reportDisplayService"),require("service/getUserListService"),require("controller/confirmationModalCtrl"),myApp.controller("competatorReportController",["$scope","$rootScope","$location","$filter","reportDisplayDataService","competatorRequestService","$modal","competatorRequestFormService","competatorbrandSelService","growl","getUserListRequestService",function($scope,$rootScope,$location,$filter,reportDisplayDataService,competatorRequestService,$modal,competatorRequestFormService,competatorbrandSelService,growl,getUserListRequestService){$scope.safariBroser=!1,$rootScope.rootVars={},$rootScope.rootVars.dataLoading=!1,$scope.enableSubtopic=!0,$("#confirmform").hide(),$("#mainform").show(),$("#businessTerms").hide(),$scope.data={},$scope.mapHidden=!0,$scope.invalidMsg=!1,$scope.invalidMsg1=!1,$scope.invalidMsg2=!1,$scope.invalidClusterMsg=!1,$scope.afterSubmitForm=!1,$scope.matchWord=!1,$scope.otherBrandAndCompetitor=!1,$scope.matchRetword=!1,$scope.retailerId,$scope.competatorId,$scope.competatorNameId,$scope.countryId,$scope.report;var competatorData=null;$scope.competatorBrandData=null,$scope.competatorNameData=null,$scope.categoryList=null,$scope.clusterSelectedId=!1,$scope.clearSelectOnBrand=!1,$scope.isGlobalCountry=!1,$scope.autoCompleteUserListData=null,$scope.tagsData={},$rootScope.rootPath={image_confirm_url:RESOURCE_ROOT+"/images/Approve.svg"},Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0&&($scope.safariBroser=!0),competatorRequestService.setCompetatorRequestData(function(data){if($rootScope.rootVars.dataLoading=!1,competatorData=data,console.log("=======>All Cluster Data====="+JSON.stringify(data)),console.log("=======>End All Cluster Data====="),null!=competatorData.objGetAgentDataResponse){if(null!=competatorData.objGetAgentDataResponse.countryList&&($scope.sortedCountry=$filter("orderBy")(competatorData.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry),$scope.selectedcountry=$scope.Country[0]),null!=competatorData.objGetAgentDataResponse.sourcePicklistValues&&($scope.sourceList=["Select a source"].concat(competatorData.objGetAgentDataResponse.sourcePicklistValues),$scope.sourcelist=$scope.sourceList[0]),null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorNameList&&($scope.competatorNameData=[{id:"",Name:"Select a competitor name"}].concat(competatorData.objGetAgentDataResponse.competitorNameList),$scope.defaultCompetitor=$scope.competatorNameData,$scope.competitorNameSelected=$scope.competatorNameData[0]),null!=competatorData.objGetAgentDataResponse.topicList){$scope.topicList=[{Id:"",Name:"Select a topic"}].concat(competatorData.objGetAgentDataResponse.topicList),$scope.topiclist=$scope.topicList[0],$scope.subTopicListarray=[];for(var i=0;i<competatorData.objGetAgentDataResponse.topicList.length;i++)$scope.subTopicSplit=competatorData.objGetAgentDataResponse.topicList[i].Sub_Topic__c,null!=competatorData.objGetAgentDataResponse.topicList[i].Sub_Topic__c&&($scope.subTopicList=$scope.subTopicSplit.split(";\\r\\n"));$scope.subtopiclist=$scope.subTopicListarray[0],$scope.categoryList=[{Id:"",Name:"Select a category"}].concat(competatorData.objGetAgentDataResponse.categoryList),$scope.defaultCategoryList=$scope.categoryList,$scope.categorylist=$scope.categoryList[0]}null!=competatorData.objGetAgentDataResponse.clusterList&&($scope.sortedClusterList=$filter("orderBy")(competatorData.objGetAgentDataResponse.clusterList,"Name"),$scope.clusterList=[{Id:"",Name:"Select a cluster"}].concat($scope.sortedClusterList),$scope.selectedCluster=$scope.clusterList[0])}else growl.error("No Data found");$scope.showMap(),$scope.$apply()},function(){console.log("error")}),$scope.getSubTopicList=function(){$scope.enableSubtopic=!1,$scope.subTopicListarray=[],null!=competatorData.objGetAgentDataResponse&&competatorData.objGetAgentDataResponse.topicList.length>0&&angular.forEach(competatorData.objGetAgentDataResponse.topicList,function(value){return value.Id==$scope.topiclist.Id?($scope.subTopicSplit=value.Sub_Topic__c,$scope.subTopicList=$scope.subTopicSplit.split(";"),$scope.subTopicListarray=$scope.subTopicList,void($scope.subtopiclist=$scope.subTopicListarray[0])):void 0})},$scope.selectedCountryList=function(){for(var countryArr=[],i=0;i<competatorData.objGetAgentDataResponse.countryList.length;i++)$scope.selectedCluster.Id===competatorData.objGetAgentDataResponse.countryList[i].Cluster_Id__c&&(countryArr=[{Id:competatorData.objGetAgentDataResponse.countryList[i].Id,Name:competatorData.objGetAgentDataResponse.countryList[i].Name}].concat(countryArr));$scope.sortedCountry=$filter("orderBy")(countryArr,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry),$scope.selectedCluster==$scope.clusterList[0]&&($scope.sortedCountry1=$filter("orderBy")(competatorData.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry1),$scope.selectedcountry=$scope.Country[0]),$scope.selectedcountry=$scope.Country[0];for(var i=0;i<$scope.Country.length;i++)$scope.countryId=$scope.Country[i].Id;"Global"==$scope.selectedCluster.Name?($scope.clusterSelectedId=!0,$scope.invalidMsg=!1,$scope.report.town=""):$scope.clusterSelectedId=!1},$scope.getSelectCountry=function(){"Global"==$scope.selectedcountry.Name?($scope.report.town="",$scope.isGlobalCountry=!0,$scope.report.town=""):($scope.report.town="",$scope.isGlobalCountry=!1)},$scope.showMap=function(){$scope.mapHidden?$("#adressblock").hide():$("#adressblock").show(),$scope.mapHidden=!$scope.mapHidden,$scope.mapHidden||init_map()},$scope.callJQueryBtn=function(obj,divId){$("#"+obj).click()},$scope.reportTitleAtMention=function(typedthings){var searchType="",searchString="";if(!($scope.reportTitleModel.length<=2)){if($scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("@"))var searchType="users";searchString=$scope.reportTitleModel.substring(1);var userListReqData=new userListReq(searchString,searchType);getUserListRequestService.setUserListReqJson(userListReqData.toRequest()),getUserListRequestService.setUserListRequestData(function(data,scope){$scope.autoCompleteUserListData=data.objGetAgentDataResponse.autocompleteList,$scope.$apply()})}},$scope.competatorBrand=function(typedthings){if(0==$scope.competatorBrandModel.length&&($scope.otherBrandAndCompetitor=!1),$scope.competatorBrandModel.length>=3){if(null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorBrandList){$scope.competatorBrandData=$filter("orderBy")(competatorData.objGetAgentDataResponse.competitorBrandList,"Name"),$scope.competatorValueId=getCompetatorValueId($scope.competatorBrandData);for(var i=0;i<$scope.competatorBrandData.length;i++)$scope.competatorId=$scope.competatorBrandData[i].Id}}else $scope.competatorBrandData="";$scope.competatorBrandModel.length<3&&($scope.competatorNameData=$scope.defaultCompetitor,$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categoryList=$scope.defaultCategoryList,$scope.categorylist=$scope.categoryList[0])};var getCompetatorValueId=function(inputJson){for(var competatorValueId={},i=0;i<inputJson.length;i++)competatorValueId[inputJson[i].Name]=inputJson[i].Id;return competatorValueId};$scope.competatorName=function(typedthings){if(null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorNameList){null!=$scope.compArray&&$scope.compArray.length>0&&($scope.competatorNameData=$scope.compArray),$scope.competatorNameValueId=getCompetatorNameValueId($scope.competatorNameData);for(var i=0;i<$scope.competatorNameData.length;i++)$scope.competatorNameId=$scope.competatorNameData[i].Id}};var getCompetatorNameValueId=function(inputJson){for(var competatorNameValueId={},i=0;i<inputJson.length;i++)competatorNameValueId[inputJson[i].Name]=inputJson[i].Id;return competatorNameValueId};$scope.uniliverRetailer=function(typedthings){if($scope.Retailer.length>=3){if(null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.unileverRetailerList){$scope.uniliverRetailerData=$filter("orderBy")(competatorData.objGetAgentDataResponse.unileverRetailerList,"Name"),$scope.retailerValueId=getRetailerValueId($scope.uniliverRetailerData);for(var i=0;i<$scope.uniliverRetailerData.length;i++)$scope.retailerId=$scope.uniliverRetailerData[i].Id}}else $scope.uniliverRetailerData=""};var getRetailerValueId=function(inputJson){for(var retailerValueId={},i=0;i<inputJson.length;i++)retailerValueId[inputJson[i].Name]=inputJson[i].Id;return retailerValueId};$scope.BrandModelNameSel,$scope.selecteddata=function(brandModelName){$scope.matchWord=!1,"Other"===brandModelName?$scope.otherBrandAndCompetitor=!0:$scope.otherBrandAndCompetitor=!1,$scope.BrandModelNameSel=brandModelName;var compBrandReqData=null,competatorIdval=$scope.competatorValueId[brandModelName],compBrandId=competatorIdval;compBrandReqData=new compBrandSelReq(compBrandId),competatorbrandSelService.setCompetatorBrandSelReportReqJson(compBrandReqData.toRequest()),$rootScope.rootVars.dataLoading=!0,$scope.callBrandSelectedValues()},$scope.usersTag=[],$scope.topicsTag=[],$scope.userTagData=[],$scope.topicsTagData=[],$scope.selectedtagdata=function(selectedItem){$scope.matchWord=!1;var autocompleteAllDisplayedData=getRetailerValueId($scope.autoCompleteUserListData),selectedUserId=autocompleteAllDisplayedData[selectedItem];$scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("@")?(console.log("Before:"+JSON.stringify($scope.usersTag)),$scope.usersTag.length>0?1!=checkIfTagExist(selectedUserId,"users")&&($scope.usersTag=[{Id:selectedUserId,Name:selectedItem}].concat($scope.usersTag)):$scope.usersTag=[{Id:selectedUserId,Name:selectedItem}]):$scope.reportTitleModel.length>2&&0==$scope.reportTitleModel.indexOf("#")&&($scope.topicsTag.length>0?1!=checkIfTagExist(selectedUserId,"topics")&&($scope.topicsTag=[{Id:selectedUserId,Name:selectedItem}].concat($scope.topicsTag)):$scope.topicsTag=[{Id:selectedUserId,Name:selectedItem}]),$scope.reportTitleModel=""};var checkIfTagExist=function(id,type){if("users"==type){for(var i=0;i<$scope.usersTag.length;i++)if(console.log(id+"===Id===>"+$scope.usersTag[i].Id),id==$scope.usersTag[i].Id)return!0}else if("topics"==type)for(var i=0;i<$scope.topicsTag.length;i++)if(id==$scope.topicsTag[i].Id)return!0;return!1};$scope.removeUserTag=function(idx){$scope.usersTag.splice(idx,1)},$scope.removeTopicsTag=function(idxT){$scope.topicsTag.splice(idxT,1)},$scope.errMsg=function(data){if(1==data&&($scope.matchWord=!0),0==data){$scope.matchWord=!1;var compBrandReqData=null,competatorIdval=$scope.competatorValueId[$scope.competatorBrandModel],compBrandId=competatorIdval;compBrandReqData=new compBrandSelReq(compBrandId),competatorbrandSelService.setCompetatorBrandSelReportReqJson(compBrandReqData.toRequest()),$rootScope.rootVars.dataLoading=!0,$scope.callBrandSelectedValues()}},$scope.callBrandSelectedValues=function(){competatorbrandSelService.setCompetatorBrandReqRespData(function(data,scope){function isAvailable(objCheckVal){if($scope.uniqueArr.length>0){for(i=0;i<$scope.uniqueArr.length;i++)if(objCheckVal==$scope.uniqueArr[i].Id)return"1";return"0"}return"0"}if($rootScope.rootVars.dataLoading=!1,$scope.selectedCopititorName=!0,$scope.notSelectedCopititorName=!1,$scope.$apply(),$scope.compCatArray=[],$scope.compArray=[],null!=data.objGetAgentDataResponse&&null!=data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand){for(var i=0;i<data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand.length;i++)data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Agent_Competitor_Id__r&&$scope.compArray.push(data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Agent_Competitor_Id__r),data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Category_Id__r&&$scope.compCatArray.push(data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Category_Id__r);$scope.uniqueArr=[];var flag;angular.forEach($scope.compArray,function(obj){flag=isAvailable(obj.Id),"0"==flag&&$scope.uniqueArr.push({Id:obj.Id,Name:obj.Name})}),$scope.compArray=$scope.uniqueArr,$scope.competatorNameData=$scope.compArray,$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categoryList=$scope.compCatArray,$scope.categorylist=$scope.categoryList[0],$scope.$apply()}},function(){console.log("error")})},$scope.reterrMsg=function(data){1==data&&($scope.matchRetword=!0),0==data&&($scope.matchRetword=!1)},$scope.retailerdata=function(data){$scope.matchRetword=!1},$scope.divShowHide=function(){var country;if(!$scope.mapHidden){for(var i=0;i<$scope.Country.length;i++)$scope.Country[i].Name==window.countryValue&&(country=$scope.Country[i].Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1);if(null==country)return growl.error("Unable to copy country from map view while submitting report. Please select county manually by turning off map view."),!1}$scope.mapHidden?(($scope.selectedcountry==$scope.Country[0]||$scope.selectedCluster==$scope.clusterList[0])&&(country="",clusterId="",$scope.invalidMsg=!0,$scope.invalidClusterMsg=!0),($scope.selectedcountry!=$scope.Country[0]||$scope.selectedCluster!=$scope.clusterList[0])&&(country=$scope.selectedcountry.Id,clusterId=$scope.selectedCluster.Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1)):$scope.report.selectedcountry==$scope.Country[0]&&$scope.selectedCluster==$scope.clusterList[0]?(alert("cntry and cluster blank"),country="",clusterId="",$scope.invalidMsg=!0,$scope.invalidClusterMsg=!0):(country=$scope.selectedcountry.Id,clusterId=$scope.selectedCluster.Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1);var reportName;return null==$scope.report.reportTitle||"undefined"==$scope.report.reportTitle?(reportName="",$scope.invalidMsg1=!0):""!=$scope.report.reportTitle&&($scope.invalidMsg1=!1),$scope.sourcelist==$scope.sourceList[0]&&($scope.invalidMsg2=!0),$scope.sourcelist!=$scope.sourceList[0]&&($scope.invalidMsg2=!1),1==$scope.invalidClusterMsg||1==$scope.invalidMsg||1==$scope.invalidMsg1||1==$scope.invalidMsg2||1==$scope.matchWord||1==$scope.matchRetword?!1:void($scope.report.myForm.$valid&&($("#confirmform").show(),$("#mainform").hide(),$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1,$scope.invalidMsg1=!1,$scope.invalidMsg2=!1))},$scope.Cancel=function(){
$scope.clearForm(),$location.url("/landingPage")},$scope.CancelBack=function(){$("#confirmform").hide(),$("#mainform").show()},$scope.clearForm=function(){if($scope.report="",!$scope.mapHidden){for(var i=0;i<$scope.Country.length;i++)$scope.Country[i].Name="";window.townName=""}$scope.selectedcountry="",window.ImageRes&&(window.ImageRes.id=""),$scope.competatorBrandModel=""},$scope.showTermsAndCondition=function(){$("#confirmform").hide(),$("#businessTerms").show()},$scope.showConfirmationPage=function(){$("#confirmform").show(),$("#businessTerms").hide()},$scope.clearInValidMsg=function(){$scope.invalidMsg=!1},$scope.successReportMessage=function(){var overlayData={message:"Success",message1:"The report is submitted successfully"},confirmModalInstance=$modal.open({templateUrl:RESOURCE_ROOT+"/pages/modal/confirmationPopUp.html",controller:"confirmationModalCtrl",backdrop:"static",resolve:{overlayDetails:function(){return overlayData}}});confirmModalInstance.result.then(function(){$location.url("/landingPage")},function(){})},$scope.submitForm=function(myForm){if($scope.afterSubmitForm=!0,!$scope.report.myForm.$valid)return $scope.invalidMsg=!0,$scope.invalidMsg1=!1,$scope.invalidMsg2=!1,!1;var reportName,competatorFormReq=null;if(""==$scope.report.reportTitle)return reportName="",$scope.invalidMsg=!0,!1;if(reportName=$scope.report.reportTitle,$scope.report.reportDesc)var reportdesc=$scope.report.reportDesc;if($scope.Retailer)var retailerId=$scope.retailerValueId[$scope.Retailer];if($scope.competatorBrandModel)var competatorId=$scope.competatorValueId[$scope.competatorBrandModel];var competatorName;$scope.competitorNameSelected?competatorName=$scope.competitorNameSelected.Id:$scope.competitorNameSelected==$scope.competatorNameData[0]&&(competatorName="");var sourceid;if($scope.sourcelist==$scope.sourceList[0])return sourceid="",$scope.invalidMsg=!0,!1;$scope.sourcelist&&(sourceid=$scope.sourcelist,$scope.invalidMsg=!1);var topicid;$scope.topiclist?topicid=$scope.topiclist.Id:$scope.topiclist==$scope.topicList[0]&&(topicid="");var subtopicid;subtopicid=$scope.subtopiclist?$scope.subtopiclist.replace("\r\n",""):"";var categoryid;$scope.categorylist?categoryid=$scope.categorylist.Id:$scope.categorylist==$scope.categoryList[0]&&(categoryid="");var country,codecond=!0;if($scope.mapHidden){if($scope.selectedcountry==$scope.Country[0]&&$scope.selectedCluster==$scope.clusterList[0])return country="",clusterId="",$scope.invalidMsg=!0,$scope.invalidClusterMsg=!0,!1;country=$scope.selectedcountry.Id,clusterId=$scope.selectedCluster.Id,$scope.invalidMsg=!1,$scope.invalidClusterMsg=!1}else{for(var i=0;i<$scope.Country.length;i++)$scope.Country[i].Name==window.countryValue&&(country=$scope.Country[i].Id,$scope.invalidMsg=!1);if(null==country)return growl.error("Unable to copy country from map view while submitting report. Please select county manually by turning off map view."),!1}var town;town=$scope.mapHidden?$scope.report.town:townName;var log="",lat="",file=$("#file").val(),file1=$("#file1").val(),file2=$("#file2").val();if((""!=file||""!=file1||""!=file2)&&window.ImageRes)var uploadImageId=window.ImageRes.id;var otherBrandName="",otherCompetitor="";otherBrandName=$scope.report.reportOtherBrandName,otherCompetitor=$scope.report.reportOtherCompetitor;for(var i=0;i<$scope.usersTag.length;i++)$scope.userTagData.push($scope.usersTag[i].Id);for(var i=0;i<$scope.topicsTag.length;i++)$scope.topicsTagData.push($scope.topicsTag[i].Id);competatorFormReq=new competatorReq(reportName,reportdesc,competatorId,competatorName,categoryid,retailerId,topicid,subtopicid,sourceid,country,codecond,town,log,lat,uploadImageId,otherBrandName,otherCompetitor,$scope.userTagData,$scope.topicsTagData,clusterId),competatorRequestFormService.setCompetatorReportReqJson(competatorFormReq.toRequest()),$rootScope.rootVars.dataLoading=!0,competatorRequestFormService.setCompetatorReqRespData(function(data,scope){$rootScope.rootVars.dataLoading=!1,reportDisplayDataService.setReportTypeReq("AllReports"),$scope.successReportMessage(),$scope.$apply()},function(){console.log("error")})}}])}),define("beans/applyfilterBean",[],function(){function applyFilterForm(cluster,countryId,unileverBrandId,retailerId,competitoeBrandId,competitorNameId,categoryId,applyFilter){if(!(this instanceof applyFilterForm))throw new TypeError("agentForm constructor cannot be called as a function.");this.Cluster=cluster,this.CountryId=countryId,this.UnileverBrandId=unileverBrandId,this.Retailer=retailerId,this.CompetitoeBrandId=competitoeBrandId,this.CompetitorId=competitorNameId,this.CategoryId=categoryId,this.ApplyFilter=applyFilter}return applyFilterForm.prototype={constructor:applyFilterForm,setCluster:function(cluster){this.Cluster=cluster},setCountryId:function(countryId){this.CountryId=countryId},setUnileverBrandId:function(unileverBrandId){this.UnileverBrandId=unileverBrandId},setRetailer:function(retailerId){this.Retailer=retailerId},setCompetitoeBrandId:function(competitoeBrandId){this.CompetitoeBrandId=competitoeBrandId},setCompetitorId:function(competitorNameId){this.CompetitorId=competitorNameId},setCategoryId:function(categoryId){this.CategoryId=categoryId},setApplyFilter:function(applyFilter){this.ApplyFilter=applyFilter},toRequest:function(){var reportTypeSelectReqJson=new Object;return reportTypeSelectReqJson.AgentAppDataRequest=this,reportTypeSelectReqJson}},applyFilterForm}),define("beans/reportSelected",[],function(){function reportTypeSelect(reportTypeSelVal,resultCountToFetch,resultOffSet,sortOnMostLike,cluster,countryId,unileverBrandId,retailerId,reportingOn,competitoeBrandId,competitorNameId,categoryId,topicId,applyFilter,recordType){if(!(this instanceof reportTypeSelect))throw new TypeError("agentForm constructor cannot be called as a function.");this.FilterType=reportTypeSelVal,this.LimitRecords=resultCountToFetch,this.OffSet=resultOffSet,this.SortOnMostLike=sortOnMostLike,this.ClusterId=cluster,this.CountryId=countryId,this.UnileverBrandId=unileverBrandId,this.Retailer=retailerId,this.ReportingOn=reportingOn,this.CompetitoeBrandId=competitoeBrandId,this.CompetitorId=competitorNameId,this.CategoryId=categoryId,this.TopicId=topicId,this.ApplyFilter=applyFilter,this.RecordType=recordType}return reportTypeSelect.prototype={constructor:reportTypeSelect,setFilterType:function(reportTypeSelVal){this.FilterType=reportTypeSelVal},setLimitRecords:function(resultCountToFetch){this.LimitRecords=resultCountToFetch},setOffSet:function(resultOffSet){this.OffSet=resultOffSet},setSortOnMostLike:function(sortOnMostLike){this.SortOnMostLike=sortOnMostLike},setClusterId:function(cluster){this.ClusterId=cluster},setCountryId:function(countryId){this.CountryId=countryId},setUnileverBrandId:function(unileverBrandId){this.UnileverBrandId=unileverBrandId},setRetailer:function(retailerId){this.Retailer=retailerId},setReportingOn:function(reportingOn){this.ReportingOn=reportingOn},setCompetitoeBrandId:function(competitoeBrandId){this.CompetitoeBrandId=competitoeBrandId},setCompetitorId:function(competitorNameId){this.CompetitorId=competitorNameId},setCategoryId:function(categoryId){this.CategoryId=categoryId},setTopicId:function(topicId){this.TopicId=topicId},setApplyFilter:function(applyFilter){this.ApplyFilter=applyFilter},setRecordType:function(recordType){this.RecordType=recordType},toRequest:function(){var reportTypeSelectReqJson=new Object;return reportTypeSelectReqJson.AgentAppDataRequest=this,reportTypeSelectReqJson}},reportTypeSelect}),define("controller/allFilterController",["require","module/module","beans/compBrandSel","beans/applyfilterBean","beans/reportSelected","service/reportDisplayService","service/angentRepFormService","directive/agentReportAutocompleteDirective","service/competatorRequestService","service/competatorOnBrandSeleService"],function(require){var myApp=require("module/module"),compBrandSelReq=require("beans/compBrandSel"),reportSelBean=(require("beans/applyfilterBean"),require("beans/reportSelected"));require("service/reportDisplayService"),require("service/angentRepFormService"),require("directive/agentReportAutocompleteDirective"),require("service/competatorRequestService"),require("service/competatorOnBrandSeleService"),myApp.controller("allFilterController",["$scope","$rootScope","$location","$filter","reportDisplayDataService","agentReprotData","competatorRequestService","competatorbrandSelService",function($scope,$rootScope,$location,$filter,reportDisplayDataService,agentReprotData,competatorRequestService,competatorbrandSelService){$rootScope.rootVars={},$rootScope.rootVars.dataLoading=!1,$scope.getReportTypeval,$scope.uniliverReportType=!1,$scope.showCompetiotBrand=!1,$scope.matchRetword=!1,$scope.matchWord=!1,$scope.isSelectedClusterGlobal=!1,$scope.brandId,$scope.retailerId,$scope.countryId,$scope.competatorId,$scope.competatorNameId,$scope.competatorBrandData=null;var competatorData=null;$scope.BrandDataComp=null,$scope.clusterList=null,$scope.Country=null,$scope.CountryList=null,$scope.reportResponseData=reportDisplayDataService.getReportDispData(),$scope.displayData=$scope.reportResponseData.objPassAgentReportsToNG;var reportValue=[];reportValue.push({Name:"Unilever Report"},{Name:"Competitor Report"}),$scope.ReportType=[{Name:"All"}].concat(reportValue),$scope.reportTypeModel=$scope.ReportType[0],$scope.callDataInitial=function(){$("#showCompetiotBrand").hide(),$("#uniliverReportType").hide(),agentReprotData.setAgentRepData(function(data){$rootScope.rootVars.dataLoading=!1,$scope.clusterList=data.objGetAgentDataResponse.clusterList,$scope.clusterList=[{Id:"",Name:"Select a cluster"}].concat(data.objGetAgentDataResponse.clusterList),$scope.selectedCluster=$scope.clusterList[0],$scope.selectedCountryList=function(){for(var countryArr=[],i=0;i<data.objGetAgentDataResponse.countryList.length;i++)$scope.selectedCluster.Id===data.objGetAgentDataResponse.countryList[i].Cluster_Id__c&&(countryArr=[{Id:data.objGetAgentDataResponse.countryList[i].Id,Name:data.objGetAgentDataResponse.countryList[i].Name}].concat(countryArr));$scope.sortedCountry=$filter("orderBy")(countryArr,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry),$scope.selectedCluster==$scope.clusterList[0]&&($scope.sortedCountry1=$filter("orderBy")(data.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry1),$scope.selectedcountry=$scope.Country[0]),$scope.selectedcountry=$scope.Country[0];for(var i=0;i<$scope.Country.length;i++)$scope.countryId=$scope.Country[i].Id;"Global"==$scope.selectedCluster.Name?$scope.isSelectedClusterGlobal=!0:$scope.isSelectedClusterGlobal=!1},$scope.sortedCountry2=$filter("orderBy")(data.objGetAgentDataResponse.countryList,"Name"),$scope.Country=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry2),$scope.CountryList=[{Id:"",Name:"Select a country"}].concat($scope.sortedCountry2),$scope.selectedcountry=$scope.Country[0],$scope.$apply()},function(){console.log("error")})},$scope.callDataInitial(),$scope.onReportChange=function(){if("Unilever Report"==$scope.reportTypeModel.Name){$("#showCompetiotBrand").hide(),$("#uniliverReportType").show(),agentReprotData.setAgentRepData(function(data){$scope.uniliverBrandLists=$filter("orderBy")(data.objGetAgentDataResponse.unileverBrandList,"Name"),$scope.retailerLists=$filter("orderBy")(data.objGetAgentDataResponse.unileverRetailerList,"Name"),$scope.reportList=["Select reporting on"].concat(data.objGetAgentDataResponse.reportingOnPicklistValues),$scope.reportlist=$scope.reportList[0],$scope.$apply()},function(){console.log("error")}),$scope.uniliverBrand=function(typedthings){if(!typedthings)return void($scope.agentUniliverBrand=void 0);if($scope.uniliverdata.length>=3){$scope.agentUniliverBrand=$scope.uniliverBrandLists,$scope.brandValueId=getBrandValueId($scope.agentUniliverBrand);for(var i=0;i<$scope.agentUniliverBrand.length;i++)$scope.brandId=$scope.agentUniliverBrand[i].Id}else $scope.agentUniliverBrand=""},$scope.uniliverRetailer=function(typedthings){if($scope.Retailer.length>=3){$scope.uniliverRetailerData=$scope.retailerLists,$scope.retailerValueId=getRetailerValueId($scope.uniliverRetailerData);for(var i=0;i<$scope.uniliverRetailerData.length;i++)$scope.retailerId=$scope.uniliverRetailerData[i].Id}else $scope.uniliverRetailerData=""},$scope.doSomethingElse=function(suggestion){},$scope.selectedTemplate=function(){};var getBrandValueId=function(inputJson){for(var brandValueId={},i=0;i<inputJson.length;i++)brandValueId[inputJson[i].Name]=inputJson[i].Id;return brandValueId},getRetailerValueId=function(inputJson){for(var retailerValueId={},i=0;i<inputJson.length;i++)retailerValueId[inputJson[i].Name]=inputJson[i].Id;return retailerValueId};$scope.errMsg=function(data){1==data&&($scope.matchWord=!0),0==data&&($scope.matchWord=!1)},$scope.reterrMsg=function(data){1==data&&($scope.matchRetword=!0),0==data&&($scope.matchRetword=!1)},$scope.retailerdata=function(data){$scope.matchRetword=!1},$scope.selecteddata=function(brandModelName){$scope.matchWord=!1}}if("Competitor Report"==$scope.reportTypeModel.Name){$("#showCompetiotBrand").show(),$("#uniliverReportType").hide(),competatorRequestService.setCompetatorRequestData(function(data){competatorData=data,null!=competatorData.objGetAgentDataResponse&&($scope.BrandDataComp=competatorData.objGetAgentDataResponse.competitorBrandList,null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorNameList&&($scope.competatorNameData=[{id:"",Name:"Select  brand"}].concat(competatorData.objGetAgentDataResponse.competitorNameList),$scope.defaultCompetitor=$scope.competatorNameData,$scope.competitorNameSelected=$scope.competatorNameData[0]),$scope.categoryList=[{Id:"",Name:"Select a category"}].concat(competatorData.objGetAgentDataResponse.categoryList),$scope.defaultCategoryList=$scope.categoryList,$scope.categorylist=$scope.categoryList[0]),null!=competatorData.objGetAgentDataResponse.topicList&&($scope.topicList=[{Id:"",Name:"Select a topic"}].concat(competatorData.objGetAgentDataResponse.topicList),$scope.topiclist=$scope.topicList[0]),$scope.$apply()},function(){console.log("error")}),$scope.competatorBrand=function(typedthings){if($scope.competatorBrandModel.length>=3){if(null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorBrandList){$scope.competatorBrandData=$filter("orderBy")(competatorData.objGetAgentDataResponse.competitorBrandList,"Name"),$scope.competatorValueId=getCompetatorValueId($scope.competatorBrandData);for(var i=0;i<$scope.competatorBrandData.length;i++)$scope.competatorId=$scope.competatorBrandData[i].Id}}else $scope.competatorBrandData="";$scope.competatorBrandModel.length<3&&($scope.competatorNameData=$scope.defaultCompetitor,$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categoryList=$scope.defaultCategoryList,$scope.categorylist=$scope.categoryList[0])};var getCompetatorValueId=function(inputJson){for(var competatorValueId={},i=0;i<inputJson.length;i++)competatorValueId[inputJson[i].Name]=inputJson[i].Id;return competatorValueId};$scope.competatorName=function(typedthings){if(null!=competatorData.objGetAgentDataResponse&&null!=competatorData.objGetAgentDataResponse.competitorNameList){null!=$scope.compArray&&$scope.compArray.length>0&&($scope.competatorNameData=$scope.compArray),$scope.competatorNameValueId=getCompetatorNameValueId($scope.competatorNameData);for(var i=0;i<$scope.competatorNameData.length;i++)$scope.competatorNameId=$scope.competatorNameData[i].Id}};var getCompetatorNameValueId=function(inputJson){for(var competatorNameValueId={},i=0;i<inputJson.length;i++)competatorNameValueId[inputJson[i].Name]=inputJson[i].Id;return competatorNameValueId};$scope.reterrMsg=function(data){1==data&&($scope.matchRetword=!0),0==data&&($scope.matchRetword=!1)},$scope.retailerdata=function(data){$scope.matchRetword=!1},$scope.errMsg=function(data){if(1==data&&($scope.matchWord=!0),0==data){$scope.matchWord=!1;var compBrandReqData=null,competatorIdval=$scope.competatorValueId[$scope.competatorBrandModel],compBrandId=competatorIdval;compBrandReqData=new compBrandSelReq(compBrandId),competatorbrandSelService.setCompetatorBrandSelReportReqJson(compBrandReqData.toRequest()),$rootScope.rootVars.dataLoading=!0,$scope.callBrandSelectedValues()}},$scope.selecteddata=function(brandModelName){$scope.matchWord=!1,$scope.BrandModelNameSel=brandModelName;var compBrandReqData=null,competatorIdval=$scope.competatorValueId[brandModelName],compBrandId=competatorIdval;compBrandReqData=new compBrandSelReq(compBrandId),competatorbrandSelService.setCompetatorBrandSelReportReqJson(compBrandReqData.toRequest()),$rootScope.rootVars.dataLoading=!0,$scope.callBrandSelectedValues()},$scope.callBrandSelectedValues=function(){competatorbrandSelService.setCompetatorBrandReqRespData(function(data,scope){function isAvailable(objCheckVal){if($scope.uniqueArr.length>0){for(i=0;i<$scope.uniqueArr.length;i++)if(objCheckVal==$scope.uniqueArr[i].Id)return"1";return"0"}return"0"}if($rootScope.rootVars.dataLoading=!1,$scope.selectedCopititorName=!0,$scope.notSelectedCopititorName=!1,$scope.$apply(),$scope.compCatArray=[],$scope.compArray=[],null!=data.objGetAgentDataResponse&&null!=data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand){for(var i=0;i<data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand.length;i++)data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Agent_Competitor_Id__r&&$scope.compArray.push(data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Agent_Competitor_Id__r),data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Category_Id__r&&$scope.compCatArray.push(data.objGetAgentDataResponse.selectedCompetitorCategoryOnBrand[i].Category_Id__r);$scope.uniqueArr=[];var flag;angular.forEach($scope.compArray,function(obj){flag=isAvailable(obj.Id),"0"==flag&&$scope.uniqueArr.push({Id:obj.Id,Name:obj.Name})}),$scope.compArray=$scope.uniqueArr,$scope.competatorNameData=$scope.compArray,$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categoryList=$scope.compCatArray,$scope.categorylist=$scope.categoryList[0],$scope.$apply()}},function(){console.log("error")})}}"All"==$scope.reportTypeModel.Name&&$scope.callDataInitial()},$scope.applyFilterSubmit=function(){reportDisplayDataService.setReportType("applyFilter");var cluster,countryId,reportReqData=null;if("All"==$scope.reportTypeModel.Name&&($scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(console.log("only Country"),cluster="",countryId=$scope.selectedcountry.Id):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("only Cluster"),cluster=$scope.selectedCluster.Id,countryId=""):$scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("Both Null"),cluster="",countryId=""):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(cluster=$scope.selectedCluster.Id,"Global"!=$scope.selectedCluster.Name?(console.log("Not Global cluster"),countryId=$scope.selectedcountry.Id):(console.log("Global Cluster"),countryId="")):(cluster="",countryId=""),console.log("===All Report==")),"Unilever Report"==$scope.reportTypeModel.Name){$scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(console.log("only Country"),cluster="",countryId=$scope.selectedcountry.Id):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("only Cluster"),cluster=$scope.selectedCluster.Id,countryId=""):$scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("Both Null"),cluster="",countryId=""):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(cluster=$scope.selectedCluster.Id,"Global"!=$scope.selectedCluster.Name?(console.log("Not Global cluster"),countryId=$scope.selectedcountry.Id):(console.log("Global Cluster"),countryId="")):(cluster="",countryId=""),console.log("===Unilever Report==");var reportingOn;if(reportingOn=$scope.reportlist==$scope.reportList[0]?null:$scope.reportlist,$scope.uniliverdata)var unileverbrand=$scope.brandValueId[$scope.uniliverdata];if($scope.Retailer)var retailer=$scope.retailerValueId[$scope.Retailer];if(1==$scope.matchWord||1==$scope.matchRetword)return!1}if("Competitor Report"==$scope.reportTypeModel.Name){if($scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(console.log("only Country"),cluster="",countryId=$scope.selectedcountry.Id):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("only Cluster"),cluster=$scope.selectedCluster.Id,countryId=""):$scope.selectedCluster==$scope.clusterList[0]&&$scope.selectedcountry==$scope.Country[0]?(console.log("Both Null"),cluster="",countryId=""):$scope.selectedCluster!=$scope.clusterList[0]&&$scope.selectedcountry!=$scope.Country[0]?(cluster=$scope.selectedCluster.Id,"Global"!=$scope.selectedCluster.Name?(console.log("Not Global cluster"),countryId=$scope.selectedcountry.Id):(console.log("Global Cluster"),countryId="")):(cluster="",countryId=""),console.log("===Competitor Report=="),$scope.competatorBrandModel)var competitorbarnd=$scope.competatorValueId[$scope.competatorBrandModel];if($scope.competitorNameSelected)var compitorname=$scope.competitorNameSelected.Id;var categoryid;categoryid=$scope.categorylist==$scope.categoryList[0]?null:$scope.categorylist.Id;var topicid;if(topicid=$scope.topiclist==$scope.topicList[0]?null:$scope.topiclist.Id,1==$scope.matchWord||1==$scope.matchRetword)return!1}var recordType,applyfilter="true";"Competitor Report"==$scope.reportTypeModel.Name&&(recordType="Competitor"),"Unilever Report"==$scope.reportTypeModel.Name&&(recordType="Unilever"),$scope.resultOffSet=parseInt(config.getValue("constantNumb.recordOffset")),$scope.resultCountToFetch=parseInt(config.getValue("constantNumb.resultCountToFetch"));var reportReqData=null,sortMostLike=null;$scope.getReportTypeval="filterReports",reportReqData=new reportSelBean($scope.getReportTypeval,$scope.resultCountToFetch,$scope.resultOffSet,sortMostLike,cluster,countryId,unileverbrand,retailer,reportingOn,competitorbarnd,compitorname,categoryid,topicid,applyfilter,recordType),$rootScope.rootVars.dataLoading=!0,reportDisplayDataService.setReportType("applyFilter"),reportDisplayDataService.setSortType(""),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),reportDisplayDataService.setReportDisplayData(function(data){$rootScope.rootVars.dataLoading=!1,"All"==$scope.reportTypeModel.Name&&$scope.selectedcountry==$scope.Country[0]&&$scope.selectedCluster==$scope.clusterList[0]?reportDisplayDataService.setReportType("AllReports"):reportDisplayDataService.setReportType("filterReports"),$location.url("/landingPage"),$scope.$apply()},function(){console.log("error")})},$scope.deleteappliedFilter=function(){$scope.clusterList=$scope.clusterList,$scope.selectedCluster=$scope.clusterList[0],$scope.Country=$scope.CountryList,$scope.selectedcountry=$scope.Country[0],"Unilever Report"==$scope.reportTypeModel.Name&&($scope.uniliverdata="",$scope.Retailer="",$scope.reportlist=$scope.reportList[0]),"Competitor Report"==$scope.reportTypeModel.Name&&($scope.competatorBrandModel="",$scope.topiclist=$scope.topicList[0],$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categorylist=$scope.categoryList[0],null!=$scope.compArray&&$scope.compArray.length>0&&($scope.competatorNameData=$scope.defaultCompetitor,$scope.competitorNameSelected=$scope.competatorNameData[0],$scope.categoryList=$scope.defaultCategoryList,$scope.categorylist=$scope.categoryList[0]))}}])}),define("beans/agentReportLike",[],function(){function agentReportLikeCreate(idValue){if(!(this instanceof agentReportLikeCreate))throw new TypeError("agentReportLikeCreate constructor cannot be called as a function.");this.AgentReportId=idValue}return agentReportLikeCreate.prototype={constructor:agentReportLikeCreate,setAgentReportId:function(idValue){this.AgentReportId=idValue},getAgentReportId:function(){return this.AgentReportId},toRequest:function(){var agentReportLikeJson=new Object;return agentReportLikeJson.agentReportToInsert=this,agentReportLikeJson}},agentReportLikeCreate}),define("controller/landingPageController",["require","module/module","controller/agentReportCreateController","controller/competatorReportController","controller/allFilterController","service/reportDisplayService","beans/reportSelected","beans/agentReportLike"],function(require){var myApp=require("module/module");require("controller/agentReportCreateController"),require("controller/competatorReportController"),require("controller/allFilterController"),require("service/reportDisplayService");var reportSelBean=require("beans/reportSelected"),reportLikeBean=require("beans/agentReportLike");myApp.controller("landPageController",["$scope","$rootScope","$location","$modal","reportDisplayDataService","$rootScope","growl",function($scope,$rootScope,$location,$modal,reportDisplayDataService,$rootScope,growl){function truncate(string){return string.length>51?string.substring(0,51)+"...":string}function postCurrentTime(currentTime,createdTime){var postTimeTodisplay="",strtdt=dateObjectToConvert(createdTime),enddt=dateObjectToConvert(currentTime),seconds=Math.floor((enddt-strtdt)/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24);return hours-=24*days,minutes=minutes-24*days*60-60*hours,seconds=seconds-24*days*60*60-60*hours*60-60*minutes,days>0?postTimeTodisplay=GetFormattedDate(createdTime):hours>0?postTimeTodisplay=postTimeTodisplay+hours+" hours ago":minutes>0?postTimeTodisplay=postTimeTodisplay+minutes+" minutes ago":seconds>0&&(postTimeTodisplay=postTimeTodisplay+seconds+" seconds ago"),postTimeTodisplay}function GetFormattedDate(createdTime){var dateString=createdTime,reggie=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/,dateArray=reggie.exec(dateString),dtString="on "+dateArray[2]+"/"+dateArray[3]+"/"+dateArray[1];return dtString}function dateObjectToConvert(dObject){var dateString=dObject,reggie=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/,dateArray=reggie.exec(dateString),dateObject=new Date(+dateArray[1],+dateArray[2]-1,+dateArray[3],+dateArray[4],+dateArray[5],+dateArray[6]);return dateObject}$scope.disableBtn=!1,$scope.reportData=[],$rootScope.rootVars={},$rootScope.rootVars.dataLoading=!1,$scope.resultOffSet=parseInt(config.getValue("constantNumb.recordOffset")),$scope.resultCountToFetch=parseInt(config.getValue("constantNumb.resultCountToFetch"));var url=window.location!=window.parent.location?document.referrer:document.location;$scope.getReportTypeval=reportDisplayDataService.getReportType(),$scope.getSortTypeval=reportDisplayDataService.getSortType(),$scope.getClickTypeval=reportDisplayDataService.getClickedClass(),$rootScope.rootPath={image_Unilever_logo:RESOURCE_ROOT+"/images/Unilever_badge.svg",image_competitor_logo:RESOURCE_ROOT+"/images/CI_badge.svg",image_button_arrow:RESOURCE_ROOT+"/images/Link_white.svg"},$rootScope.brandImage=RESOURCE_ROOT+"/images/Large_1200px.png",$scope.reportTypeVal=null,$scope.uniliverReportType=!1,$scope.reportResponseData=reportDisplayDataService.getReportDispData(),$scope.activeClass=!1,$scope.showmoreCount=1,$scope.showcount=1,$scope.label=null;var allreportlbl={lblReportNameFilter:"All reports"},filterlbl={lblReportNameFilter:"Filtered reports"},myreportlbl={lblReportNameFilter:"My reports"};$scope.label=allreportlbl;var urlContentBaseLocation;url.origin;if(urlContentBaseLocation="https://unilever--chazwa--c.cs14.content.force.com",$scope.backButton=function(){var baseURL=url.origin;window.location.href=baseURL},$scope.loadLandingController=function(){reportDisplayDataService.setReportDisplayData(function(data){if($rootScope.rootVars.dataLoading=!1,data.TotalAgentReports<$scope.resultCountToFetch?$scope.more=!1:$scope.resultOffSet<data.TotalAgentReports?data.TotalAgentReports-$scope.resultOffSet>$scope.resultCountToFetch?($scope.more=!0,$scope.btnLbl="Show more"):($scope.more=!1,$scope.btnLbl="Show more"):data.TotalAgentReports>$scope.resultOffSet&&($scope.more=!1),$scope.RelatedImgRecId,data&&null!=data.objPassAgentReportsToNG&&data.objPassAgentReportsToNG.length>0){for(var i=0;i<data.objPassAgentReportsToNG.length;i++){$scope.profileImg=data.objPassAgentReportsToNG[i].userImgUrl,$scope.reportTitl=data.objPassAgentReportsToNG[i].reportTitl,$scope.town=data.objPassAgentReportsToNG[i].town,$scope.country=data.objPassAgentReportsToNG[i].country,$scope.RelatedImgRecId=null,$scope.LikeCount=0,$scope.TotalCommentCount=0,data.objPassAgentReportsToNG[i].LikeCount?$scope.LikeCount=data.objPassAgentReportsToNG[i].LikeCount:$scope.LikeCount=0,$scope.likes="",data.objPassAgentReportsToNG[i].TotalCommentCount?$scope.TotalCommentCount=data.objPassAgentReportsToNG[i].TotalCommentCount:$scope.TotalCommentCount=0,$scope.comments="";for(var j=0;j<data.objPassAgentReportsToNG[i].feedList.length;j++)if(data.objPassAgentReportsToNG[i].feedList[j].RelatedRecordId){$scope.RelatedImgRecId=data.objPassAgentReportsToNG[i].feedList[j].RelatedRecordId;break}null!=$scope.reportTitl&&(data.objPassAgentReportsToNG[i].reportTitl=truncate($scope.reportTitl)),data.objPassAgentReportsToNG[i].DocumentUrl=decodeURIComponent(data.objPassAgentReportsToNG[i].DocumentUrl),data.objPassAgentReportsToNG[i].reportFullTitl=$scope.reportTitl,data.objPassAgentReportsToNG[i].LikeCount=$scope.LikeCount,data.objPassAgentReportsToNG[i].TotalCommentCount=$scope.TotalCommentCount,data.objPassAgentReportsToNG[i].timeToDisplay=postCurrentTime(data.objPassAgentReportsToNG[i].currentTime,data.objPassAgentReportsToNG[i].createdTime)}$scope.reportData=$scope.reportData.concat(data.objPassAgentReportsToNG)}else(null==data.objPassAgentReportsToNG||0==data.objPassAgentReportsToNG.length)&&($scope.more=!0,$scope.btnLbl="No Records to display",$scope.disableBtn=!0);$scope.$apply()},function(){console.log("error")})},"myReport"==$scope.getReportTypeval){if("showMostLiked"==$scope.getSortTypeval){$scope.reportTypeVal="myReport";var sortMostLike="true";$scope.resultCountToFetch=parseInt(config.getValue("constantNumb.resultCountToFetch"))}else $scope.reportTypeVal="myReport";$scope.label=myreportlbl,$scope.activeClass=!0;var reportReqData=null;reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet,sortMostLike),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$scope.loadLandingController()}else if("filterReports"==$scope.getReportTypeval){if($scope.label=filterlbl,$scope.activeClass=!0,"showMostLiked"==$scope.getSortTypeval){$scope.reportTypeVal="filterReports";var sortMostLike="true";$scope.resultCountToFetch=parseInt(config.getValue("constantNumb.resultCountToFetch"))}else $scope.reportTypeVal="filterReports";var reportReqData=null;reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet,sortMostLike),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$scope.loadLandingController()}else if("showLatest"==$scope.getSortTypeval)$scope.activeClass=!0,$scope.label=allreportlbl,$scope.reportTypeVal="AllReports",reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet),reportDisplayDataService.setReportType("AllReports"),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$scope.loadLandingController();else if("AllReports"==$scope.getReportTypeval){var reportReqData=null;if($scope.activeClass=!0,"showMostLiked"==$scope.getSortTypeval){$scope.reportTypeVal="AllReports";var sortMostLike="true";$scope.resultCountToFetch=parseInt(config.getValue("constantNumb.resultCountToFetch"));
}else $scope.reportTypeVal="AllReports";reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet,sortMostLike),reportDisplayDataService.setReportType($scope.reportTypeVal),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$scope.loadLandingController()}else{var reportReqData=null;$scope.activeClass=!0,$scope.reportTypeVal="AllReports",reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet),reportDisplayDataService.setReportType($scope.reportTypeVal),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$scope.loadLandingController()}$scope.unileverLink=function(){$rootScope.rootVars.dataLoading=!0,$location.url("/homePage")},$scope.competatorLink=function(){$rootScope.rootVars.dataLoading=!0,$location.url("/competatorPage")},$scope.more=!1,$scope.has_more=function(){return $scope.more},$scope.show_more=function(){$scope.resultOffSet=$scope.resultOffSet+$scope.resultCountToFetch;var reportReqData=null;if("showMostLiked"==$scope.getSortTypeval)var sortMostLike="true";reportReqData=new reportSelBean($scope.reportTypeVal,$scope.resultCountToFetch,$scope.resultOffSet,sortMostLike),reportDisplayDataService.setReportType($scope.reportTypeVal),reportDisplayDataService.setReportTypeReq(reportReqData.toRequest()),$rootScope.rootVars.dataLoading=!0,$scope.loadLandingController()},$scope.allReports=function(){$location.url("/allReports")},$scope.applyFilter=function(){$rootScope.rootVars.dataLoading=!0,$location.url("/applyFilters")},$scope.sortReportList=function(){$location.url("/sortReports")},$scope.navigateToReport=function(pageVal){if($scope.pageId=pageVal,"undefined"!=typeof sforce&&null!=sforce&&sforce.one)sforce.one.navigateToSObject($scope.pageId);else{var baseURL=url.origin;window.location.href=baseURL+"/"+$scope.pageId}},$scope.updateLike=function(reportId){var agentReportLikeObj=new reportLikeBean(reportId);reportDisplayDataService.setReportTypeReq(agentReportLikeObj.toRequest()),reportDisplayDataService.setReportLikeUpdate(function(data){if(1==data.UpdateLikeCount){$scope.reportDataTemp=$scope.reportData;for(var reportcount=0,stopExecution=!1;reportcount<$scope.reportDataTemp.length&&0==stopExecution;reportcount++)$scope.reportDataTemp[reportcount].agentReportID==reportId&&($scope.reportDataTemp[reportcount].LikeCount=$scope.reportDataTemp[reportcount].LikeCount+1,$scope.reportDataTemp[reportcount].UserLike="true",stopExecution=!0);$scope.reportData=$scope.reportDataTemp,$scope.$apply()}},function(){console.log("error")})},$scope.updateUnLike=function(reportId){var agentReportLikeObj=new reportLikeBean(reportId);reportDisplayDataService.setReportTypeReq(agentReportLikeObj.toRequest()),reportDisplayDataService.setReportUnLikeUpdate(function(data){if(null==data.UpdateLikeCount){$scope.reportDataTemp=$scope.reportData;for(var reportcount=0,stopExecution=!1;reportcount<$scope.reportDataTemp.length&&0==stopExecution;reportcount++)$scope.reportDataTemp[reportcount].agentReportID==reportId&&($scope.reportDataTemp[reportcount].LikeCount=$scope.reportDataTemp[reportcount].LikeCount-1,$scope.reportDataTemp[reportcount].UserLike=null,stopExecution=!0);$scope.reportData=$scope.reportDataTemp,$scope.$apply()}},function(){console.log("error")})}}])}),define("controller/allReportsController",["require","module/module","controller/landingPageController","service/reportDisplayService"],function(require){var myApp=require("module/module");require("controller/landingPageController"),require("service/reportDisplayService"),myApp.controller("allReportsController",["$scope","$location","reportDisplayDataService",function($scope,$location,reportDisplayDataService){$scope.getReportTypeval=reportDisplayDataService.getReportType(),$scope.getSortTypeval=reportDisplayDataService.getSortType(),$scope.allActiveClass=!0,$scope.filterActiveClass=!1,$scope.myActiveClass=!1,$scope.showActiveClass=!1,$scope.mostActiveClass=!1,"AllReports"==$scope.getReportTypeval&&($scope.allActiveClass=!0,$scope.filterActiveClass=!1,$scope.myActiveClass=!1),"filterReports"==$scope.getReportTypeval&&($scope.allActiveClass=!1,$scope.filterActiveClass=!0,$scope.myActiveClass=!1),"myReport"==$scope.getReportTypeval&&($scope.allActiveClass=!1,$scope.filterActiveClass=!1,$scope.myActiveClass=!0),$scope.showActiveClass=!0,$scope.mostActiveClass=!1,"showLatest"==$scope.getSortTypeval&&($scope.showActiveClass=!0,$scope.mostActiveClass=!1),"showMostLiked"==$scope.getSortTypeval&&($scope.showActiveClass=!1,$scope.mostActiveClass=!0),$scope.applyFilter=function(){1==$scope.showActiveClass&&(reportDisplayDataService.setSortType("showLatest"),$location.url("/landingPage")),1==$scope.mostActiveClass&&(reportDisplayDataService.setSortType("showMostLiked"),$location.url("/landingPage"))},$scope.defaultReport=function(){reportDisplayDataService.setReportType("AllReports"),reportDisplayDataService.setSortType(""),$location.url("/landingPage")},$scope.myReports=function(){reportDisplayDataService.setReportType("myReport"),reportDisplayDataService.setSortType(""),$location.url("/landingPage")},$scope.filterReports=function(){reportDisplayDataService.setReportType("filterReports"),reportDisplayDataService.setSortType(""),$location.url("/landingPage")},$scope.sortRecentReport=function(){$scope.showActiveClass=!0,$scope.mostActiveClass=!1,reportDisplayDataService.setSortType("showLatest")},$scope.sortMostLikedReport=function(){$scope.showActiveClass=!1,$scope.mostActiveClass=!0,reportDisplayDataService.setSortType("showMostLiked")},$scope.Cancel=function(){$location.url("/landingPage")}}])}),define("beans/businessPrincipleForm",[],function(){function businessPrincipleForm(isBusinessPrinciple){if(!(this instanceof businessPrincipleForm))throw new TypeError("businessPrincipleForm constructor cannot be called as a function.");this.isAcceptedTermsCondition=isBusinessPrinciple}return businessPrincipleForm.prototype={constructor:businessPrincipleForm,setisAcceptedTermsCondition:function(isBusinessPrinciple){this.isAcceptedTermsCondition=isBusinessPrinciple},toRequest:function(){var businessPrincipleFormJson=new Object;return businessPrincipleFormJson.businessPrincipleToInsert=this,businessPrincipleFormJson}},businessPrincipleForm}),define("service/businessPrincipleService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("businessPrincipleDataService",function($http,$q,$rootScope,serviceHelper){var businessData=null;return{setBusinessPrincipleData:function(successCB,errorCB){var url=config.getValue("webServiceEndpoints.businessPrincipleService");serviceHelper.invokeService("",url,"POST",function(data){businessData=data,successCB(businessData)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)}}})}),define("service/businessPrincipleRequestFormService",["require","module/module","helper/serviceHelper"],function(require){var myApp=require("module/module");require("helper/serviceHelper"),myApp.factory("businessPrincipleReqFormData",function($http,$q,$rootScope,serviceHelper){var businessPrincipleReqJson=null,businessPrincipleReqData=null;return{setBusinessPrincipleFormJson:function(businessPrincipleReqData){businessPrincipleReqJson=businessPrincipleReqData},setBusinessPrincipleData:function(successCB,errorCB){var stringifiedJSON=JSON.stringify(businessPrincipleReqJson),url=config.getValue("webServiceEndpoints.updateBusinessPrincipleService");serviceHelper.invokeService(stringifiedJSON,url,"POST",function(data){businessPrincipleReqData=data,successCB(data)},function(jqXHR){$rootScope.$apply(),errorCB()},!0)},getBusinessPrincipleData:function(data){return businessPrincipleReqData}}})}),define("controller/businessPricipleController",["require","module/module","beans/businessPrincipleForm","service/businessPrincipleService","service/businessPrincipleRequestFormService"],function(require){var myApp=require("module/module"),businessPrincipleReq=require("beans/businessPrincipleForm");require("service/businessPrincipleService"),require("service/businessPrincipleRequestFormService"),myApp.controller("businessCodePricipleController",["$scope","$location","businessPrincipleDataService","businessPrincipleReqFormData","$rootScope",function($scope,$location,businessPrincipleDataService,businessPrincipleReqFormData,$rootScope){$scope.reportData=null,businessPrincipleDataService.setBusinessPrincipleData(function(data){$scope.reportData=data,1==$scope.reportData.isAcceptedTermsCondition?$location.url("/landingPage"):$location.url("/businessPrinciplePage"),$scope.$apply()},function(){console.log("error")}),$scope.submitForm=function(myForm){if($scope.report.myForm.$valid){$scope.invalidMsg=!1,$("#previewLoading").addClass("loadingOn");var businessPrincipleFormRequest=null,isBusinessPrinciple=$scope.report.isBusinessPrinciple;businessPrincipleFormRequest=new businessPrincipleReq(isBusinessPrinciple),businessPrincipleReqFormData.setBusinessPrincipleFormJson(businessPrincipleFormRequest.toRequest()),businessPrincipleReqFormData.setBusinessPrincipleData(function(data,scope){$("#previewLoading").removeClass("loadingOff"),$location.url("/landingPage"),$scope.$apply()},function(){console.log("error")})}else $scope.invalidMsg=!0}}])}),define("routes/mainRoutes",["require","module/module","controller/landingPageController","controller/agentReportCreateController","controller/competatorReportController","controller/allReportsController","controller/allFilterController","controller/businessPricipleController"],function(require){var myApp=require("module/module");require("controller/landingPageController"),require("controller/agentReportCreateController"),require("controller/competatorReportController"),require("controller/allReportsController"),require("controller/allFilterController"),require("controller/businessPricipleController");return myApp.config(function($stateProvider,$urlRouterProvider){$stateProvider.state("splashPage",{url:"/splashPage",templateUrl:RESOURCE_ROOT+"/pages/splashPage.html",controller:"businessCodePricipleController"}).state("businessPrinciplePage",{url:"/businessPrinciplePage",templateUrl:RESOURCE_ROOT+"/pages/Business_Principle.html",controller:"businessCodePricipleController"}).state("landingPage",{url:"/landingPage",templateUrl:RESOURCE_ROOT+"/pages/Landing_Page.html",controller:"landPageController"}).state("homePage",{url:"/homePage",templateUrl:RESOURCE_ROOT+"/pages/agentReportCreation.html",controller:"agentReportCreateController"}).state("competatorPage",{url:"/competatorPage",templateUrl:RESOURCE_ROOT+"/pages/competatorPage.html",controller:"competatorReportController"}).state("allReports",{url:"/allReports",templateUrl:RESOURCE_ROOT+"/pages/allReportListPage.html",controller:"allReportsController"}).state("applyFilters",{url:"/applyFilters",templateUrl:RESOURCE_ROOT+"/pages/applyFilterPage.html",controller:"allFilterController"}).state("sortReports",{url:"/sortReports",templateUrl:RESOURCE_ROOT+"/pages/sortListPage.html",controller:"allReportsController"}),$urlRouterProvider.otherwise("/splashPage")})}),requirejs.config({paths:{angular:"lib/angular/angular.min","angular-resource":"lib/angular/angular-resource.min","angular-ui-router":"lib/angular/angular-ui-router","angular-animate":"lib/angular/angular-animate.min","angular-growl":"lib/angular/angular-growl","jquery-lib":"lib/jquery/jquery-1.11.1.min",bootstrap:"lib/bootstrap/bootstrap.min","ui-bootstrap":"lib/bootstrap/ui-bootstrap-tpls-0.11.0.min","salesforce-connection":"lib/salesforce/connection","salesforce-apex":"lib/salesforce/apex","config-js":"helper/config"},waitSeconds:0,shim:{angular:{exports:"angular"},"angular-resource":{deps:["angular"]},"angular-ui-router":{deps:["angular"]},"angular-animate":{deps:["angular"]},"angular-growl":{deps:["angular"]},"jquery-lib":{exports:"$"},bootstrap:{deps:["jquery-lib"]},"ui-bootstrap":{deps:["angular"]},"salesforce-connection":{deps:[]},"salesforce-apex":{deps:["salesforce-connection"]},utiltiy:{deps:[]},"config-js":{deps:[]}}}),require(["jquery-lib","config-js","jqueryInfrastucture"],function(){console.log("Application initialized successfully");var configFileURL=window.RESOURCE_ROOT+"/js/config/app-config.xml";window.config=new Config(configFileURL),config.init(),console.log("window.config"+window.config),require(["infrastructure"],function(){require(["angular","routes/mainRoutes"],function(angular){console.log("Boot Strap Angular"),angular.bootstrap(document,["myApp"])})})}),define("main",function(){});