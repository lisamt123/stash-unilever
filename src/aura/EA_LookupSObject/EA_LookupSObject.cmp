<aura:component controller="EA_LookupSObjectController">
    <!-- Required Scripts/Styles -->
    <!-- Salesforce Lightning Design System : https://www.lightningdesignsystem.com/ -->
    <ltng:require styles="/resource/EA_StaticResource/assets/styles/salesforce-lightning-design-system-ltng.css" />
     
    <!-- Attributes -->
    <aura:attribute name="sObjectAPIName" type="String" required="true"
        description="The API name of the SObject to search" />
    <aura:attribute name="label" type="String" required="true"
        description="The label to assign to the lookup, eg: Account" />
    <aura:attribute name="pluralLabel" type="String" required="true"
        description="The plural label to assign to the lookup, eg: Accounts" />
    <aura:attribute name="listIconSVGPath" type="String" default="/resource/EA_StaticResource/assets/icons/custom-sprite/svg/symbols.svg#custom11"
        description="The static resource path to the svg icon to use." />
    <aura:attribute name="listIconClass" type="String" default="slds-icon-custom-11"
        description="The SLDS class to use for the icon." />
    <aura:attribute name="searchString" type="String"
        description="The search string to find." />
    <aura:attribute name="selectedUsers" type="String[]" description="The search string to find." />
    <aura:attribute name="selectedItem" type="String[]" description="To map selected details"/>
    <aura:attribute name="maxLimit" type="Integer" description="To limit selection" />
    <aura:attribute name="participantCount" type="Integer" description="To count participant" />
    <aura:attribute name="errorMessage" type="String" description="The search string to find." />
    <aura:attribute name="recentItem" type="EA_Team_Member__c[]" description="team member record." />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler event="c:EA_RecentPill_Event" action="{!c.handlePillUpdate}"/>
    
    <style>
    .slds .slds-lookup__menu {
      width: 95%;
      margin-left: 2.5%;
    }
    </style>
    <!-- Events -->
    <aura:registerEvent name="updateLookupIdEvent" type="c:EA_UpdateLookupId_Event"/>    
    <aura:registerEvent name="clearLookupIdEvent" type="c:EA_ClearLookupId_Event"/>    
     
    <!-- Lookup Markup : See https://www.lightningdesignsystem.com/components/lookups -->
    <div class="slds"> 
        <div aura:id="lookup-div" class="slds-lookup" data-select="multi" data-scope="single" data-typeahead="true">
            <!-- This is the Input form markup -->
            <div class="slds-form-element">
                <!--label class="slds-form-element__label" for="lookup">{!v.label}</label-->
                	<div aura:id="lookup-limit" class="error-msg">
                        <ui:outputText value="{!v.errorMessage}" />
					</div>
                <!-- This markup is for when an item is currently selected -->
                    <div aura:id="lookup-pill" class="slds-pill-container slds-hide">
                	</div>
                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                    <c:svg class="slds-input__icon" xlinkHref="/resource/EA_StaticResource/assets/icons/utility-sprite/svg/symbols.svg#search" />
                	<!-- This markup is for when searching for a string -->
                    <ui:inputText aura:id="lookup" placeholder="{!'Add up to ' + v.maxLimit+' freinds'}" value="{!v.searchString}" class="slds-input" updateOn="keyup" keyup="{!c.search}" />
                    
                </div>
                    
            </div>
            <!-- This is the lookup list markup. Initially it's hidden -->
            <div aura:id="lookuplist" class="slds-lookup__menu slds-hide" role="listbox">
                <div class="slds-lookup__item">
                    <button class="slds-button">
                        <c:svg class="slds-icon slds-icon-text-default slds-icon--small" xlinkHref="/resource/EA_StaticResource/assets/icons/utility-sprite/svg/symbols.svg#search" />
                        &quot;{!v.searchString}&quot; in {!v.pluralLabel}
                    </button>
                </div>
                <ul aura:id="lookuplist-items" class="slds-lookup__list" role="presentation">
                </ul>
            </div>
            <div aura:id="clearBtn">
                <aura:if isTrue="{!v.selectedUsers.length > 0}">
                <ui:button aura:id="clearlookup" class="clear_btn" press="{!c.clear}">Clear All</ui:button>
            	</aura:if>
            </div>
        
        </div>
    
    <div  style="margin-top:30px;"></div>
    <div class="recent_inv">Recently worked with:</div>
    <div class="recent_item_list"> 
        <aura:if isTrue="{! v.recentItem.length > 0}">
            <aura:iteration items="{!v.recentItem}" var="item">
                <c:EA_RecentPillItem itemId="{!item.Participant__c}" itemName="{!item.Participant__r.Name}" selectedUsers="{!v.selectedUsers}" maxLimit="{!v.maxLimit}" selectedItem="{!v.selectedItem}" />
            </aura:iteration>
         </aura:if>
        <aura:if isTrue="{! v.recentItem.length == 0}">
            <div class="message_margin_left">Users not available.</div>
        </aura:if>
      
	</div>
        
 </div>
</aura:component>