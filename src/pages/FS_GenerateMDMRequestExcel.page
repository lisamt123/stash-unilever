<apex:page standardcontroller="Opportunity" showHeader="false" sidebar="false" extensions="FS_GenerateMDMRequest_CX" contentType="application/vnd.ms-excel#SalesForceExport.xls" cache="true">
<head>
    <style type="text/css">
       .center{ text-align: center;}               
       .leftalign{s
            float: left; 
            text-align: left;}
       table { border-collapse: collapse;}
       .tdformat { border: 1px solid black;}
    </style>
</head>       
                      <apex:form >
             <br/> 
             <div class="center">{!defaultCSValue.FS_CompanyName__c}</div>
             <div class="center">{!defaultCSValue.FS_CompanyAddress__c}</div>
             <div class="center">{!defaultCSValue.FS_CompanyPhoneText__c} {!defaultCSValue.FS_CompanyPhone__c} {!defaultCSValue.FS_CompanyFaxText__c} {!defaultCSValue.FS_CompanyFax__c}</div>                              
             <br/> 
             <br/>
             <br/>
             <table >
                        <tr>
                         <td> 
                             <apex:outputText styleClass="leftalign" value="{0,date,dd.MM.yyyy}">
                                   <apex:param value="{!dateSent}" />
                             </apex:outputText>
                         </td>
                         <td/>
                         <td/>
                         <td/>
                         <td/>
                         <td/>
                         <td/>
                         <td/>
                         <td>{!defaultCSValue.FS_CompanyCity__c}</td>
                        </tr>
             </table>
             <br/>
             <br/>
             <br/>
             <div class="center">{!defaultCSValue.FS_Title__c}</div>
             <br/> 
             <br/>
             <br/>
                 <table >
                        <tr>
                         <td class="tdformat">{!HeaderCSValue.FS_TargetOfDiscount__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_ConditionType__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_SalesOrganisation__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_ValidityStart__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_ValidityEnd__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_InternalOrder__c}</td>
                        </tr>
            
                    <tbody>
                        <tr>
                            <td class="tdformat">1</td>
                            <td class="tdformat">2</td>
                            <td class="tdformat">3</td>
                            <td class="tdformat">4</td>
                            <td class="tdformat">5</td>
                            <td class="tdformat">6</td>
                        </tr>
                        <tr>
                            <td class = "tdformat" >{!defaultCSValue.FS_TargetOfDiscountValue__c}</td>
                            <td class = "tdformat" >{!defaultCSValue.FS_ConditionTypeValue__c}</td>
                            <td class = "tdformat" >{!defaultCSValue.FS_SalesOrganisation__c}</td>
                            <td class = "tdformat" >
                                <apex:outputText value="{0,date,dd.MM.yyyy}">
                                       <apex:param value="{!opportunityRecord.FS_startDateTPR__c}" />
                                </apex:outputText>
                            </td>
                            <td class = "tdformat" >
                                <apex:outputText styleclass="tdformat" value="{0,date,dd.MM.yyyy}">
                                       <apex:param value="{!opportunityRecord.FS_endDateTPR__c}" />
                                </apex:outputText>
                            </td>
                            <td class = "tdformat" >{!opportunityRecord.FS_internalOrder__c}</td>
                        </tr>
                    </tbody>
                </table> 
             <br/>
                 <table >
                        <tr>
                         <td class="tdformat">{!HeaderCSValue.FS_HierarchyLevel__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_CustomerCode__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_CustomerCodeDescription__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_ProductHierarchy__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_MaterialCode__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_MaterialDescription__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_ProductExpirationDate__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_Amount__c}</td>
                         <td class="tdformat">{!HeaderCSValue.FS_Unit__c}</td>
                        </tr>
            
                    <tbody>
                        <tr>
                            <td class="tdformat">7</td>
                            <td class="tdformat">8</td>
                            <td class="tdformat">9</td>
                            <td class="tdformat">10</td>
                            <td class="tdformat">11</td>
                            <td class="tdformat">12</td>
                            <td class="tdformat">13</td>
                            <td class="tdformat">14</td>
                            <td class="tdformat">15</td>
                        </tr>                     
                     </tbody>
                </table>
                        <apex:dataTable value="{!opportunityProducts}" var="op" width="100%">
                                    <apex:column styleClass="tdformat" > {!accountRecord.FS_hierarchyLevel__c} </apex:column>   
                                    <apex:column styleClass="tdformat" > {!accountRecord.FS_SoldToCode__c} </apex:column> 
                                    <apex:column styleClass="tdformat" > {!accountRecord.CustomerLegalName__c} </apex:column>
                                    <apex:column styleClass="tdformat" >   </apex:column>                                      
                                    <apex:column styleClass="tdformat"  value="{!op.ProductCode}"/> 
                                    <apex:column styleClass="tdformat"  value="{!product2Map[op.Product2Id].Name}"/>
                                    <apex:column styleClass="tdformat" >   </apex:column> 
                                    <apex:column styleClass="tdformat" >
                                        <apex:outputText value="{0}">
                                              <apex:param value="{!totalTPRPercentageMap[op.Id]}" /> 
                                        </apex:outputText>
                                    </apex:column>
                                    <apex:column styleClass="tdformat" > % </apex:column> 
                          </apex:dataTable>  
                        
                        <br/>
                        <div class="leftalign">{!defaultCSValue.FS_CompanyNote__c}</div>
                        <br/>
                        <br/>                        
                        <div class="leftalign">{!defaultCSValue.FS_CaptionText__c}</div>
                        <br/>
                        <br/>
                        <br/>
                        <br/>
                            <table> 
                                <tr>
                                     <td>{!defaultCSValue.FS_ApprovedByText__c}</td>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td> {!defaultCSValue.FS_SalesManagerName__c} {!defaultCSValue.FS_SalesManagerPosition__c} </td>
                                </tr>
                                <tr>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td> {!defaultCSValue.FS_SignatureText__c} </td>
                                     <td> {!defaultCSValue.FS_NameText__c} </td>
                                </tr>
                                <tr>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td> {!defaultCSValue.FS_FinanceManagerName__c} {!defaultCSValue.FS_FinanceManagerPosition__c} </td>
                                </tr>
                                <tr>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td/>
                                     <td> {!defaultCSValue.FS_SignatureText__c} </td>
                                     <td> {!defaultCSValue.FS_NameText__c} </td>
                                </tr>
                             </table>
                        </apex:form>

 
</apex:page>