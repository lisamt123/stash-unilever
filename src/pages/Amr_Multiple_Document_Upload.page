<apex:page controller="Amr_MultipleDocumentController" >
 <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"/>

  <apex:pageMessages />
  
  
   <apex:form >  
       <apex:pageBlock title="Upload Multiple Attachment to Object">  

       <apex:actionFunction name="ChangeCount" action="{!ChangeCount}"/>
              
            <apex:pageblocksection >  
                
                <apex:pageBlockSectionItem >  
                    <apex:outputLabel value="How many files you want to upload?"/>  
                    <apex:selectList onchange="ChangeCount()" multiselect="false" size="1" value="{!FileCount}">  
                        <apex:selectOption itemLabel="--None--" itemValue=""/>  
                        <apex:selectOptions value="{!filesCountList}"/>  
                    </apex:selectList>  
                </apex:pageBlockSectionItem>  
              
            </apex:pageblocksection>  
           <apex:actionRegion >
             <apex:pageBlockSection title="Select Files" rendered="{!IF(FileCount != null && FileCount != '', true , false)}">  
               
                <apex:dataTable value="{!allFileList}" var="AFL" cellspacing="5">
                    <apex:column headervalue="File">
                             <apex:inputField value="{!AFL.savingObj.Folder_Name__c}"/> 
                            
                            
                        </apex:column>
                   <apex:column headervalue="Folder">
                      <apex:inputfile value="{!AFL.document.body}" filename="{!AFL.document.Name}" /> 
                   </apex:column>
                </apex:dataTable> 
                 
                <apex:commandButton value="Upload" action="{!SaveAttachments}" />   <br/>
            </apex:pageBlockSection>
             </apex:actionRegion>
            
              </apex:pageBlock>
   </apex:form>  
</apex:page>