<apex:page standardController="PQN_Pallet_Quality_Non_Conformance__c" extensions="PQN_singleEntryScreen" showHeader="false" action="{!checkFreezePeriod}">
<head>

    <script src="{!URLFOR($Resource.PQN_Bootstrap, 'PQN_Bootstrap_Home/js/jquery-1.11.1.min.js')}"></script>
    
    <script>
        j$ = jQuery.noConflict();
        j$(document).ready( function (){
            appendSearch();
        });
        function appendSearch(){
            $("input.SKU_Name").after('<button type="button" style="padding:6px;" class="btn btn-default" onclick="getProduct();"><i class="fa fa-external-link"></i></button>');
            $("input.Supplier_Name").after('<button type="button" style="padding:6px;" class="btn btn-default" onclick="openSuppliers();"><i class="fa fa-search"></i></button>');
            $("input.Loss_Code").after('<button type="button" style="padding:6px;" class="btn btn-default" onclick="openLossCode();"><i class="fa fa-search"></i></button>');

        }
        function getProduct(){
            validate($("input.SKU_Name").val(),$("input.Supplier_Name").val(),$("input.Supplier_No").val(),$("input.Loss_Code").val());
            
        }
    </script>
   <script>
    var newWin=null;
    function openSuppliers() {
        var url="{!$Page.PQN_Supplier_Popup}"+"?Supplier_Name=" + $("input.Supplier_Name").attr("id") + "&Supplier_No=" + $("input.Supplier_No").attr("id") + "&Supplier_Type=" + $("input.Supplier_Type").attr("id") + "&search_Name=" + $("input.Supplier_Name").val() + "&object_Name=Suppliers";
        newWin=window.open(url, 'Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
        if (window.focus) 
        {
            newWin.focus();
        }            
        return false;
    }
    /*function openProducts(){
        var url="/"+{!$Page.PQN_Supplier_Popup}+"?Product_Name=" + $("input.Product_Name").attr("id") + "&Product_No=" + $("input.SKU_Name").attr("id") + "&Product_Group=" + $("input.Product_Group").attr("id") + "&Product_Category=" + $("input.Product_Category").attr("id") + "&search_Name=" + $("input.SKU_Name").val() + "&object_Name=Products";
        newWin=window.open(url, 'Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
        if (window.focus) 
        {
            newWin.focus();
        }            
        return false;
    }*/        
    function closeSupplierPopup(){
       if (null!=newWin)
       {
          newWin.close();
       }  
    }
    </script>
    
    <script>
    function openLossCode() {
    
        var url="{!$Page.PQN_Supplier_Popup}"+"?Loss_Code=" + $("input.Loss_Code").attr("id") + "&search_Name=" + $("input.Loss_Code").val() + "&object_Name=Loss Codes";
        newWin=window.open(url, 'Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
        if (window.focus) 
        {
            newWin.focus();
        }            
        return false;
    }
    </script>
    <style>
    input[type="text"],select,textarea {
        //display: block;
        width: 80%;
        height: 30px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    }
    textarea {
        height: auto;
    }
    
    </style>
</head>
<body>
<div id="wrapper">
<c:PQN_Navigation navigationName="single_entry"/>
<div id="page-wrapper">
    <div class="container-fluid">
    <apex:form rendered="{!(!showsingleedit)}">
    <b>Insufficient Previliges. You do not have the permission to edit</b><br/>
    Click <apex:outputLink value="{!$Page.PQN_List_View}">here</apex:outputLink> to return to previous page
    </apex:form>
    <apex:form id="frm" rendered="{!showsingleedit}">
            <apex:actionFunction name="validate" action="{!validate}" reRender="frm" immediate="{!immediate}" oncomplete="appendSearch()">
                <apex:param name="skuName" value=""/>
                <apex:param name="suppName" value=""/>
                <apex:param name="suppNum" value=""/>
                <apex:param name="losName" value=""/>
                
            </apex:actionFunction>
            
<!--        <apex:sectionHeader title="Pallet Quality Non Conformance" />  -->
<!--        <apex:pageMessages ></apex:pageMessages> -->
        <apex:pageBlock title="Pallet Quality Non Conformance Edit" mode="edit" id="PBId1">
        <apex:pageblockbuttons >
            <apex:commandButton value="Save" action="{!savePQN}" rendered="{!freezePeriodFlag}"/>
            <apex:commandButton value="Cancel" action="{!cancelPQN}" immediate="true"/>
            <apex:actionRegion >
                <apex:commandButton value="Validate" action="{!validate}" onclick="getProduct();" reRender="populateId,renderErrorMsg" rendered="{!freezePeriodFlag}"/>
            </apex:actionRegion>
            
            <!--<input type="button" value="Validate" onclick="doValidate();" class="btn"/>-->
            <!--<button type="button" onclick="doValidate();" class="btn">Validate</button>
            <apex:commandButton value="Cancel" action="{!cancelPQN}" immediate="true"/>-->   
        </apex:pageblockbuttons>
        <apex:pageMessages id="renderErrorMsg"/>
        <apex:pageBlockSection title="Reporting Distribution Centre" columns="2" collapsible="false" >
            <!--<apex:inputField value="{!pqn.Reporting_DC__c}" required="true"/>-->
            <apex:selectList value="{!pqn.Reporting_DC__c}" size="1" required="true" rendered="{!if(pqn.id!=null,false,true)}">
                <apex:selectOptions value="{!reportingdc}"/>
            </apex:selectList>
            <apex:inputField value="{!pqn.Reporting_DC__c}" required="true" rendered="{!if(pqn.id!=null,true,false)}"/>
            <apex:inputField value="{!pqn.Region__c}" required="true"/>
            <apex:inputField value="{!pqn.DC_Country__c}" required="true"/>
            <apex:inputField value="{!pqn.Cluster__c}" required="true"/>
            <apex:inputField value="{!pqn.Sub_Cluster__c}" required="true"/>                        
            <apex:inputField value="{!pqn.MCO__c}" required="true"/>
            <apex:inputField value="{!pqn.Delivery_Note_Number__c}"/>
            <!--<apex:inputField value="{!pqn.Description__c}"/>-->       
                        
        </apex:pageBlockSection>
        <apex:pageBlockSection title="Pallet Quality Non Compliance Details" columns="2" collapsible="false" id="PBSId1">
        
            <apex:inputField value="{!pqn.SKU__c}" required="true" id="SKU_NameId" styleClass="SKU_Name" />
            
            <!--<apex:outputField value="{!pqn.Product_Name__c}"/>            
            <apex:outputField value="{!pqn.Product_Group__c}"/>            
            <apex:outputField value="{!pqn.Product_Category__c}"/>-->
            
            <apex:inputField value="{!pqn.Product_Name__c}" onfocus="this.blur()" id="Product_NameId" styleClass="Product_Name"/>
            <apex:inputField value="{!pqn.Product_Group__c}" onfocus="this.blur()" id="Product_GroupId" styleClass="Product_Group"/>
            <apex:inputField value="{!pqn.Product_Category__c}" onfocus="this.blur()" id="Product_CategoryId" styleClass="Product_Category"/>
            
            
            
            <apex:inputField value="{!pqn.Supplier__c}" id="Supplier_NameId" styleClass="Supplier_Name" required="true"/>
            <apex:inputField value="{!pqn.Supplier_Number__c}" styleClass="Supplier_No" id="Supplier_NoId" onfocus="this.blur()"/>
            <apex:inputField value="{!pqn.Supplier_type__c}" styleClass="Supplier_Type" id="Supplier_TypeId" onfocus="this.blur()"/>
            
            
            <apex:inputField value="{!pqn.Non_compliance_reason_code__c}" required="true" styleClass="Loss_Code" id="Loss_CodeId"/>            
            <apex:inputField value="{!pqn.Number_of_Pallets_Per_SKU_Non_Compliant__c}" required="true"/>
            <apex:inputField value="{!pqn.Date_Pallet_Received__c}" required="true"/>  
        </apex:pageBlockSection>
        <apex:pageBlockSection title="Comments" columns="2" collapsible="false">
            <apex:inputField value="{!pqn.Comments__c}"/>
            <apex:outputText value="{!pqn.Days_Left_Before_Freeze__c}"/>
        </apex:pageBlockSection>
        </apex:pageBlock>
    </apex:form>
    </div>
        <!-- /.container-fluid -->
</div>
<!-- /#page-wrapper -->
</div>
</body> 
</apex:page>