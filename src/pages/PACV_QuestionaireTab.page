<apex:page standardController="PACV_Risk_Assessment__c" extensions="PACV_RiskAssessmentListView_CC">   

<apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery-1.12.4.js')}"/> 
<apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery-ui.js')}"/> 
<apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery.min.js')}"/> 
<apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery-ui.min.js')}"/>
<apex:stylesheet value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/css/themes_smoothness_jquery-ui.css')}"/>
<apex:stylesheet value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/css/jquery-ui.css')}"/>


<style type="text/css">    
    .individualPalette .apexDefaultPageBlock.secondaryPalette.bPageBlock .pbBody .customPopup .Selection_CTA{min-width: 100px;margin: 0 10px 20px 0;float:left;}
    
    .customPopup {
    background-color: white;
    border-style: solid;
    border-width: 2px;
    left: 30%;
    padding: 10px;
    position: absolute;
    z-index: 2000;
    width: 400px;
    top:50%;
    padding:0;
    border:1px solid #d4d4d4
    }
    
    .disabledTextBox {
    background-color: white;
    border: 1px solid;
    color: black;
    cursor: default;
    width: 90px;
    display: table;
    padding: 2px 1px;
    text-align:right;
    }      
    .ButtonStyling{
    color:black !important;
    background:#8eb4e3  !important;
    border: 1px solid #8eb4e3  !important;
    font-size: 15px  !important;
    padding: 8px 50px 8px 50px  !important;
    margin-top: 20px  !important;
    }
   .displayNone { 
     display:none; 
     }
    .displayBlock {
     display:block;
     }
    .ui-autocomplete-loading { 
     background: white url(/img/loading32.gif) right center no-repeat;
     background-size:15px 15px; 
     font-style: UnileverDINOffcPro;
     }
    .placeHolder {
     font-style: UnileverDINOffcPro;
     }  
    .ui-widget.ui-widget-content.ui-autocomplete {
    top: 320px;
    position: absolute;
    z-index: 9999;
     }
    .customPopup table tr {
    background-color: #fff;
    border: none;
     }
    .customPopup input.placeHolder, .customPopup input.placeHolder:focus, 
    input[type="text" i] {
    width: 235px;
    margin: 5px 0 10px 0;
    border: 1px solid #ccc;
    height: 20px;
    padding: 0 4px;
    font: normal 12px/20px UnileverDINOffcPro;
    border-radius: 3px;
}
    .customPopup label.popupfontstyling {
    display: inline;
    font: bold 14px/16px UnileverDINOffcPro;
    opacity: 0.7;
    padding: 3px 0;
    clear: both;
    float: left;
    color: #666;
}
.customPopup .closeButton[value="Delegating"]{     
     float: left;
    margin: 0;
    white-space: nowrap;
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 4px 7px;
    background: #e9e9e9;
    text-align: left;
    border-bottom: 1px solid #d4d4d4;
    border-left:none;
    border-right:none;
    border-top: none;
    border-radius: 0;
    font: bold 12px/18px UnileverDINOffcPro;
    background-image: url(../image/user.png);}
   .secondaryPalette.bPageBlock .pbBody .customPopup .Selection_CTA[value="Close"]{margin:0 0 0 15px}
</style>

    <apex:form id="Delegate">
    <apex:pageBlock >

    <apex:outputPanel id="popup">
    <apex:outputPanel id="popInnerOutputPnl" styleClass="customPopup" layout="block" rendered="{!displayPopUp}">
    <apex:commandButton value="Delegating" title="Close the popup" action="{!closePopup}" styleClass="closeButton" rerender="popup"></apex:commandButton>                     

    <apex:outputPanel style="Outputpanel">

    <script type="text/javascript">
        var PLACEHOLDER = 'User Name'; var userObjects;var queryTerm;$('[id$=userTextBoxId]').autocomplete
        ({ minLength: 2,source: function(request, response){queryTerm = request.term;PACV_RiskAssessmentListView_CC.searchuser(request.term, function(result, event)
            {if(event.type == 'exception'){alert(event.message);} else{   userObjects = result; response(userObjects);}});},
            focus: function( event, ui ){ $('[id$=userTextBoxId]').val( ui.item.Name ); return false;},select: function( event, ui ) {$('[id$=userTextBoxId]').val( ui.item.Name );$('[id$=searchuserId]').val( ui.item.Id );return false;
            },})
       .data( "ui-autocomplete" )._renderItem = function( ul, item ) { var entry = "<a>" + item.Name; entry = entry + "</a>";entry = entry.replace(queryTerm, "<b>" + queryTerm + "</b>");return $( "<li></li>" )
            .data( "item.autocomplete", item ).append( entry ).appendTo( ul );};
        // Add or remove placeholder values
        $('[id$=userTextBoxId]').val(PLACEHOLDER);$('[id$=userTextBoxId]').on("focus",  function(event){ $tgt = $(event.target);if($tgt.val() === PLACEHOLDER ){$tgt.val('');$tgt.removeClass('placeHolder');}});
        $('[id$=userTextBoxId]').on( "blur",  function(event){$tgt = $(event.target);if($tgt.val() === '' ){$tgt.val(PLACEHOLDER);$tgt.addClass('placeHolder');}});
    </script>


 <table width="100%" align="Center">
<apex:pageMessages ></apex:pageMessages>          
    <tr>
    <td align="center"><apex:outputLabel value="Internal User" styleClass="popupfontstyling"></apex:outputLabel></td>  
    <td>
    <apex:inputText id="userTextBoxId" value="{!searchTerm}" styleClass="placeHolder"/>
    <apex:inputHidden id="searchuserId" value="{!selecteduser}"   />                                                 
    </td>                          
    </tr>      
    <tr>
    <td  align="center"><apex:outputLabel value="External User" styleClass="popupfontstyling"></apex:outputLabel></td>
    <td ><apex:inputText label="Email" id="SendEmail" value="{!ExtUserEmail}" /></td>
    </tr>  
    <tr>
    <td ><apex:outputText ></apex:outputText></td>
    <td >
    <apex:commandButton value="Save" action="{!redirectPopup}" styleClass="Selection_CTA" rerender="popup"></apex:commandButton>
    <div class="divider"/>    
    <apex:commandButton value="Cancel" title="Close the popup" action="{!closePopup}" styleClass="Selection_CTA" rerender="popup"/>
    </td>
    </tr> 
</table>
</apex:outputPanel>  
</apex:outputPanel>
</apex:outputPanel>
</apex:pageBlock>
</apex:form>
 
 
 

        <!-- rendered="{IF(!completedCount !=null, true, false)}"-->
         <apex:outputPanel id="showDivRiskList" >
              <apex:form id="pg1">
 <div id="tab-3" >
                <h3>Risk Assessment MileStone And To Dos  
        </h3>
        
     <div id="Dynamic_Container" style="display:{!IF(showStatus, "block","none")};">
         
        <table class="Table_View Dashboard">
          <thead>
            <th>Project Name</th>
            <th>Risk Assessment Questionnaire</th>
            <th>Risk Assessment Status</th>
            <th>Project Start Date</th>
            <th>Project End Date</th>
            <!--th>Owner</th>
            <th>Delegated to..</th-->
          </thead>
          <tbody>
              
          <apex:repeat value="{!ResponseList}" var="Record" id="lead"> 
            
          <!--apex:repeat value="{!username}" var="createdbyname" id="list2"--> 

          <tr>
           <td >{!Record.PACV_Project_Name__c}</td>
        <td>     
        <!--apex:commandLink value="Project Assessment" styleClass="Selection_CTA" onclick="showList();return false;">
            <apex:param name="responseId" value="{!Record.Id}" assignTo="{!responseId}"/>
        </apex:commandLink-->
             <apex:outputLink value="javascript:void(0)" id="itemLink" styleClass="Selection_CTA" >Project Assessment
                 <apex:actionSupport event="onclick" action="{!processLinkClick}" reRender="showDivQuestion,showDivRiskList" > 
                     <apex:param name="id1" value="{!Record.Id}"/> 
                 </apex:actionSupport>
              </apex:outputLink>
              </td>
           <!--td><button class="Primary_CTA"><a href="#">Project Assessment</a></button></td-->
           <td>{!Record.PACV_Status__c}</td>
           <td>
           <apex:outputText value="{0, date, d MMM ','  yyyy}">
           <apex:param value="{!Record.PACV_Project_Start_Date__c}"/> 
           </apex:outputText>
           </td>
           <td>
           <apex:outputText value="{0, date, d MMM ','  yyyy}">
           <apex:param value="{!Record.PACV_Project_End_Date__c}"/> 
           </apex:outputText>
           </td>
           
           <!--td width="30%" align="center" valign="center"><img src="{!createdbyname.FullPhotoUrl}" class="Circular" style="width:30px;height:30px;"></img> {!createdbyname.FirstName} {!createdbyname.LastName}</td>
           <!--td width="30%">{!createdbyname.FirstName} {!createdbyname.LastName}</td-->
           </tr>
           </apex:repeat>
              <apex:actionFunction name="testFn" action="{!processLinkClick}">
                 
              </apex:actionFunction>
           <!--/apex:repeat-->
              <tr> <td> <!--pagination code-->
                 
                       
                             <apex:commandButton value="First Page" action="{!Firstbtn}" disabled="{!prv}" reRender="pg1"/></td>
                            <td> <apex:commandButton value="PreviousPage" action="{!prvbtn}" disabled="{!prv}" reRender="pg1"/></td>
                            <td> <apex:commandButton value="NextPage" action="{!Nxtbtn}" disabled="{!nxt}"  reRender="pg1"/></td>
                             <td> <apex:commandButton value="LastPage" action="{!lstbtn}" disabled="{!nxt}" reRender="pg1"/></td>
                            <td></td>
            
             </tr>
           </tbody>
          </table>
          
               <div >
                  To Do's 
                  <div class="Status"><span class=" Badge Done">{!completedCount} </span>Completed</div>
                  <div class="Status"><span class=" Badge Open">{!NotcompletedCount} </span>Open</div>
               </div>
            </div>
  
        </div> 
             </apex:form>
       </apex:outputPanel>
       
    <apex:outputPanel id="showDivQuestion" >
                          <apex:stylesheet value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/css/PACV_Tabs.css')}"/>
          <apex:stylesheet value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/css/jquery-ui.css')}"/>
          <apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery-1.12.4.js')}"/> 
          <apex:includeScript value="{!URLFOR($Resource.PACVStaticResource, '/PACVStaticResource/jsfile/jquery-ui.js')}"/> 
          <style type="text/css">
          #accordion-quest .ui-accordion-content .content table tr {border-bottom: none;}
          #accordion-quest .ui-accordion-content .content table tr:nth-child(even){background:none;}
          #accordion-quest .ui-accordion-content .content table td>input {float: left;}
          #accordion-quest .ui-accordion-content .content table td>input+label {float: left;padding:3px 0;}
          </style>
          <script>
         $( function() {var answered=0;var icons = {header: "iconOpen",activeHeader: "iconClosed"};
           /*Qusetionairre Tab Styles...*/
            $("#tab-2").find(".accordion").accordion({collapsible:true,active:false,icons:icons});
             $('#accordion-quest .ui-accordion-content').find('.Btn_Confirm').attr('disabled',true);
             $('input[value="Submit"]').attr('disabled',true);
            $(".Btn_Confirm").on("click",function(){$('.ui-state-active').find('.done').addClass('Ans');$('.ui-accordion-header-active').css({'color':'#555'}).addClass('answered');
              $('.ui-accordion-content-active').find('.Btn_Delegate').attr('disabled',true).css("cursor", "default");$('.ui-accordion-content-active').find("input:not(:checked)").attr('disabled',true);
            });$(".Btn_Delegate").click(function(){});
              $('#accordion-quest .ui-accordion-content:last-child .Selection_CTA').on('click',function(){                       
                if($('#accordion-quest h3.ui-accordion-header').length==$('#accordion-quest .ui-accordion-header .Ans').length)
               {$('input[value="Submit"]').removeAttr('disabled');}else{$('input[value="Submit"]').attr('disabled',true);}});
              $('#accordion-quest .ui-accordion-content .content table td>input').on('change',function(){ 
              $('#accordion-quest .ui-accordion-content-active').find('.Btn_Confirm').removeAttr('disabled');});
              $("#Acc_Expand").click(function(){$(".ui-accordion-header-icon").addClass('iconClosed').removeClass('iconOpen');$(".ui-accordion-content").show();});
            $("#Acc_Collapse").click(function(){$(".ui-accordion-header-icon").addClass('iconOpen').removeClass('iconClosed');$(".ui-accordion-content").hide();});});
         </script>
 <apex:form id="pg2">
      
       <div id="tab-2"   style="display:{!IF(showStatus, "none","block")};">
               <div class="Acc_ActionItems align-right" style="margin:10px 0 0 0">
                  <a id="Acc_Expand">Expand All</a>
                  <a id="Acc_Collapse">Collapse All</a>
               </div>   
                <div id="Questionairre_Container">
               <div id="accordion-quest" class="accordion">
                

                 
                 <apex:repeat var="q" value="{!questionWrapperList }"  id="repeatBlock"  >
                      <h3> <apex:outputText value="{!q.questionValue}"/><span class="done"></span></h3>
                      <div>
                         <div class="content">
                             <apex:outputPanel rendered="{!q.multiSelect}" styleClass="options" >
                                    <apex:selectCheckboxes value="{!q.selectedAnswersList}" layout="pageDirection">
                                        <apex:selectOptions value="{!q.answerOptions}"></apex:selectOptions>
                                    </apex:selectCheckboxes>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!q.singleSelect}" styleClass="options" >
                                <apex:selectRadio value="{!q.answerSelected}" styleClass="options" id="selected" style="" layout="pageDirection"  >
                                   <apex:selectOptions value="{!q.answerOptions}"  rendered="true" >
                                        
                                     </apex:selectOptions>
                                </apex:selectRadio>
                           </apex:outputPanel>
                         <div class="Btn_Container">
                              <button type="button" class="Selection_CTA align-left Btn_Confirm">Confirm</button>                              
                            
                              <apex:commandButton styleClass="Selection_CTA Btn_Delegate"  value="Delegate" action="{!showPopup}" rerender="popup" status="status">
                              <apex:param name="QuestionID" value="{!q.ID}" />
                             </apex:commandButton>

                             
                         </div>
                         </div>
                         <span class="Help_Icon"></span>
                         <div class="Help_Container">
                            <h4>Guidance for solution selection</h4>
                            <p class="helptext">Sed non urna. Donec et ante. Phasellus eu ligula. Vestibulum sit amet purus. Vivamus hendrerit, dolor at aliquet laoreet, mauris turpis porttitor velit, faucibus interdum tellus libero ac justo. Vivamus non quam. In suscipit faucibus urna.Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                         </div>
                      </div>
                  </apex:repeat>
                </div>
                <div class="Btn_Container">
          <apex:commandButton value="Submit" id="submitBtn" styleClass="Selection_CTA align-right" action="{!submitQuestionAnswerResponseObj}" reRender=""  />
       
          <apex:commandButton value="Save" id="saveBtn" styleClass="Selection_CTA align-right" action="{!saveQuestionAnswerResponseObj}" reRender=""  />
         </div>
                <p class="hide Confirm_msg">Risk Assessment Completed
                    </p>
                    </div>
                <div id="Gen_Report" class="hide">
                    <p><strong>View Risk Assessment Result</strong></p>
                    <p>Vulnerability to CounterFeiting-<strong>Medium</strong></p>
                     <button class="Generate_CTA">Generate Report</button>
                     <button class="SelectSoln_CTA">Select Solution</button>
                    <div id="CaseStudy_Upload">
                        <p>
                            ACS2015NOV009
                        </p>
                        <p>
                            Upload Case Study..
                        </p>
                        <p>
                            ACS2015NOV009
                        </p>
                    </div>
                <p>
                    <strong>Guidance for Solution Selection</strong>
                    </p>
                <p class="recommend_Text">For medium risk we recommend you to use the overt solution.
                 However there are other overt solutions also available which may be better solution
                   which may be better suited to your product.
                    </p>
                    <p class="recommend_Text">
                        For high risk it is recommended that you use a overt solution like Inexo along with a covert solution
                    </p>
                </div>
               <div id="delegate" title="Delegating">
                  <div class="Help_Text">Help</div>
                  <div class="Dialog_Content">
                     <label>Internal User</label>
                      <input type="textbox" />
                     <label>External User</label>
                      <input type="textbox" />
                  </div>
               </div>
                    
            </div>
   
            </apex:form>
        </apex:outputPanel>
  
</apex:page>