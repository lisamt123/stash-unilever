<!--  
*************************************************************************************************************************************************************
*@Description:This page used for changing the status of Gate Document
*@Author: Cognizant
*@Created Date: 26/12/2014 
*@Copyright © 2015  Unilever   
*************************************************************************************************************************************************************
-->
<apex:page controller="IPM_ChangProjectDocumentStatusController" title="{!$Label.IPM_CHANGE_CURR_DOC_STATUS}" standardStylesheets="true" sidebar="false" showHeader="false" extensions="IPM_GetHelpDoc">
    
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Buttons.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_RadioButton.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'assets/font-awesome/css/font-awesome.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/bootstrap.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_ChangeCurrenDocumentStatus.css')}"/>  
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/datepicker.css')}"/>     
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Modal1.css')}"/> 
    
    <apex:form >              
        <apex:outputPanel id="srcp">
            <script>
            var status= '{!JSENCODE(status)}';
            var makeValid = {!showValidation};
            var makeStop = {!showStop};
            var makePostpone = {!showPostpone};
            var makeApprove = {!showApprove};
            var stopvalid = '{!JSENCODE(projectDoc.IPM_Stopped_Comments__c)}';
            var postpdate = '{!JSENCODE(TEXT(projectDoc.IPM_Postponement_Date__c))}';
            var postpComment = '{!JSENCODE(projectDoc.IPM_Postponed_Comments__c)}';
            var updateStatus = '{!JSENCODE(projectDoc.IPM_Document_Status__c)}';
            </script>
        </apex:outputPanel>
        <apex:outputPanel id="goto"></apex:outputPanel> 
        <div class="container-fluid">
            <div class="row changeStatusPage">
                <div class="col-xs-12 changeStatus_links" id="changeStatus_links">
                    <div class="col-xs-12 yellowAlert">
                        <div class="SecButtonSet">
                            <div class="col-sm-1 noPadright"><img alt="Alert" class="alertimg" src="{!URLFOR($Resource.IPM_Resource, 'images/alert_1a.png')}"/></div>                        
                            <div class="col-sm-11 noPadright noPadleft alerttext"><span class="msgTxt">{!$Label.IPM_ONCE_CHANGED_STATUS_CANT_UNDO_IT}</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-12 noPadleft noPadright sliderDiv">
            <div id="slider" class="slider">
                <div id="legend" class="ipmUpdateStatusTab">
                    <ul class="ipmStatusTabs">    
                    </ul>
                </div>
            </div>    
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="changeStatusPage greenBG">
                    <div class="col-xs-12 changeStatus" id="changeStatus">
                        <!-- For In-Progress State -->                     
                        <apex:outputPanel id="progress" styleClass="progress">
                        <!-- Below rendered condition will show the output text for in progress status -->   
                            <apex:outputPanel rendered="{!If(Status='In Progress',true,false)}">
                                <div class="col-xs-12 toolTipMsg marginTop"><apex:outputText value="{!$Label.IPM_ABOUT_IN_PROGRESS_STATE}"/></div>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                        <!-- For Stopped State --> 
                        <apex:outputPanel id="stop" styleClass="stop">
                         <!-- Below rendered condition will show the output text for stopped status -->  
                            <apex:outputPanel rendered="{!If(Status='Stopped',true,false)}">
                                
                                <div class="col-xs-12 toolTipMsg marginTop"><apex:outputText value="{!$Label.IPM_ABOUT_STOPPED_STATE}"/>
                                </div>
                                <apex:outputPanel layout="block" styleClass="col-xs-12 messageBox infoMsg marginTop">
                                        <apex:outputPanel layout="block" styleClass="SecButtonSet">
                                            <a class="icoButton red-info" title="info"></a>
                                            <span class="msgTxt">{!$Label.IPM_Stopmsg}
                                            </span> 
                                        </apex:outputPanel>
                                    </apex:outputPanel> 
                                  <apex:outputLabel styleClass="marginTop" value="{!$Label.IPM_GATE_STOP_COMMENTS_MEETING}"/>                                
                                <apex:inputTextarea onfocus="checktextval();" styleClass="txtArea" value="{!projectDoc.IPM_Stopped_Comments__c}"/>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                        <!-- For Proposed State --> 
                        <apex:outputPanel id="propose" styleClass="propose">
                         <!-- Below rendered condition will show the output text for proposed status -->  
                            <apex:outputPanel rendered="{!If(Status='Proposed',true,false)}" > 
                                <div class="col-xs-12 toolTipMsg marginTop">
                                    <apex:outputText value="{!$Label.IPM_ABOUT_PROPOSED_STATE}"/>
                                </div>
                                <!-- Below rendered condition is used to show the message for proposing gate document --> 
                                <apex:outputPanel rendered="{!OR(showSkipSections,isDefaultAvailable)}">
                                <!-- Below rendered condition is used to show the message for proposing gate document --> 
                                    <apex:outputPanel layout="block" styleClass="col-xs-12 messageBox infoMsg marginTop" rendered="{!showSkipSections}">
                                        <apex:outputPanel layout="block" styleClass="SecButtonSet">
                                            <a class="icoButton red-info" title="info"></a>
                                            <span class="msgTxt">{!$Label.IPM_THIS_CANNOT_BE_PROPOSED_YET}
                                            </span> 
                                        </apex:outputPanel>
                                    </apex:outputPanel> 
                                    <apex:outputLabel value="{!$Label.IPM_NON_NEGOTIABLE_SECTIONS}" styleClass="fieldLabel fieldFont"/>
                                    <apex:repeat value="{!projSectionList}" var="section">   
                                    <!-- Below rendered condition is used to show non negotiable sections --> 
                                        <apex:outputPanel layout="block" rendered="{!AND(!section.IPM_Negotiable__c,section.IPM_Default_Section__c)}">    
                                            <a target="_blank" href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!project.Id}&&projDocSecId={!section.Id}">{!section.IPM_Section_Sequence__c} {!section.IPM_Section_Name__c}</a>
                                           <!--   <apex:inputTextArea value="{!section.IPM_Gate_Document_Summary__c}"/> -->
                                        </apex:outputPanel>
                                    </apex:repeat>
                                    <!--For Default Sections-->
                                    <!-- Below rendered condition is used to show output label for default sections --> 
                                    <apex:outputLabel value="{!$Label.IPM_Default_Section}" styleClass="fieldLabel fieldFont" rendered="{!isDefaultAvailable}"/>
                                    <apex:repeat value="{!projSectionList}" var="section">    
                                         <!-- Below rendered condition is used to provide link for default sections --> 
                                        <apex:outputPanel layout="block" rendered="{!AND(section.IPM_Negotiable__c,section.IPM_Default_Section__c)}">
                                            <a target="_blank" href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!project.Id}&&projDocSecId={!section.Id}">{!section.IPM_Section_Sequence__c} {!section.IPM_Section_Name__c}</a>
                                           <!--  <apex:inputTextArea value="{!section.IPM_Gate_Document_Summary__c}"/>  -->
                                        </apex:outputPanel>
                                    </apex:repeat> 
                               </apex:outputPanel>
                                <apex:outputPanel layout="block" styleClass="errorContainer" id="validationMsg">
                                <!-- Below rendered condition is used to implement validations according to the conditions --> 
                            <apex:outputPanel layout="block" rendered="{!!showValidation}">
                            <!-- Below rendered condition is used to implement validation of project completion -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!completedError}">
                                        <span class="errTitle">{!$Label.IPM_CORE_PARAMETERS}:</span> 
                                        <span class="errList">{!$Label.IPM_Complete_all} <a href="{!$Page.IPM_CoreParameters}?id={!projectId}" target="_top">{!$Label.IPM_CORE_PARAMETERS}</a></span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of project description -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!discriptionError}">
                                        <span class="errTitle">{!$Label.IPM_PROJECT_DESCRIPTION}:</span> 
                                        <span class="errList">Please fill <a href="{!$Page.IPM_CoreParameters}?id={!projectId}" target="_top">{!$Label.IPM_PROJECT_DESCRIPTION}</a></span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of milestones-->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!milestoneError}">
                                        <span class="errTitle">{!$Label.IPM_Milestones_and_Tasks}</span> 
                                        <span class="errList">{!$Label.IPM_Complete_all_pending} <a href="{!$Page.IPM_TaskList}?id={!projectId}" target="_top">{!$Label.IPM_Milestones_and_TO_DOs}</a></span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of rollouts -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!rolloutNotExistsError}">
                                        <span class="errTitle">{!$Label.IPM_ROLLOUTS}:</span>
                                        <span class="errList">Please select <a href="{!$Page.IPM_RolloutPlansAdd}?id={!projectId}" target="_top">{!$Label.IPM_ROLLOUTS_PROPOSAL}</a></span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of rollout regional PL -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!rolloutRegionalPLFilledError}">
                                        <span class="errTitle">{!$Label.IPM_ROLLOUTS}:</span>
                                        <span class="errList">{!$Label.IPM_Please_Fill} <a href="{!$Page.IPM_RolloutPlans}?id={!projectId}" target="_top">{!$Label.IPM_Regional_Project_leader_and_Target_Launch_Date}</a> {!$Label.IPM_In_Regional_Rollouts}</span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of rollout country PL -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!rolloutCountryPLFilledError}">
                                        <span class="errTitle">{!$Label.IPM_ROLLOUTS}:</span>
                                        <span class="errList">{!$Label.IPM_Please_Fill} <a href="{!$Page.IPM_RolloutPlans}?id={!projectId}" target="_top">{!$Label.IPM_Country_Project_leader_and_Target_Launch_Date}</a> {!$Label.IPM_In_Local_Rollouts}</span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of financials -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!financialError}">
                                        <span class="errTitle">{!$Label.IPM_FINANCIALS}:</span> 
                                        <span class="errList">{!$Label.IPM_Please_Fill} <a href="{!$Page.IPM_Financial}?id={!projectId}" target="_top">{!$Label.IPM_Financial_Data}</a></span> 
                                    </apex:outputPanel>
                                    <!-- Below rendered condition is used to implement validation of risk -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!riskError}">
                                        <span class="errTitle">{!$Label.IPM_Risks}</span>
                                        <span class="errList">{!$Label.IPM_Please_complete_the_Risk_mitigation_plan_before_proposing_gate_document} <a href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!projectId}&projDocSecId={!riskSectionId}" target="_top">{!$Label.IPM_Risk_Section}</a></span> 
                                    </apex:outputPanel> 
                                    <!-- Below rendered condition is used to implement validation of eco design --> 
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!ecoDesignNoAssessmentError}">
                                        <span class="errTitle">{!$Label.IPM_EcoDesign_Assessment}</span>
                                        <span class="errList">{!$Label.IPM_EcoDesign_Fill} <a href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!projectId}&projDocSecId={!ecoDesignSectionId}" target="_top">{!$Label.IPM_EcoDesign_Assessment_Section}</a></span> 
                                    </apex:outputPanel>
			    	    <!-- CR0281 bb document validation -->
                                    <!-- Below rendered condition is used for checking TLD alignment, business case confirmation,financial alignment -->
                                    <apex:outputPanel styleClass="errorBlock" layout="block" rendered="{!isBDBBAlignment}">
                                        <span class="errTitle">{!$Label.IPM_BB_Document}</span>
                                        <!-- Below rendered condition is used for checking business case confirmation -->
                                        <apex:outputPanel layout="block" rendered="{!businessCasePending}">
                                             <!-- Below rendered condition is provide the link for section 6.3 --> 
                                                 <apex:outputPanel layout="block" >    
                                                    <span class="errList"><a href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!project.Id}&&projDocSecId={!documentSectionId}" target="_blank">{!$Label.IPM_confirm_business_case_in_gate}</a> </span> 
                                                 </apex:outputPanel>
                                            <apex:variable value="{!totalLocalProjects}" var="rowNum"/>
                                            <div class="errList">
                                                <apex:repeat value="{!localBCProjectName}" var="localProject">
                                                  <span class="bb_project">{!localProject}{!if(rowNum>1,$Label.IPM_Comma,'')}</span>
                                                    <apex:variable var="rowNum" value="{!rowNum - 1}"/>
                                                </apex:repeat>
                                            </div>
                                        </apex:outputPanel>
                                        <!-- Below rendered condition is used for checking financial alignment -->
                                        <apex:outputPanel layout="block" rendered="{!financialAlignment}">
                                            <!-- Below rendered condition is provide the link for section 6.3 -->  
                                                 <apex:outputPanel layout="block">    
                                                    <span class="errList"><a href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!project.Id}&&projDocSecId={!documentSectionId}" target="_blank">{!$Label.IPM_Finance_Align}</a> </span> 
                                                 </apex:outputPanel>
                                            <apex:variable value="{!totalFinProject}" var="rowNum"/>
                                            <div class="errList">
                                                <apex:repeat value="{!localFinProjectName}" var="localProject">
                                                    <span class="bb_project">{!localProject}{!if(rowNum>1,$Label.IPM_Comma,'')}</span>
                                                    <apex:variable var="rowNum" value="{!rowNum - 1}"/>
                                                </apex:repeat>
                                            </div>
                                        </apex:outputPanel>
                                        <!-- Below rendered condition is used for checking TLD alignment -->
                                        <apex:outputPanel layout="block" rendered="{!tldAlignment}">
                                           <apex:outputPanel layout="block" >    
                                                    <span class="errList"><a href="{!$Page.IPM_ProjectDocumentSectionEditor}?id={!project.Id}&&projDocSecId={!documentSectionId}" target="_blank">{!$Label.IPM_TDL_Align}</a> </span> 
                                                 </apex:outputPanel>
                                            <apex:variable value="{!totalTLDProject}" var="rowNum"/>
                                            <div class="errList">
                                                <apex:repeat value="{!localTLDProjectName}" var="localProject">
                                                    <span class="bb_project">{!localProject}{!if(rowNum>1,$Label.IPM_Comma,'')}</span> 
                                                    <apex:variable var="rowNum" value="{!rowNum - 1}"/>
                                                </apex:repeat>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                        <!-- For Postponed State --> 
                        <apex:outputPanel id="postpone" styleClass="postpone">
                        <!-- Below rendered condition will check postpone status validations -->
                            <apex:outputPanel rendered="{!If(Status='Postponed',true,false)}" > 
                                <div class="col-xs-12 toolTipMsg marginTop"><apex:outputLabel value="{!$Label.IPM_POSTPONE_AND_RETRIEVE_FROM_PRO_ARCHIVE}" /></div>
                                <apex:outputPanel layout="block" styleClass="col-xs-12 messageBox infoMsg marginTop" id="postponeMsg">
                                        <apex:outputPanel layout="block" styleClass="SecButtonSet">
                                            <a class="icoButton red-info" title="info"></a>
                                            <span class="msgTxt">{!$Label.IPM_Postpone_Msg}
                                            </span> 
                                            <span class="msgTxt">{!showErrorMsg}</span>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                <apex:outputPanel >
                                    <div class='input-group date'>
                                        <apex:outputLabel value="{!$Label.IPM_POSTPONE_ON}"/>
					<apex:repeat value="{!pendingMilestoneList}" var="milestone">
                                            <apex:inputField styleClass="dateInputBox tldBox calendar" value="{!milestone.IPM_Planned_Date__c}" id="Duedate" rendered="{!Not(milestone.IPM_Name__c = tldMilestoneName)}"/>
                                            <apex:inputField styleClass="dateInputBox " value="{!milestone.IPM_Planned_Date__c}" id="DuedateTLD" rendered="{!(milestone.IPM_Name__c = tldMilestoneName)}" html-disabled="true"/>
                                            
                                            &nbsp;&nbsp; <b><apex:outputText value="{!milestone.IPM_Name__c}" /></b>
                                            <br/><br/>
                                        </apex:repeat>
                                        
                                    </div>
                                    <apex:outputLabel value="{!$Label.IPM_COMMENTS_FOR_GATE_MEETING}"/>
                                    <!--<span class="bluText">* Goes to Contract Gate document, Section Feedback from Last Gate</span>-->
                                    <apex:inputTextarea onfocus="checktextval();" styleClass="txtArea" value="{!projectDoc.IPM_Postponed_Comments__c}"/>
                                </apex:outputPanel>
                                <div class="marginTop ipmButtonGroup pull-right postponeModal" data-toggle="modal" data-target="#ipmModalPostponed" title="Postpone" data-backdrop="static" data-keyboard="false">
                                    <!--<span class="ipmButton primary">{!$Label.IPM_CHANGE}</span>-->
                                    <span class="ipmButton primary">Change</span>
                                </div> 
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                        <!-- For Approved State -->
                        <apex:outputPanel id="approve" styleClass="approve">
                        <!-- Below rendered condition will check approved status validations -->
                            <apex:outputPanel rendered="{!If(Status='Approved',true,false)}" > 
                                <div class="col-xs-12 toolTipMsg marginTop"><apex:outputLabel value="{!$Label.IPM_APPROVE_AND_NO_ACTION}" /></div>
                                <apex:outputPanel layout="block" styleClass="col-sm-12 noPadleft noPadright approvedBox">                           
                                    <apex:outputLabel value="{!$Label.IPM_COMMENTS_FOR_GATE_MEETING}"/> <i>(Optional)</i>
                                    <!-- Below rendered condition is used to show below output text for opertional project -->
                                    <apex:outputPanel rendered="{!AND(project.IPM_Phase__c!=isCapability,isOperational)}">
                                    <span class="bluText">* Goes to <apex:outputText value="{!IF(projectDoc.IPM_GateDocuments__c='Charter',' Contract',(IF(projectDoc.IPM_GateDocuments__c='Contract',' Market Ready',(IF(projectDoc.IPM_GateDocuments__c='Market Ready',' Market Deployment',' PLE')))))}"></apex:outputText>  Gate document, Section Feedback from Last Gate</span>
                                    </apex:outputPanel>
                                    
                                    <apex:inputTextarea onfocus="checktextval();" styleClass="txtArea" value="{!projectDoc.IPM_Approved_Comments__c}"/>
                                    <!-- Below rendered condition is used for charter gate -->
                                    <apex:outputPanel rendered="{!if(projectDoc.IPM_GateDocuments__c=='Charter',True,False)}">
                                        <!-- Below rendered condition is used to provide output label for non operational projects -->
                                        <apex:outputPanel layout="block" rendered="{!!isOperational}" styleClass="col-sm-12 noPadleft noPadright appGates radioButton">
                                            <apex:outputLabel value="{!$Label.IPM_WHO_WILL_APPROVE_CONTRACT_MR}" styleClass="bsFieldLabel setupBlock" />
                                            <div class="ipmApproveButtons gkm">
                                                <apex:selectRadio value="{!project.IPM_GateKeeping_Model__c}" >
                                                    <apex:selectOptions value="{!ContractApprovers}"></apex:selectOptions>
                                                </apex:selectRadio>
                                            </div>
                                            <div class="radioTooltip2 toolTipMsg approveToolTip" id="RCLT">
                                                <span>{!$Label.IPM_GCLT_AND_RCLT_APPROVAL} </span>
                                            </div>
                                            <div class="radioTooltip3 toolTipMsg approveToolTip" id="GCLT">
                                                <span>{!$Label.IPM_GCLT_AND_RCLT_ALL_APPROVAL}</span>
                                            </div>
                                        </apex:outputPanel>
                                        
                                        <div class="col-sm-12 noPadleft noPadright radioButton">
                                            <span class="mStonequest">{!$Label.IPM_PROJECT_ROUTE} </span>
                                            <span class="mStonequest">{!$Label.IPM_SUGGEST_RIGHT_MILESTONES}</span>
                                            <div class="ipmApproveButtons proroute">
                                                <apex:selectRadio value="{!project.IPM_Child_Complexity__c}" >
                                                    <apex:selectOptions value="{!complexities}" ></apex:selectOptions>
                                                </apex:selectRadio>
                                            </div>
                                            
                                            <div class="radioTooltip3 toolTipMsg routeTip" id="Full">
                                                <span>{!$Label.IPM_SELECTING_IPM_FULL} </span>
                                            </div>
                                            <div class="radioTooltip2 toolTipMsg routeTip" id="Lite">
                                                <span>{!$Label.IPM_SELECTING_IPM_LITE}</span>
                                            </div>
                                        </div>
                                        <!-- Below rendered condition is used to provide fast track checkbox for non operational projects -->
                                        <apex:outputPanel layout="block" styleClass="col-sm-12 yellowBox noPadleft"  rendered="{!!isOperational}">
                                            <apex:inputCheckbox styleClass="fastTrackcheck" value="{!project.IPM_Fast_Track_Project__c }" />
                                            <span class="projectraLabel">{!$Label.IPM_FAST_TRACK}</span>
                                        </apex:outputPanel>
                                    </apex:outputPanel>   
                                </apex:outputPanel>
                                
                            </apex:outputPanel>
                        </apex:outputPanel>
                         
                        <apex:outputPanel id="approveWithEdit" styleClass="approveWithEdit">
                        <!-- Below rendered condition will execute for approve with edits -->
                            <apex:outputPanel rendered="{!If(Status='Approved with Edits',true,false)}" > 
                                <div class="col-xs-12 toolTipMsg marginTop "><apex:outputLabel value="{!$Label.IPM_APPROVED_AND_ALLOW_CHANGES}" /></div>
                                <div class="approvedBox">
                                    <apex:outputLabel value="{!$Label.IPM_COMMENTS_FOR_GATE_MEETING}"/> <i>{!$Label.IPM_Document_Optional}</i>
                     <!-- Below rendered condition is used to show output text for operational projects -->
                    <apex:outputPanel rendered="{!AND(project.IPM_Phase__c!=isCapability,isOperational)}">
                                    <span class="bluText">* Goes to <apex:outputText value="{!IF(projectDoc.IPM_GateDocuments__c='Charter',' Contract',(IF(projectDoc.IPM_GateDocuments__c='Contract',' Market Ready',(IF(projectDoc.IPM_GateDocuments__c='Market Ready',' Market Deployment',' PLE')))))}"></apex:outputText> Gate document, Section Feedback from Last Gate</span>
                     </apex:outputPanel>
                </div>
                                <apex:inputTextarea onfocus="checktextval();" styleClass="txtArea" value="{!projectDoc.IPM_Approved_Comments__c}"/>        
                                 <!-- Below rendered condition will execute for charter gate document -->
                                <apex:outputPanel layout="block" rendered="{!if(projectDoc.IPM_GateDocuments__c=='Charter',True,False)}">
                                     <!-- Below rendered condition will execute for non operational projects -->
                                    <apex:outputPanel layout="block" rendered="{!!isOperational}" styleClass="col-sm-12 noPadleft noPadright appGates radioButton">
                                        <apex:outputLabel value="{!$Label.IPM_WHO_WILL_APPROVE_CONTRACT_MR}" styleClass="bsFieldLabel setupBlock" />
                                        <div class="ipmApproveButtons gkm">
                                            <apex:selectRadio value="{!project.IPM_GateKeeping_Model__c}" >
                                                <apex:selectOptions value="{!ContractApprovers}"></apex:selectOptions>
                                            </apex:selectRadio>
                                        </div>
                                        <div class="radioTooltip2 toolTipMsg approveToolTip" id="RCLT">
                                            <span>{!$Label.IPM_GCLT_AND_RCLT_APPROVAL} </span>
                                        </div>
                                        <div class="radioTooltip3 toolTipMsg approveToolTip" id="GCLT">
                                            <span>{!$Label.IPM_GCLT_AND_RCLT_ALL_APPROVAL}</span>
                                        </div>
                                    </apex:outputPanel>
                                    <div class="col-sm-12 noPadleft noPadright radioButton">
                                        <span class="mStonequest">{!$Label.IPM_PROJECT_ROUTE} </span>
                                        <span class="mStonequest">{!$Label.IPM_SUGGEST_RIGHT_MILESTONES}</span>
                                        <div class="ipmApproveButtons proroute">
                                            <apex:selectRadio value="{!project.IPM_Child_Complexity__c}" >
                                                <apex:selectOptions value="{!complexities}"></apex:selectOptions>
                                            </apex:selectRadio>
                                        </div>
                                        
                                        <div class="radioTooltip3 toolTipMsg routeTip" id="Full">
                                            <span>{!$Label.IPM_SELECTING_IPM_FULL} </span>
                                        </div>
                                        <div class="radioTooltip2 toolTipMsg routeTip" id="Lite">
                                            <span>{!$Label.IPM_SELECTING_IPM_LITE}</span>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 yellowBox noPadleft">
                                            <apex:inputCheckbox styleClass="fastTrackcheck" value="{!project.IPM_Fast_Track_Project__c }" />
                                            <span class="projectraLabel">{!$Label.IPM_FAST_TRACK}</span>
                                    </div>
                                </apex:outputPanel>  
                                <div class="marginTop ipmButtonGroup pull-right apprWithEdits" data-toggle="modal" data-target="#ipmModalApproveEdits" title="Approve with Edits" data-backdrop="static" data-keyboard="false">
                                    <!--<span class="ipmButton primary">{!$Label.IPM_CHANGE}</span>-->
                                    <span class="ipmButton primary">Change</span>
                                </div>      
                            </apex:outputPanel>
                        </apex:outputPanel>      
                        <apex:outputPanel layout="block" id="changeAction">
                         <!-- Below rendered condition will execute if status is not equals to approve with edits -->
                            <apex:outputPanel rendered="{!If(Status!='Approved with Edits',true,false)}">
                                <div class="marginTop ipmButtonGroup pull-right">
                                 <!-- Below rendered condition will execute for approved status -->
                                    <apex:outputPanel id="projectBackGround" rendered="{!Status=='Approved'}" >
                                        <a class="ipmButton projectBKProcess primary pull-right" data-toggle="modal" data-target="#initiateProjectBKPanel" data-backdrop="static" data-keyboard="false">Change</a>
                                    </apex:outputPanel>
                                     <!-- Below rendered condition is used to provide button for changing status -->
                                    <apex:outputPanel id="normalSave" rendered="{!AND(Status!='Approved',Status!='Postponed')}" >
                                        <apex:commandButton value="{!$Label.IPM_CHANGE_DOC_STATUS}" action="{!submit}" status="Loading" onclick="skipValidation();" onComplete="goToParentPage();" reRender="srcp,postponeMsg,validationMsg" styleClass="ipmButton primary"/>
                                    </apex:outputPanel>
                                </div>
                                 <!-- Below rendered condition will execute for approved status -->
                                <apex:outputPanel layout="block" rendered="{!Status=='Approved'}">
                                    <div id="initiateProjectBKPanel" class="modal fade" >
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                    <div class="modal-title">{!$Label.IPM_Phase_Change}</div>
                                                </div>
                                        
                                                <div class="modal-body">
                                                    <div class="container-fluid">
                                                        <div class="row">    
                                                            <div class="col-sm-12">
                                                                <span class="skipDesc">{!$Label.IPM_PhaseChangeBKProcessWarning}</span>
                                                            </div>            
                                                            <div class="skipButtoncontainer txtAlignright pull-right">
                                                                <apex:outputPanel id="SkipBossC1">
                                                                    <div class="buttonMarginRight noPadright pull-left" >
                                                                        <input type="button" data-dismiss="modal" class="ipmButton" value="Cancel" />
                                                                    </div> 
                                                                </apex:outputPanel>
                                                                <apex:actionStatus startText="" id="Loading1" startStyleClass="proInit"/>
                                                                    <div class="pull-left noPadright">
                                                                        <apex:commandButton value="{!$Label.IPM_CHANGE_DOC_STATUS}" action="{!submit}" status="Loading" onclick="skipValidation();" onComplete="goToParentPage();" reRender="srcp,postponeMsg,validationMsg" styleClass="ipmButton primary"/>                                  
                                                                    </div> 
                                                            </div>
                                                        </div>  
                                                    </div>          
                                                </div>
                                            </div>
                                        </div>  
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:actionFunction action="{!updateStatus}" name="changeStatus" reRender="progress,propose,postpone,approve,stop,goto,approveWithEdit,changeAction" onComplete="gkmComplete()">
                            <apex:param name="status" value="" id="statusChange" assignTo="{!Status}" />
                        </apex:actionFunction>                      
                       <apex:actionStatus startText="" id="Loading" startStyleClass="proInit"/>
                       <div class="proInitLoader"></div>
                    </div>
                </div>
            </div>
        </div>    
        <div id="ipmModalApproveEdits" class="modal fade ipmModalApproveEdits">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <div class="modal-title">{!$Label.IPM_APPROVE_WITH_EDITS_STATUS_CONFIRMATION}</div>
                    </div>
                    
                    <div class="modal-body">    
                        <div class="col-sm-12">
                            <span class="skipDesc">{!$Label.IPM_ABOUT_TO_MARK_AS_APPROVE_WITH_EDITS}
                            </span>
                        </div>
                        
                        <div class="skipButtoncontainer txtAlignright pull-right">
                            <apex:outputPanel id="SkipBossC2">
                                <div class="buttonMarginRight noPadright fleft" >
                                    <input type="button" data-dismiss="modal" class="ipmButton" value="Cancel" />
                                </div> 
                            </apex:outputPanel>
                            <div class="fleft noPadright">
                                <apex:commandButton value="{!$Label.IPM_Confirm}" html-data-dismiss="modal" action="{!submit}" status="Loading" onclick="skipValidation();" onComplete="goToParentPage();" reRender="srcp,postponeMsg" styleClass="ipmButton primary" />
                            </div> 
                        </div>               
                    </div>
                </div>
            </div>
        </div> 
        <div id="ipmModalPostponed" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <div class="modal-title">{!$Label.IPM_Postponing_Project_Gate}</div>
                    </div>
                    
                    <div class="modal-body">    
                        <div class="col-sm-12">
                            <span class="skipDesc">{!$Label.IPM_About_To_Postpone_Comments}
                            </span>
                        </div>
                        
                        <div class="skipButtoncontainer txtAlignright pull-right">
                            <apex:outputPanel id="SkipBossC3">
                                <div class="buttonMarginRight noPadright fleft" >
                                    <input type="button" data-dismiss="modal" class="ipmButton" value="Cancel" />
                                </div> 
                            </apex:outputPanel>
                            <div class="fleft noPadright">
                                <apex:commandButton value="{!$Label.IPM_Confirm}" html-data-dismiss="modal" action="{!submit}" status="Loading" onclick="skipValidation();" onComplete="goToParentPage();" reRender="srcp,postponeMsg" styleClass="ipmButton primary" />
                            </div> 
                        </div>               
                    </div>
                </div>
            </div>
        </div> 
    </apex:form>
    <div id="ipmModalDiv">
        <c:IPM_ModalHeaderDiv />
    </div>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/jquery.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/jquery-ui.min.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/bootstrap.min.js')}" type="text/javascript"></script>
    <script>
        var IPMApp = {gateStatus:'{!JSENCODE(projectDoc.IPM_Document_Status__c)}', ProjectOverviewPage:'{!URLFOR($Page.IPM_ProjectOverview)}',wmessage:'{!$Label.IPM_Unsaved_Alert}', projectId:'{!URLENCODE(projectId)}', projectPhase: '{!project.IPM_Phase__c}', projectDoc:'{!URLENCODE(projectDoc.IPM_GateDocuments__c)}', Stopped:'{!$Label.IPM_GD_STOPPED}', Proposed:'{!$Label.IPM_GD_PROPOSED}', Postponed:'{!$Label.IPM_GD_POSTPONED}', Approved:'{!$Label.IPM_GD_APPROVED}', inProgress:'{!$Label.IPM_IN_PROGRESS}', ApprovedEdit:'{!$Label.IPM_APPROVED_WITH_EDITS}', GateDocumentPage:'{!URLFOR($Page.IPM_GateDocument)}',MilestonePage:'{!URLFOR($Page.IPM_GateDocument)}'};
    </script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_ChangeCurrenDocumentStatus.js')}" type="text/javascript"></script> 
</apex:page>