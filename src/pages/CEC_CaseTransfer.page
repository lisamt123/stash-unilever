<!--====================================================-->
<!--Name:  CEC_CaseTransfer                             -->
<!--Copyright notice: @ Unilever                        -->
<!--====================================================-->
<!--====================================================-->
<!-- Purpose:This page will be used by CEC Advisor to 
transfer case to the correct market.---------------------->
<!--====================================================-->
<!--====================================================-->
<!-- History                                            -->
<!-- -------                                            -->
<!-- VERSION  AUTHOR        DATE            DETAIL               RELEASE/CSR     
1.0      Mahesh        May-2016      INITIAL DEVELOPMENT
-->

<apex:page standardcontroller="case" extensions="CEC_CaseTransferController" showHeader="false" sidebar="false">
    <apex:includeScript value="/support/console/35.0/integration.js"/>
    <apex:form >
        <apex:actionFunction action="{!searchMarketMap}" name="searchMktFunc" reRender="showmsg,mktMapSection" status="waitStatus"/>
        <apex:pageBlock Id="showmsg">    
            <apex:pageMessages />
            <apex:outputLabel for="country">{!$Label.CEC_SearchCountry}</apex:outputLabel>&nbsp;&nbsp;&nbsp;
            <apex:inputText id="country" value="{!marketMapping}" onkeypress="return noenter(event);"/>&nbsp;&nbsp;&nbsp;
            <apex:commandButton value="{!$Label.CEC_SearchMarketButtonName}" action="{!searchMarketMap}" reRender="showmsg,mktMapSection" status="waitStatus" oncomplete="resetHiddenVal('{!$Component.RadioButtonValue}');"/>
            <apex:pageblockSection />
            <apex:outputPanel id="mktMapSection">
                <apex:pageBlock rendered="{!IF(caseMarketMappings.size > 0 , true,false)}">
                    <apex:pageBlockButtons >
                        <apex:commandButton value="Transfer" action="{!transferCase}" oncomplete="RefreshPrimaryTab({!isTransferSuccess});" status="waitStatus" reRender="showmsg"/>
                        <apex:commandButton value="Cancel"  onclick="getCurrentTabToClose();"/>
                    </apex:pageBlockButtons>
                    <apex:pageblockSection columns="1" >
                        <apex:pageBlockTable value="{!CaseMarketMappings}" var="mktMapping">
                            <apex:column >
                                <input type="radio" name="chosen" id="{!mktMapping.id}" VALUE="{!mktMapping.id}" onclick="changeValue(this,'{!$Component.RadioButtonValue}');"/>
                            </apex:column>
                            <apex:column value="{!mktMapping.Name}"/>
                            <apex:column value="{!mktMapping.Market__c}"/>
                            <apex:column value="{!mktMapping.Language__c}"/>
                            <apex:column value="{!mktMapping.Country__r.name }"/>
                        </apex:pageBlockTable>
                    </apex:pageblockSection>
                </apex:pageBlock>
            </apex:outputPanel>          
        </apex:pageBlock>
        <apex:inputHidden value="{!caseMktMapIdStr}" id="RadioButtonValue" />
        <apex:inputHidden value="{!case.Case_Market__c}" />
    </apex:form>  
    <apex:actionStatus id="waitStatus" >      
        <apex:facet name="start">
            <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb;
                                                                 height: 100%;opacity:0.65;width:100%;"> 
                <div class="waitingHolder" style="top: 74.2px; width: 91px;">
                    <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." alt="loading Icon"/>
                    <span class="waitingDescription">Loading...</span>
                </div>
            </div>
        </apex:facet>
        <apex:facet name="stop"></apex:facet>
    </apex:actionStatus>
    <apex:includeScript value="{!$Resource.CEC_CaseTransferPage}"/>
</apex:page>