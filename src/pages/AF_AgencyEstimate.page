<apex:page controller="AF_AgencyEstimateController" showHeader="false">
<link rel="shortcut icon" type="image/ico" href="http://www.datatables.net/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.AF_jQ_UI_multiselect_Lib,'AF_jQ_UI_multiselect_Lib/jquery.multiselect.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.AF_jQ_UI_multiselect_Lib,'AF_jQ_UI_multiselect_Lib/jquery.multiselect.filter.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.AF_jQ_UI_multiselect_Lib,'AF_jQ_UI_multiselect_Lib/demos/assets/style.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.AF_jQ_UI_multiselect_Lib,'AF_jQ_UI_multiselect_Lib/demos/assets/prettify.css')}" />
    <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/ui-lightness/jquery-ui.css" />
<apex:form >
      <SCRIPT language="javascript">
      
      

   function closeAndRefresh(){
   
  //parent.location.reload(); // or opener.location.href = opener.location.href;
}
 
            function isNumberKey(evt)
       {
          var charCode = (evt.which) ? evt.which : event.keyCode;
          var result = false;
          var errorMsg = document.getElementById("regTitle");
          if (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57))
          { 
             errorMsg.innerHTML = "<b>Please enter numbers only.</b>";
             result = false;
          }
          else 
          {
           errorMsg.innerHTML = "";
           result = true;
          
          }             
          return result;          
       }
        
        function handleChange(input) {
    if (input.value < 0) input.value = 0;
    if (input.value > 100) input.value = 100;
  }
        
        function addRow(tableID) { 
            var table = document.getElementById(tableID); 
            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount); 
            var cell1 = row.insertCell(0);
            var element1 = document.createElement("input");
            element1.type = "checkbox";
            element1.name="chkbox[]";
            cell1.appendChild(element1);                   
            var cell2 = row.insertCell(1);          
            cell2.innerHTML = '<b>' + document.getElementById('inputCountryValue').value + '</b>';          
            var cell3 = row.insertCell(2);
            cell3.innerHTML = '<b>' + document.getElementById('inputPercentageValue').value + ' (%)</b>';        
            var cell4 = row.insertCell(3);
            cell4.innerHTML = "OR";
            var cell5 = row.insertCell(4);
            cell5.innerHTML = '<b>' + document.getElementById('inputActualValue').value + ' (Value)</b>';
      
        }
 
        function deleteRow(tableID) {
            try {
            var table = document.getElementById(tableID);
            var rowCount = table.rows.length;
 
            for(var i=0; i<rowCount; i++) {
                var row = table.rows[i];
                var chkbox = row.cells[0].childNodes[0];
                if(null != chkbox && true == chkbox.checked) {
                    table.deleteRow(i);
                    rowCount--;
                    i--;
                } 
            }
            }catch(e) {
                alert(e);
            }
        }
 
    </SCRIPT>
 <style>
/* This is for the message DIV */
    .odd { 
         background-color: #FCF7F7;
}
.even {
         background-color: #AAC590;
}

body .pbBody table.list tr th, body .pbBody table.list tr td {
border: 1px solid #ededed;
color: #000;text-align: center;
}

body .pbBody table.list tr.headerRow td, body .pbBody table.list tr.headerRow th {
 background:#61A631;
 color: #FFFFFF;text-align: center;
 }
   .bPageBlock {
border-top: 4px solid #74AE00!important;
margin-bottom: 9px;
background-color: #222;
background-image: url(/img/bgPageBlockLeft.gif);
background-repeat: no-repeat;
background-position: left bottom;
padding-bottom: 9px;
clear: both;
} 
    
    
    .EntityPairingBox {
        border: none;
        background-color: none;
        height: 30px;
        width: 600px;
        position: relative;
        float: left;        
    }
    
    .AgencyEntityPairing
    {
    position: absolute;
    height: 30px;
    width: 200px;
    }
    .AgencyEntityPairing2
    {
    height: 30px;
    width: 200px;
    position: absolute;
    }
    
    .RateOuterBox {
        border: 1px solid;
        background-color: none;
        height: 30px;
        width: 600px;
        position: relative;
        float: left;        
    }   
    .TraditionalRate
    {
        float:left;
    }
    .DigitalRate
    {
    float:right;
        width: 480px;
    }
    .AdaptationRate
    {
        width: 200px;
    }
    .TotalRate
    {
        float:right;
        width: 300px;
    }

   .Drop_Unilever
   {
    background: none repeat scroll 0 0 #FFFFFF;
    border: 2px solid #74AE00;
    border-radius: 5px;
    color: #000000;
    font-size: 16px;
    height: 30px;
    margin-top: 10px;
    padding: 0;
    width: 200px;
    padding-top: 2px;
    padding-left: 5px;
   }
   .values1
   {
    background: none repeat scroll 0 0 #FFFFFF;
border: 2px solid #74AE00;
border-radius: 5px;
color: #000000;
font-size: 16px;
height: 25px;
margin-top: 5px;
padding: 0;
width: 120px;
padding-top: 2px;
padding-left: 5px;
text-align: center;
   }
   
   .values1_add
   {
    background: none repeat scroll 0 0 #FFFFFF;
border: 2px solid #74AE00;
border-radius: 5px;
color: #000000;
font-size: 16px;
/* height: 25px; */
/* margin-top: 5px; */
padding: 0;
width: 120px;
padding-top: 2px;
padding-left: 5px;
text-align: center;
   }
   
   .values1_dropdown{
  background: none repeat scroll 0 0 #FFFFFF;
border: 2px solid #74AE00;
border-radius: 5px;
color: #000000;
font-size: 16px;
/* height: 25px; */
/* margin-top: 5px; */
padding: 0;
width: 156px;
padding-top: 2px;
padding-left: 5px;
text-align: center;
   }
   
   
   .country_values
   {
   background: none repeat scroll 0 0 #FFFFFF;
border: 2px solid #74AE00;
border-radius: 5px;
color: #000000;
font-size: 16px;
height: 30px;
margin-top: 4px;
padding: 0;
width: 125px;
padding-top: 2px;
padding-left: 5px;
text-align: center;
   }
   
   .values_total
   {
    background: none repeat scroll 0 0 #FFFFFF;
    border: 2px solid #74AE00;
    border-radius: 5px;
    color: #000000;
    font-size: 16px;
    height: 30px;
    margin-top: 10px;
    padding: 0;
    width: 120px;
    padding-top: 2px;
    padding-left: 5px;
    font-weight:bold;
    position:relative;
    text-align: center;
   }
     .values_total1
   {
   background: none repeat scroll 0 0 #FFFFFF;
border: 2px solid #74AE00;
border-radius: 5px;
color: #000000;
font-size: 16px;
font-weight: bold;
height: 25px;
margin-top: -23px;
padding: 4px 48px 6px 0px;
width: 120px !important;
text-align: center;
position: absolute;
   }
   
   .updatetotal_btn {
   background: none repeat scroll 0 0 #E400A7 !important;
border: 1px solid black;
border-radius: 5px !important;
color: #FFFFFF;
float: right;
font-size: 14px;
height: 29px;
margin-top: 9px;
padding-bottom: 20px;
padding-top: 5px;
width: 110px;
padding-right: 10px;
cursor: pointer;
font-weight: bold;
}
.save_btn{
background: none repeat scroll 0 0 #E400A7 !important;
border: 1px solid red!important;
border-radius: 5px !important;
color: #FFFFFF!important;
font-size: 14px!important;
height: 30px;
margin-top: 5px!important;
padding-bottom: 0px;
padding-top: 0px;
width: 104px;
margin-left: 15px !important;
 }
 
 .submit_btn{
background: none repeat scroll 0 0 #E400A7 !important;
border: 1px solid red!important;
border-radius: 5px !important;
color: #FFFFFF!important;
font-size: 14px!important;
height: 30px;
margin-top: 0px!important;
padding-bottom: 0px;
padding-top: 0px;
width: 104px;
margin-left: 10px!important;
/* margin-bottom: 10px!important; */
 }
 
 .submit_btn_addcomment{
 background: none repeat scroll 0 0 #004976 !important;
<!--border: 1px solid red!important;-->
border-radius: 5px !important;
color: #FFFFFF!important;
font-size: 14px!important;
height: 30px;
margin-top: -31px!important;
padding-bottom: 0px;
padding-top: 0px;
width: 115px;
margin-left: 10px!important;
margin-bottom: 10px!important;
 }
 
 
  .submit_btn_add{
 background: #004976 !important;
border-radius: 5px !important;
color: #FFFFFF!important;
font-size: 14px!important;
height: 30px;
margin-top: 25px!important;
padding-bottom: 0px;
padding-top: 4px!important;
width: 69px;
margin-left: 380px!important;
 }
 
 .submit_btn_delete{
background: #004976 !important;
border-radius: 5px !important;
color: #FFFFFF!important;
font-size: 14px!important;
height: 25px;
margin-top: 25px!important;
padding-bottom: 2px;
padding-top: 2px!important;
width: 66px;
/* margin-left: -18px!important; */
 }
 
  .submit_btndis{
    background: none repeat scroll 0 0 #CCC !important;
    border: 1px solid red!important;
    border-radius: 5px !important;
    color: #FFFFFF!important;
    font-size: 16px!important;
    height: 35px;
    margin-top: 13px ;
    padding-bottom: 20px;
    padding-top: 5px;
    width: 132px;
    margin-left:750px !important;
 }
 .table_country
    {
    border: 3px dotted #808080;
    margin-bottom: 30px;
    margin-left: 200px;
    padding: 10px;
    width: 30%;
    }
    
 .comment_box{
  background: none repeat scroll 0 0 #FFFFFF;
    border: 2px solid #74AE00;
    border-radius: 5px;
    color: #000000;
    font-size: 16px;
    height: 100px;
    margin-top: 10px;
    padding: 2px 0 0 5px;
    resize: none;
    text-align: left !important;
    width: 779px !important;
 }
     .regTitle
     {
     font-size: 16px!important;
     color:red;
     }
</style>  
<!--Tab Style - Vaseem to Amend -->
<style>
    .activeTab {background-color: #95BD4F;color: white;background-image: none;padding: 10px;cursor: pointer;font-size:16px;font-weight:bold;}
    .inactiveTab { background-color: lightgrey; color:black; background-image:none;cursor: pointer;font-size:16px;}
</style>


  <!--  <h1 style="padding: 0px 0px 0px 10px ! important; font-weight: normal; font-size: 20px; color: grey; display: block;">
         Agency Estimate - Base Fees
    </h1>  --> 
              <div class="row">           
        <div class="col-lg-12 charttable1">         
            <apex:image url="{!$Resource.header_new}" style="width:100%;height:37px;" />            
        </div>          
    </div>
    <div > 
    
    <div style="margin-left: 3px;width: 750px;">   <!-- start of functional border -->           
       
       <!-- <apex:outputText value="{!AgencyEstimate.AF_CentralBillingMessage__c}" title="Central Billing" style="font-size:16px;"></apex:outputText>-->
       <apex:outputText value="{!$Label.AF_Central_Billing_Hub}" title="Central Billing" style="font-size:16px;font-weight: bold;" rendered="{!IsCentralHub}"></apex:outputText>
        </div>       
 <apex:tabPanel switchType="ajax" id="MainPanel" tabClass="activeTab" inactiveTabClass="inactiveTab" selectedTab="{!ActivePanel}">
     <apex:tab label="Agency Estimate" name="Agency Estimate" id="AgencyEstimate" >
            <apex:actionSupport action="{!clearErrorMsg}" event="onchange" rerender="pm1,agencyestimatepanel"/>
             <apex:pagemessages id="pm1"></apex:pagemessages>
            <table align="center" >
        <tr>
            <td style="padding-left: 20px;font-size: 16px;padding-top:10px;">
                 <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">Unilever Entity</span>  
                <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 14px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 145px;height: 25px;padding-top: 5px;">{!AgencyEstimate.AF_Unilever_Entity_Name__c}
            </span>
            </td>
            <td style="padding-left: 20px;font-size: 16px;padding-top:10px;">
                  <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">Agency Entity</span> 
                <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 14px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 145px;height: 25px;padding-top: 5px;"> {!AgencyEstimate.AF_Agency_Entity_Name__c}
                </span>  
            </td>           
        </tr>
    </table> 
  
   
        <div  style="font-size: 16px;margin-left: 46px;margin-bottom:10px;margin-top:10px;"> 
            <!--Please enter all figures in thousands Euros: -->
        </div>  
         <apex:outputPanel id="agencyestimatepanel">
         <table align="center">
        <tr>
          <td style="padding-left: 10px;padding-right: 10px;padding-right: 2px;margin-top: 27px;display: block;text-align: right;"> 
           
           <span style="font-size: 20px;font-weight:bold;padding-top: 37px;">€ </span>
           </td>
           <td style="padding-right: 10px;"> 
                
             <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
                 Traditional
             </span>
              <apex:outputpanel rendered="{!IsReadyforPO}">
              <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
              <apex:outputText value="{!TraditionalDisplay}"  rendered="{!IsReadyforPO}" id="tradoutput">
              </apex:outputText>
               </span>  
               </apex:outputpanel>  
             <apex:outputpanel rendered="{!!IsReadyforPO}">
            <apex:inputText value="{!TraditionalDisplay}" maxlength="10" onkeypress="return isNumberKey(event)" styleClass="values1" disabled="false" rendered="{!IsEditMode}" id="tradinput">
                    <apex:actionSupport event="onchange" 
                                action="{!calculateTotal}" 
                                rerender="totalFigure2" /> 
            
            </apex:inputText>
            </apex:outputpanel>
         <!--   <span style="font-size: 14px; display: block;text-align: center;padding-top:5px;">
            <apex:outputText id="TraditionalRateOT" >{!AgencyEstimate.AF_Matrix_Data_Entry_Currency__c}
            </apex:outputText>
                                :
                <apex:outputText value="{0,number,###,###,###}">
                   <apex:param value="{!AgencyEstimate.AF_Traditional_Local__c}"/>
               </apex:outputText>
            </span>-->
            </td>        
            <td style="padding-right: 10px;"> 
            <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
              Digital
            </span>
             <apex:outputpanel rendered="{!IsReadyforPO}">
             <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
               <apex:outputText value="{!DigitalDisplay}"  rendered="{!IsReadyforPO}">
               </apex:outputText> 
              </span>
               </apex:outputpanel>
                <apex:outputpanel rendered="{!!IsReadyforPO}">
                <apex:inputText value="{!DigitalDisplay}" maxlength="10" onkeypress="return isNumberKey(event)" styleClass="values1" disabled="false" rendered="{!IsEditMode}">
                   <apex:actionSupport event="onchange" 
                                action="{!calculateTotal}" 
                                rerender="totalFigure2" /> 
                </apex:inputText>
                 </apex:outputpanel>
                <!-- <span style="font-size: 14px; display: block;text-align: center;padding-top:5px;">
                 <apex:outputText id="DigitalRateOT" >{!AgencyEstimate.AF_Matrix_Data_Entry_Currency__c}</apex:outputText>
                :
                <apex:outputText value="{0,number,###,###,###}">
                   <apex:param value="{!AgencyEstimate.AF_Digital_Local__c}"/>
               </apex:outputText> 
                </span>-->
            </td>
            
             <td style="padding-right: 30px;"> 
             <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
                 Adaptation
             </span>
             <apex:outputpanel rendered="{!IsReadyforPO}">
              <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
               <apex:outputText value="{!AdaptationDisplay}" rendered="{!IsReadyforPO}">
                </apex:outputText> 
               </span>
                 </apex:outputpanel>
              <apex:outputpanel rendered="{!!IsReadyforPO}">
              <apex:inputText onkeypress="return isNumberKey(event)" maxlength="10" value="{!AdaptationDisplay}" styleClass="values1" disabled="false" rendered="{!IsEditMode}">
                                <apex:actionSupport event="onchange" action="{!calculateTotal}" rerender="AdataiveLocal,totalFigure2"/> 
                </apex:inputText>
                </apex:outputpanel>
            <!--   <span style="font-size: 14px; display: block;text-align: center;padding-top:5px;">
                <apex:outputText id="AdaptationRateOT" >{!AgencyEstimate.AF_Matrix_Data_Entry_Currency__c}</apex:outputText>
               :
               <apex:outputText value="{0,number,###,###,###}" id="AdataiveLocal">
                   <apex:param value="{!AgencyEstimate.AF_Adaptation_Local__c}"/>
               </apex:outputText>
                 </span> -->                  
            </td>            
            <!-- <td> <div style="padding-right: 30px;">                  
                 <input type='button' value='Update Total' class="updatetotal_btn" >
                 <apex:actionSupport event="onclick" action="{!calculateTotal}" rerender="totalFigure"/>                 
                 </input>                  
            </div> </td> -->
            
           <td style="padding-right: 30px;margin-left: -20px!important;display: block;">  
            <span style="display: block;font-size: 16px;margin-top: 0px;padding-left: 40px;position: absolute;font-weight:bold;">
                 Total
              </span>
                         
            <!--  <span class="values_total1">-->
                 <span style="margin-top: 25px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
                <apex:outputText value="{0,number,###,###,###}" id="totalFigure2" styleClass="values_Unileverestimate">
                 <apex:param value="{!TotalDisplayN}"/> 
                </apex:outputText>
               </span>  
               <!-- </span> -->
               
        <apex:outputPanel rendered="false">
         <span style="margin-top: 25px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 120px;height: 25px;padding-top: 5px;">
              <apex:OutputText value="{0,number,###,###,###}" id="totalFigure" style=" margin-left: 31px;">
                  <apex:param value="{!AgencyEstimate.AF_Total__c}" id="totalFigure1"/>
              </apex:OutputText> 
              
              </span> 
        </apex:outputPanel> 
                
            </td>
            <td style="padding-right: 30px;">
            <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
                 Ex Rate
             </span>
             
       
       
       <apex:outputPanel style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
       <apex:outputText ></apex:outputText>
       </apex:outputPanel>
       
       </td>
            
        </tr>
   <tr>
       
       <td  style="text-align: right;">
       <span style="font-size: 15px;font-weight:bold;padding-top: 37px;">
       <!-- <apex:outputText rendered="{!if(AND(AgencyEstimate.AF_Agency_Exchange_Rate__c!=Null),'true', 'false')}"> Local Currency</apex:outputText> &nbsp;&nbsp;-->
       <apex:outputPanel style="font-size: 18px;font-weight:bold;padding-top: 37px;">   
       <apex:outputText id="DigitalRateOT1" rendered="{!if(AND(AgencyEstimate.AF_Agency_Exchange_Rate__c!=Null),'true', 'false')}" >LC-{!AgencyEstimate.AF_Matrix_Data_Entry_Currency__c}</apex:outputText>
       </apex:outputPanel>
       
       </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
        <apex:outputText value="{0,number,###,###,###}" rendered="{!!IsReadyforPO}">
             <apex:param value="{!AgencyEstimate.AF_Traditional_Local__c}"/>
        </apex:outputText>
        <apex:outputText value="{0,number,###,###,###}" rendered="{!IsReadyforPO}">
             <apex:param value="{!AgencyEstimate.AF_LC_Traditional__c}"/>
        </apex:outputText>
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" rendered="{!!IsReadyforPO}">
                   <apex:param value="{!AgencyEstimate.AF_Digital_Local__c}"  />
         </apex:outputText> 
         <apex:outputText value="{0,number,###,###,###}" rendered="{!IsReadyforPO}">
                   <apex:param value="{!AgencyEstimate.AF_LC_Digital__c}"  />
         </apex:outputText>
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" id="AdataiveLocal1" rendered="{!!IsReadyforPO}">
                   <apex:param value="{!AgencyEstimate.AF_Adaptation_Local__c}"/>
         </apex:outputText>
         <apex:outputText value="{0,number,###,###,###}" id="AdataiveLocal2" rendered="{!IsReadyforPO}">
                   <apex:param value="{!AgencyEstimate.AF_LC_Adaptation__c}"/>
         </apex:outputText>
        </span>
       </td>
        <td>
        <span style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" id="TotalLocal" rendered="{!!IsReadyforPO}">
                   <apex:param value="{!TotalLocal}"/>
         </apex:outputText>
         <apex:outputText value="{0,number,###,###,###}" id="TotalLocal2" rendered="{!IsReadyforPO}">
                   <apex:param value="{!AgencyEstimate.AF_LC_Total__c}"/>
         </apex:outputText>
        </span>
       </td>
       <td>
       <span>
       
       <apex:outputPanel style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
       <apex:outputText rendered="{!if(AND(AgencyEstimate.AF_Agency_Exchange_Rate__c!=Null),'true', 'false')}" >{!AgencyEstimate.AF_Agency_Exchange_Rate__c}</apex:outputText>
       </apex:outputPanel>
       </span>
       </td>
       
   </tr>
   <tr>
   <apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c!=Null,IsReadyforPO,AgencyEstimate.AF_IsCrossborder__c),'true', 'false')}">
       <td  style="text-align: right;">
       <span style="font-size: 15px;font-weight:bold;padding-top: 37px;">
        <!--<apex:outputText> ReadyforPO Currency</apex:outputText> &nbsp;&nbsp;-->
        <apex:outputPanel style="font-size: 18px;font-weight:bold;padding-top: 37px;">
          <apex:outputText >PO-{!AgencyEstimate.AF_Ready_For_PO_Entry_Currency__c}
          </apex:outputText> 
        </apex:outputPanel>
      
       </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
        <apex:outputText value="{0,number,###,###,###}">
             <apex:param value="{!AgencyEstimate.Traditional_USD_Formula__c}"/>
        </apex:outputText>
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}">
                   <apex:param value="{!AgencyEstimate.AF_Digital_USD_Formula__c}"/>
               </apex:outputText> 
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" id="AdataiveLocalUSD">
                   <apex:param value="{!AgencyEstimate.Adaptation_USD_Formula__c}"/>
               </apex:outputText>
        </span>
       </td>
        <td>
        <span style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" id="TotalLocalUSD">
                   <apex:param value="{!AgencyEstimate.AF_Total_USD__c}"/>
               </apex:outputText>
        </span>
       </td>
       <td>
       <span>
         <apex:outputPanel style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">      
          <apex:outputText >
         {!AgencyEstimate.AF_Agency_Spot_Rate__c}
          </apex:outputText> 
        </apex:outputPanel>
       </span>
       </td>
     </apex:outputPanel>
   </tr>
   <tr>
   <apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c==Null,IsReadyforPO,NOT(AgencyEstimate.AF_IsCrossborder__c)),'true', 'false')}">
       <td  style="text-align: right;">
       <span style="font-size: 15px;font-weight:bold;padding-top: 37px;">
        
        <apex:outputPanel style="font-size: 18px;font-weight:bold;padding-top: 37px;" rendered="{!if(AND(AgencyEstimate.AF_Agency_Exchange_Rate__c!=Null),'true', 'false')}">
          <apex:outputText >PO-{!AgencyEstimate.AF_Matrix_Data_Entry_Currency__c}
          </apex:outputText> 
        </apex:outputPanel>
      
       </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
        <apex:outputText value="{0,number,###,###,###}">
             <apex:param value="{!AgencyEstimate.AF_Traditional_Local__c}"/>
        </apex:outputText>
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}">
                   <apex:param value="{!AgencyEstimate.AF_Digital_Local__c}"/>
               </apex:outputText> 
        </span>
       </td>
       <td>
        <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" >
                   <apex:param value="{!AgencyEstimate.AF_Adaptation_Local__c}"/>
               </apex:outputText>
        </span>
       </td>
        <td>
        <span style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
         <apex:outputText value="{0,number,###,###,###}" >
                   <apex:param value="{!TotalLocal}"/>
               </apex:outputText>
        </span>
       </td>
       <td>
       <span>
         <apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Exchange_Rate__c!=Null),'true', 'false')}" style="margin-top: 5px; margin-left:-20px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">      
          <apex:outputText >
         {!AgencyEstimate.AF_Agency_Exchange_Rate__c}
          </apex:outputText> 
        </apex:outputPanel>
       </span>
       </td>
     </apex:outputPanel>
   </tr>
         <tr>
         <td colspan="8" align="right">
         <!--
         <br / >
         <apex:commandButton value="Undo" image="http://www.veryicon.com/icon/16/System/Must%20Have/Undo.png"  action="{!Reload}" /> 
          <br/><br/>
          -->
          </td>
          </tr> 
        </table>
         </apex:outputPanel>
        <!-- <div style="font-size: 16px;margin-left: 163px;margin-bottom:20px;"> 
            <apex:outputText value="Unilever average exchange rate:" rendered="{!if(OR(AND(AgencyEstimate.AF_Agency_Spot_Rate__c==Null,IsReadyforPO),NOT(IsReadyforPO)),'true', 'false')}"></apex:outputText>
            <apex:outputText value="Unilever Monthly Exchange Rate" rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c!=Null,IsReadyforPO),'true', 'false')}"></apex:outputText>
             
            <apex:outputField value="{!AgencyEstimate.AF_Agency_Exchange_Rate__c}" rendered="{!!IsReadyforPO}" /> 
            
           <!-- <apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c!=Null),'true', 'false')}">
            <apex:outputField value="{!AgencyEstimate.AF_Agency_Spot_Rate__c}" rendered="{!IsReadyforPO}"/>
            </apex:outputPanel>-->
            <!--<apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c!=Null),'true', 'false')}">
            <apex:outputField value="{!AgencyEstimate.AF_Agency_Spot_Rate__c}" rendered="{!IsReadyforPO}"/>
            </apex:outputPanel>-->
           <!-- <apex:outputPanel rendered="{!if(AND(AgencyEstimate.AF_Agency_Spot_Rate__c==Null),'true', 'false')}">
            <apex:outputField value="{!AgencyEstimate.AF_Agency_Exchange_Rate__c}" rendered="{!IsReadyforPO}" /> 
             </apex:outputPanel>
        </div>-->
        
         
             <div style="margin-left:45px;width: 741px;">   <!-- start of functional border -->    


     <!--<apex:commandButton value="Save" action="{!JustSave}" styleClass="save_btn" reRender="agencyestimatepanel,pm1,CountryAddPanel" rendered="{!if(AND(isAgencyEstEditable,NOT(IsReadyforPO)),true,false)}"  />-->
    <!-- <apex:commandButton value="Save" action="{!JustSave}" styleClass="save_btn" reRender="agencyestimatepanel,pm1,CountryAddPanel" disabled="true" rendered="{!if(OR(AND(isAgency,NOT(fieldsReadOnly)),AND(isCatFinance,NOT(catFieldsReadOnly)),AND(isCMCO,NOT(cmcoFieldsReadOnly)),isCMCO,AND(isCMCOSuperUser,IsReadyforPO)),'true', 'false')}"  />-->
     <apex:commandButton value="Save" action="{!JustSave}" styleClass="save_btn" reRender="agencyestimatepanel,pm1,CountryAddPanel"  rendered="{!if(OR(AND(isAgency,fieldsReadOnly),AND(isCatFinance,catFieldsReadOnly),AND(isCMCOSuperUser,NOT(IsReadyforPO))),'true', 'false')}"  />
     
     <apex:commandButton value="Edit" action="{!NowInEditMode}" reRender="agencyestimatepanel" styleClass="submit_btn" rendered="false"/>
    <!-- <apex:commandButton value="Submit" styleClass="submit_btndis" rendered="{!(SubmitButtonDisplay==true)}" disabled="{!SubmitButtonDisplay}"/>-->
    
    <!--             
    <apex:commandButton value="Save and Close" onclick="submitData();return false;"  styleClass="submit_btn" rendered="{!(SubmitButtonDisplay==false)}" >
        <apex:actionfunction id="submitData" name="submitData" action="{!Save}" oncomplete="closeAndRefresh();" />
    </apex:commandButton>
    -->
    <apex:commandButton value="Add Comment" onClick="commentsToggleOpen('commentAddTable');return false;" styleClass="submit_btn_addcomment" action="{!AddComment}" />
      
    
    </div>     <!-- end of functional border -->
    <c:AF_CommentsListComp ParentRecordValue="{!ParentId}" IsViewAllValue="false" ParentObjectTypeDesc="AF_Agency_Estimate__c"  />
    
    <c:AF_FieldHistoryComp ParentRecordValue="{!ParentId}" IsViewAllValue="false"  ParentObjectName="AF_Agency_Estimate__c"/>  
         
     </apex:tab>
     <apex:tab label="Country Breakdown" name="Country Breakdown" id="CountryBreakdown" rendered="{!IsCentralHub}">
   <apex:actionSupport event="onchange" reRender="CountryAddPanel,pm3" action="{!clearErrorMsg}"/>
   
    <apex:pagemessages id="pm3"/>         
    <apex:outputPanel id="CountryAddPanel" rendered="{!IsCentralHub}">
  
  
  <div>
  
    
  
  </div>

        <div style="font-family:arial;color:red;font-size:16px;text-align:center" id="regTitle"></div>  
 <apex:pageBlock id="pgentity">
 <apex:pageblockTable value="{!Wrapperlist }" var="Entity" id="pbt" style="font-size:16px;height:25px!important;margin-left: 15%;width: 50%;">
 
 <apex:column headerValue="Country">
    <apex:selectList id="Countryname" value="{!Entity.EntityEX.AF_Country__c}" styleClass="values1_dropdown" size="1">
      <apex:selectOptions value="{!Countrynames}"/>
   </apex:selectList>
  </apex:Column>
  <apex:column headerValue="%" style="text-align: center;width: 125px!important;" >
   <apex:facet name="footer">
  
    <apex:outputText value="{!TotalPercent}" id="entityper" style="text-align: center;/*width: 125px!important; border: 1px solid red; */ display: block;"/>
  </apex:facet>
  <apex:inputField id="percent" value="{!Entity.EntityEX.AF_Value__c}"  styleClass="values1_add" >
   <apex:actionSupport action="{!CalculateCountryValue}" event="onchange" reRender="entityval,val,entityper" />  
  </apex:inputField>
  </apex:column>
  <apex:column headerValue="Value €" style="text-align: center;width: 125px!important;/* border: 1px solid red; */ display: block;/* height: 32px; *//* margin-top: 12px; */padding-top: 9px;padding-bottom: 12px;">
  <apex:facet name="footer">
    <apex:outputText value="{0,number,###,###,###.##}" id="entityval">
         <apex:param value="{!TotalValue}"/>
     </apex:outputText>
  </apex:facet>
  
  <apex:outputField id="val" value="{!Entity.EntityEX.AF_Value_Euro__c}" />
  </apex:column>
  <apex:column style="text-align: center;width: 125px!important;">
    <apex:commandLink action="{!delCounrtyRecord}" rendered="{!if(OR(AND(isAgency,fieldsReadOnly),AND(isCatFinance,catFieldsReadOnly),isCMCOSuperUser),'true', 'false')}" rerender="pbt,entityval,pm3" style="text-align: center;width: 125px!important;"> Delete 
        <apex:param name="DelCountry" value="{!Entity.EntityEX.Id}" assignTo="{!delCountryId}"/>
        <apex:param name="PosDelete" value="{!Entity.position}" assignTo="{!posDelete}"/>
    </apex:commandLink>
 </apex:column>
 <!-- <apex:column HeaderValue="Select Delete">
   <apex:commandLink value="Delete" style="color:white;font-size: 14px;font-weight: bold;text-decoration: none;padding-left: 11px;/* height: 30px; */" action="{!DeleteEntityException}"><apex:param name="deleteException" value="{!Entity.EntityEX.Id}" assignTo="{!ExceptionId}"/></apex:commandLink>
  </apex:column>-->
  
 </apex:pageblockTable>
 
 <apex:commandButton value="Add" action="{!AddNewRow}" rendered="{!if(OR(AND(isAgency,fieldsReadOnly),AND(isCatFinance,catFieldsReadOnly),isCMCOSuperUser),'true', 'false')}" reRender="pbt" styleClass="submit_btn_add" style="margin-left:250px"/>
 <apex:commandButton value="Save" rendered="{!if(OR(AND(isAgency,fieldsReadOnly),AND(isCatFinance,catFieldsReadOnly),isCMCOSuperUser),'true', 'false')}" action="{!SaveEntityExceptionRecords}" reRender="pm1,pm3,pbt" styleClass="submit_btn"/>
 </apex:pageBlock>

 <apex:outputPanel rendered="false">
 <table rowClasses="even,odd">
        <tr>
            <td style="padding-left: 29px;padding-right: 10px;"> 
             <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
                 Country:
             </span>   
            <apex:inputField value="{!EntityException.AF_Country__c}" styleClass="country_values">
            </apex:inputField>                                              
            </td>                    
            <td style="padding-right: 10px;"> 
            <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
              %
            </span>            
            <apex:inputField value="{!EntityException.AF_Value__c}" id="EntityException_val" onkeypress="return isNumberKey(event)" styleClass="values1" />                
            </td>            
             <td style="padding-right: 30px;"> 
             <span style="font-size: 16px; display: block;text-align: center;font-weight:bold;">
                Value
             </span>
             <apex:inputField value="{!EntityException.AF_Value_Euro__c}" onkeypress="return isNumberKey(event)" styleClass="values1" />                                                
            </td>                        
           <td >  
            <apex:commandButton value="Add"  action="{!SaveEntityException}" styleClass="submit_btn_add"/>
            </td>             
        </tr>            
    </table> 
     
</apex:outputPanel>
         <apex:outputPanel id="CountryListPanel" rendered="{!DisplayExceptionList}"> 
<table>
<!-- <tr>

    <td style="padding-left: 45px;padding-right: 40px;"> 
         <span style="font-size: 14px; display: block;text-align: left;font-weight:bold;">
              Country
            </span>         
    </td>
    <td>
        <span style="font-size: 16px; display: block;text-align: left;font-weight:bold;">
              %
         </span>         
    </td>
    <td>
        <span style="font-size: 16px; display: block;text-align: left;font-weight:bold;">
            Value
         </span>        
    </td>   
    <td></td>
</tr>  
-->
<!--
<apex:repeat value="{!EntityExceptionCollection}" var="c">
<tr>
     <td style="padding-left: 29px;padding-right: 10px;"> 
    <span style="font-size: 16px; display: block;text-align: left;">
        <apex:outputText value="{!c.AF_Country__c}" />
    </span> 
    </td>
   <td style="padding-right: 10px;"> 
        <span style="font-size: 16px; display: block;text-align: left;margin-left: 62px;">
        <apex:outputText value="{!c.AF_Value__c}" /> 
        </span>
    </td>
    <td style="padding-right: 30px;"> 
    <span style="font-size: 16px; display: block;text-align: left;margin-left: 118px;margin-right: 46px;">
        <apex:outputText value="{!c.AF_Value_Euro__c}" /> 
        </span>
    </td>
    <td class="submit_btn_delete">
    <span>
    <apex:commandLink value="Delete" style="color:white;font-size: 14px;font-weight: bold;text-decoration: none;padding-left: 11px;/* height: 30px; */" action="{!DeleteException}">
    <apex:param name="deleteException" value="{!c.Id}" assignTo="{!ExceptionId}"/>
    </apex:commandLink>
    </span>
    </td>
     
</tr>
</apex:repeat>  
-->
</table>  
</apex:outputPanel>   
</apex:outputPanel> 
</apex:tab>

 <apex:tab label="PO Number" name="PO Number" id="ReadyforPO" rendered="{!IF(AND(IsShowPOTab,IsReadyforPO),true,false)}">
 <apex:outputPanel id="optReadyPo">
 <apex:pagemessages id="PO_Num"/>
 <table Align="center">
     <tr>
         <td>
         <span style="font-size: 16px; font-weight:bold;display: block;text-align: center;">PO Number</span>
         </td>
        <!-- <td>
        <span style="font-size: 16px; font-weight:bold;display: block;text-align: center;"> PO Value</span>
         </td>-->
     </tr>
     <tr>
     <td style="text-align:center;">
     <apex:inputField value="{!AgencyEstimate.AF_PO_Number__c}" id="Ponumber" styleClass="values1" rendered="{!isPOEditable}" />
     <apex:outputPanel rendered="{!IsReadonlyPO}">
     <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;">
     <apex:outputField value="{!AgencyEstimate.AF_PO_Number__c}" id="ReadPonumber" />
     </span>
     </apex:outputPanel>
     </td>
   <!--  <td>
     <apex:inputField value="{!AgencyEstimate.AF_PO_Value__c}" styleClass="values1" rendered="{!isPOEditable}"/>
      <apex:outputPanel rendered="{!!isPOEditable}">
     <span style="margin-top: 5px;font-weight:bold;border:1px solid black;border-radius:5px;color:white;font-size: 16px; display: block;text-align: center;background-color:#7f8c8d;/* padding: 5px; */width: 125px;height: 25px;padding-top: 5px;"> 
     <apex:outputText value="{!PoValue}" id="ReadPoValue" rendered="{!!isPOEditable}" />
     </span>
     </apex:outputPanel>
     </td>-->
     
     
     </tr>
     <tr>
       <td colspan = "2">
       <apex:commandButton value="Save" action="{!UpdatPO}" style="Align:center" styleClass="save_btn" rendered="{!isPOEditable}" reRender="optReadyPo,PO_Num"/>
       </td>
       </tr>  
 </table>

 </apex:outputPanel>
 </apex:tab>
 </apex:tabPanel>

    </div>

     
 
   <!-- 
   <br/>
    <c:AF_AddCommentComp ParentRecordValue="{!ParentId}" ParentObjectTypeDesc="AF_Agency_Estimate__c" />
   --> 
   <!-- <c:AF_ApprovalButtonsComp ParentRecordValue="{!ParentId}" ApprovedEnabled="true" ReturnEnabled="false" rendered="false"/>   -->

 
<script>
  function commentsToggleOpen(elementId) 
  {
      //alert(elementId);
      document.getElementById(elementId).style.display = 'block';
  }
  function commentsToggleClose(elementId) 

  { 
      //alert(elementId);
      document.getElementById(elementId).style.display = 'none';
  }
  commentsToggleClose('commentAddTable');


</script>
</apex:form> 
</apex:page>