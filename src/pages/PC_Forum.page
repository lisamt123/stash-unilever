<apex:page html-class="noBgImage" controller="PC_ForumController" readOnly="true" docType="html-5.0" sidebar="false" showHeader="false" standardStylesheets="true">
    <!-- javascript -->
    <apex:includeScript value="{!URLFOR($Resource.PCResources, '/js/jquery-1.12.0.min.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.PCResources, '/js/bootstrap.min.js')}" />

    <!-- sylesheets -->
    <apex:stylesheet value="{!URLFOR($Resource.PCResources, '/css/bootstrap.min.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.PCResources, '/css/PCContainer.css')}" />

    <div class="wrapper">
        <div class="row topRow">
            <div class="col-md-12 col-lg-12">
                <div class="heading">
                    PlanCraft Forum
                </div>
            </div>
        </div>

        <div class="row">
            <!-- static icon -->
            <div class="col-md-3 col-lg-3">
                <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(PlancraftGroup))}">
                    <div class="categories">
                        <div class="thumbnail">
                            <a href="{!$Page.PC_ForumGroup}?id={!PlancraftGroup.Id}">
                                <apex:variable var="img" value="{!IF(ISBLANK(PlancraftGroup.Image_ID__c), URLFOR($Resource.PCResources, '/img/noImage.png'), '/servlet/servlet.FileDownload?file=' + PlancraftGroup.Image_ID__c)}" />
                                <apex:image value="{!img}" html-data-container="body" html-data-toggle="popover" html-data-trigger="hover" title="{!PlancraftGroup.Title__c}" html-data-content="{!PlancraftGroup.Summary__c}" html-data-placement="right auto" />
                            </a>
                        </div>
                    </div>
                </apex:outputPanel>
            </div>

            <div class="col-md-9 col-lg-9">
                <!--- carousel start -->
                <apex:outputPanel layout="none" rendered="{!AND(NOT(ISBLANK(GroupList)), GroupList.size > 0)}">
                    <div id="categories" class="carousel slide categories" data-ride="carousel">
                        <!-- Wrapper for slides -->
                        <apex:variable value="0" var="idx"/>
                        <div class="carousel-inner" role="listbox">
                            <apex:repeat value="{!GroupList}" var="page">
                                <div class="{!IF(idx == '0', 'item active' , 'item')}">
                                    <div class="row">
                                        <apex:variable value="0" var="innerIdx" />
                                        <apex:repeat value="{!page}" var="groupObj">
                                            <div class="col-md-4 col-lg-4">
                                                <div class="thumbnail">
                                                    <a href="{!$Page.PC_ForumGroup}?id={!groupObj.Id}">
                                                        <apex:variable var="img" value="{!IF(ISBLANK(groupObj.Image_ID__c), URLFOR($Resource.PCResources, '/img/noImage.png'), '/servlet/servlet.FileDownload?file=' + groupObj.Image_ID__c)}" />
                                                        <apex:image value="{!img}" html-data-container="body" html-data-toggle="popover" html-data-trigger="hover" title="{!groupObj.Title__c}" html-data-content="{!groupObj.Summary__c}" html-data-placement="right auto" />
                                                    </a>
                                                </div>
                                            </div>
                                        </apex:repeat>
                                    </div>
                                </div>
                                <apex:variable value="{!VALUE(idx) + 1}" var="idx"/>
                            </apex:repeat>
                        </div>
                    </div>

                    <apex:outputPanel layout="none" rendered="{!AND(NOT(ISBLANK(GroupList)), GroupList.size > 1)}">
                        <nav class="carouselPager">
                            <ul class="pager">
                                <apex:variable value="0" var="idx"/>
                                <apex:repeat value="{!GroupList}" var="page">
                                    <li data-target="#categories" data-slide-to="{!idx}" class="{!IF(idx == '0', 'active' , '')}"><span>{!VALUE(idx) + 1}</span></li>
                                    <apex:variable value="{!VALUE(idx) + 1}" var="idx"/>
                                </apex:repeat>
                            </ul>
                        </nav>
                    </apex:outputPanel>
                </apex:outputPanel>

                <!--- carousel end -->
            </div>
        </div>
        <div class="row">
            <div class="col-md-3 col-lg-3 leftNav">

                <div class="box">
                    <div class="headerBox">
                        TOP 10 FAQs
                    </div>
                    <ul>
                        <knowledge:articleList articleTypes="PBS_FAQ_s__kav" articleVar="article" sortBy="mostViewed" pageSize="10">
                            <li><a href="{!URLFOR($Action.KnowledgeArticle.View, article.id)}" target="_self">{!article.title}</a></li>
                        </knowledge:articleList>
                    </ul>
                    <div class="right">
                        <a onclick="window.parent.postMessage({itemId: 'pbs'}, '*');" href="{!$Page.PBS_Library}">View Library to see more &raquo;</a>
                    </div>
                </div>

            </div>
            <div class="col-md-9 col-lg-9">
                <div class="headerBox noExtraPadding">Feed</div>
                <div class="chatterWrapper zen">
                    <chatter:newsfeed />
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $('#categories').carousel({
            interval: 5000
        });

        $('#categories').on('slide.bs.carousel', function (event) {
            var idx = $('#categories .item').index(event.relatedTarget);
            $('.carouselPager li.active').removeClass('active');
            if (idx > -1) {
                $('.carouselPager li').eq(idx).addClass('active');
            }
        });

        $('.categories img').popover();
    </script>
</apex:page>