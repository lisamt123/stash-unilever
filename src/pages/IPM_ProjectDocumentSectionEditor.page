<!--  
*************************************************************************
*@Description: This page used for editing the Gate Document Sections and attaching Files
*@Author: Cognizant
*@Created Date: 26/12/2014
*@Copyright 2015  Unilever  
*************************************************************************
-->
<apex:page Controller="IPM_ProjectDocumentSectionController" sidebar="false" standardStylesheets="true" id="page"  docType="html-5.0" extensions="IPM_GetHelpDoc">
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_SecEditor.css')}"/>     
    <apex:composition template="IPM_TemplateRevamp"> 
        <apex:define name="body" >
            <apex:form id="form">
                <div class='cust-overlay'></div>
                <div class="gradientbg">
                        <c:IPM_ProjectDetails project="{!project}" activeItem="gateDocument"/>
                </div>
                <div class="ipmContent">            
                    <apex:pagemessages id="pmsg"/>
                    <div class="row">  
                        <div class="col-sm-12">
                            <div class="panel-group pageHeadToolbar clearfix">
                                <div class="row">                                                             
                                    <div class="col-sm-11 noPadleft noPadright pull-left pageHeading">                                    
                                        <span class="SecButtonSet pull-left">
                                            <a class="icoButton arrow-left" title="{!$Label.IPM_Go_back_to_gate}" href="{!$Page.IPM_GateDocument}?id={!projectId}&printDoc={!projDoc.IPM_GateDocuments__c}"></a>
                                        </span>
                                        <h2 class="pageTitle">
                                                <apex:outputText value="{!projDocSec.IPM_Section_Sequence__c}"/> 
                                             <span>{!projDocSec.IPM_Section_Name__c } [{!projDocSec.IPM_FunctionalRole__c}]</span>
                                        </h2>
                                        <div class="secEditorNav pull-left">                                                                  
                                                <apex:outputPanel styleClass="pull-left prevNav" layout="block" rendered="{!showPre}">   
                                                   <apex:commandLink value="< Previous" action="{!pagination}">  
                                                   <apex:param assignTo="{!isFlagedPre}" name="IsFlagPre" value="FlagedPre"/>
                                                   </apex:commandLink> 
                                                </apex:outputPanel>  
                                                 <div class="secEditorNavList pull-left">        
                                                        <apex:selectList id="myidsec" multiselect="false" value="{!secList}" size="1" onchange="changeSection(this.value);">
                                                                <apex:selectOptions value="{!SecOption}" /> 
                                                        </apex:selectList>
                                                         <apex:actionFunction action="{!lstPagination}" name="changeSection" reRender="">
                                                        <apex:param name="secName" assignTo="{!projDocSecId}" value=""/>
                                                    </apex:actionFunction> 
                                                </div>
                                                <apex:outputPanel styleClass="pull-left nextNav" layout="block" rendered="{!showNext}">                                 
                                                   <apex:commandLink value="Next >" action="{!pagination}">
                                                    <apex:param assignTo="{!isFlagedNext}" name="IsFlagNext" value="FlagedNext"/>
                                                   </apex:commandLink> 
                                                </apex:outputPanel> 
                                               
                                        </div>                                    
                                        <apex:outputPanel id="changeType">
                                            <apex:outputPanel rendered="{!IF(projDocSec.IPM_Negotiable__c==true,false,false)}" >
                                                <span class="selLabel greytxt">{!$Label.IPM_MARK_IT_AS}</span>
                                                <label class="ipmSelect">
                                                    <apex:selectList multiselect="false" value="{!projDocSec.IPM_Negotiable__c}" size="1" onchange="change()" disabled="{! If(AND(IsEditableSumm=false),'true','false')}">
                                                        <apex:selectOption itemLabel="Optional" itemValue="true" />
                                                        <apex:selectOption itemLabel="Non-Negotiable" itemValue="false"/>    
                                                    </apex:selectList>                            
                                                </label>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </div>  
                                    
                                    <div class="buttonMarginRight SecButtonSet pull-right">
                                        <a class="icoButton history" data-toggle="modal" data-target="#ipmModal" value="{!$Page.IPM_SectionHistory}?Id={!projDocSecId}" data-backdrop="static" data-keyboard="false" title="View Update History" id="showHistory"></a>
                                        <!-- To place the help symbol in the top right hand corner of page -->
                                        <apex:outputLink value="{!URL}" id="theLink" styleClass="icoButton question" target="_blank" title="{!$Label.IPM_Help}">?</apex:outputLink>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>  
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="panel-group pageHelpToolbar clearfix">
                                <div class="row clearfix mt15 mb15">
                                    <div class="col-sm-10 greytxt pull-left">
                                        <apex:outputText value="{!projDocSec.IPM_Section__r.IPM_Section_Help_Text__c}"/>
                                    </div>
                                    <div class="col-sm-2 SecButtonSet pull-right">
                                        <div class="row">                          
                                           <a class="icoButton comments" data-toggle="modal" data-target="#ipmModal" value="{!$Page.IPM_CommentsPage}?id={!projDocSec.Id}" data-backdrop="static" data-keyboard="false" title="{!projDocSec.IPM_Section_Sequence__c} {!projDocSec.IPM_Section_Name__c} Comments" id="showComment">
                                                <apex:outputPanel styleClass="count" rendered="{!IF(projDocSec.IPM_Count_of_Comments__c!=null && projDocSec.IPM_Count_of_Comments__c >0 ,True,False)}">{!projDocSec.IPM_Count_of_Comments__c}</apex:outputPanel>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row ipmSectionEditor">
                        <div class="col-sm-12">
                            <div class="panel-group clearfix">
                                <div class="clearfix">
                                    <div class="col-sm-6">
                                    <!-----FUnctional Input BEGIN---->
                                        <div class="panel">
                                            <!-- below panel renders when project document section master section external id is any of "Risk", "OTIF_Status", "Gate_Keeper_Checklist", "Country_Feedback_Requirements" or "BD/BB_Alignment" -->
                                            <apex:outputPanel rendered="{!if(OR(projDocSec.IPM_Master_Section_External_Id__c=='Risk',projDocSec.IPM_Master_Section_External_Id__c=='OTIF_Status',projDocSec.IPM_Master_Section_External_Id__c=='Gate_Keeper_Checklist',projDocSec.IPM_Master_Section_External_Id__c=='Country_Feedback_Requirements',projDocSec.IPM_Master_Section_External_Id__c=='BD/BB_Alignment'),false,true)}">
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="panel panelOutcome">         
                                                            <apex:outputText value="Functional input" styleClass="outcomeTxt"/><span class="SecButtonSet"><a class="icoButton info" title="Functional teams can use this space to update the output from their relevant tasks and activities."></a></span> 
                                                        </div>
                                                    </div>
                                                </div>
                                                 <div class="row StarContainer">
                                                    <div class="col-sm-12">
                                                        <div class="panel panelMessage">
                                                            <apex:outputText value="{!$Label.IPM_DOES_NOT_APPEAR_IN_GATE_DOC}" styleClass="asterisk"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                                                                
                                                
                                                <!--Button Alignment--->
                                                <apex:outputPanel rendered="{! If(AND(IsEditableOutC=true),'true','false')}">    
                                                                    <div class="panel clearfix">
                                                                        <div class="noPadright marginFloatedBlock ipmButtonSet pull-right">
                                                                            <apex:outputPanel rendered="{! If(AND(IsEditableOutC=true),'true','false')}">
                                                                                <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                                <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                    <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                </apex:commandLink>
                                                                                <apex:commandLink title="{!$Label.IPM_ON_CLICK_OF_SAVE_NOTIFY}" styleClass="ipmButton primary gatesectionButton" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                    <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                    <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                                </apex:commandLink>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                </apex:outputPanel>
                                                
                                                <!--SNT Comment-->
                                               <span class="filledinDesc asterisk padtopbtm">{!$Label.IPM_FunctionalInput_minChar}</span>
                                                <!--upto here-->
                                                <div class="row">
                                                    <div class="col-sm-12 dateUpdate" >
                                                        <div class="panel">
                                                            <apex:outputText value="Last updated by: {!projDocSec.IPM_PDPHistoty__c} on " rendered="{! if(projDocSec.IPM_PDPHistoty__c !=null,'true','false')}" /> 
                                                            <apex:outputField value="{!projDocSec.IPM_PDPHistoty_Date__c}" />   
                                                        </div>
                                                    </div> 
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="panel">           
                                                            <apex:inputField value="{!projDocSec.IPM_PDP_Document_Summary__c}" id="pdp"   rendered="{! If(AND(IsEditableOutC=true),'true','false')}" />
                                                            <apex:outputField value="{!projDocSec.IPM_PDP_Document_Summary__c}" id="pdp1"   rendered="{! If(AND(IsEditableOutC=true),'false','true')}" />
                                                        </div>
                                                    </div> 
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="panel-group secAttachment">
                                                            <div class="row">
                                                                <div class="col-sm-6">
                                                                    <div class="secTitle">
                                                                        <apex:outputText value="{!$Label.IPM_ATTACHMENT}"/>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-6">
                                                                    <div class="secLink">
                                                                        <apex:outputPanel rendered="{! If(AND(IsEditableOutC=true),'true','false')}">  
                                                                            <a class="attachFiles" id="attachFilesOut" title="Attach Files" value="{!$Page.IPM_FileUpload}?Id={!projectId}&projDocSecId={!projDocSecId}&sectionType=outcome" data-toggle="modal" data-target="#ipmModal" data-backdrop="static" data-keyboard="false" >+ {!$Label.IPM_ADD_ATTACHMENTS}</a> 
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panelListFiles">
                                                                        <apex:outputPanel id="outptattach">
                                                                            <apex:repeat value="{!attachmentList}" var="attach">
                                                                                <apex:outPutPanel rendered="{!attach.Description='outcome'}">
                                                                                    <div class="SecButtonSet attchContainer noTxtAlign delete">
                                                                                        <apex:image styleClass="attchImage" value="{!If(Contains(attach.Name,'.xls'),URLFOR($Resource.IPM_Resource, 'images/ico_excel.png'),IF(Contains(attach.Name,'.doc'),URLFOR($Resource.IPM_Resource, 'images/ico_word.png'),IF(Contains(attach.Name,'.ppt'),URLFOR($Resource.IPM_Resource, 'images/ico_ppt.png'),IF(Contains(attach.Name,'.txt'),URLFOR($Resource.IPM_Resource, 'images/ico_text.png'),IF(Contains(attach.Name,'.pdf'),URLFOR($Resource.IPM_Resource, 'images/ico_pdf.png'),URLFOR($Resource.IPM_Resource, 'images/ico_img.png'))))))}"/>
                                                                                        <apex:outputLink styleClass="fileName" value="/servlet/servlet.FileDownload?file={!attach.Id}" target="_blank">{!attach.Name}</apex:outputLink>  
                                                                                        <apex:outputPanel rendered="{! If(AND(IsEditableOutC=true),'true','false')}">  
                                                                                            <a class="icoButton mdown delete" title="Delete" onclick="callAttachDelete('{!attach.Id}')"></a>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </apex:outputPanel>
                                                                            </apex:repeat>
                                                                            
                                                                            <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="panel-group mrgbtmnone">
                                                            <div class="secComponent noMargin">
                                                                <!---OLD BUTTON POSITIONS--->
                                                                <c:IPM_SC_Feasibility_Questions RNDEdit="{!IsEditableOutC}" gateDocType="{!projDoc.IPM_GateDocuments__c}" rendered="{!if(OR(projdocsec.IPM_Master_Section_External_Id__c=='Supply_Chain_Feasibility',projdocsec.IPM_Master_Section_External_Id__c=='Supply_Chain_Technical_Readiness'),true,false)}"></c:IPM_SC_Feasibility_Questions>
                                                                <c:IPM_RND_Questions gateDocType="{!projDoc.IPM_GateDocuments__c}" rendered="{!if(OR(projdocsec.IPM_Master_Section_External_Id__c=='R&D_Initial_Outline_Product_Pack',projdocsec.IPM_Master_Section_External_Id__c=='R&D_Technical_Readiness'),true,false)}" RNDEdit="{!IsEditableOutC}" ></c:IPM_RND_Questions>
                                                                <c:IPM_RND_Feasibility_Questions RNDEdit="{!IsEditableOutC}" gateDocType="{!projDoc.IPM_GateDocuments__c}" rendered="{!if(projdocsec.IPM_Master_Section_External_Id__c=='R&D_Feasibility',true,false)}"></c:IPM_RND_Feasibility_Questions>
                                                                <c:IPM_OTIFSectionStatus otfType="Section" getSectionId="{!projDocSec.Id}" isEdtable="{!IsEditableOutC}" rendered="{!projdocsec.IPM_Master_Section_External_Id__c!='Business_Case_Action_Standards'}"></c:IPM_OTIFSectionStatus>
                                                                <c:IPM_Section_GateChecklist getSecid="{!projDocSecId}" getDocType="{!projDoc.IPM_GateDocuments__c}"  editGateSect="{!IsEditableOutC}" rendered="{!projdocsec.IPM_Master_Section_External_Id__c!='Business_Case_Action_Standards'}"></c:IPM_Section_GateChecklist>
                                                                <c:IPM_Assumptions projId="{!projectId}" gateType="{!projDoc.IPM_GateDocuments__c}" getSectionId="{!projDocSecId}" rendered="{!if(projDocSec.IPM_Master_Section_External_Id__c=='Assumptions',true,false)}" isEditable="{!IsEditableOutC}"></c:IPM_Assumptions>
                                                                <c:IPM_Consumer_Evidence gate="{!projDoc.IPM_GateDocuments__c}" getProjectId="{!projectId}" Editable="{!IsEditableOutC}" getSecid="{!projDocSec.Id}" rendered="{!AND(countOfCountries>=1,projDocSec.IPM_Master_Section_External_Id__c='Consumer_Evidence_Concept')}"></c:IPM_Consumer_Evidence>
                                                                <c:IPM_TradeMark_Questions RNDEdit="{!IsEditableOutC}" gateDocType="{!projDoc.IPM_GateDocuments__c}" rendered="{!if(projdocsec.IPM_Master_Section_External_Id__c='Trademarks',true,false)}"></c:IPM_TradeMark_Questions>
                                                                <c:IPM_EcoDesignSection Ecoedit="{!isEcodesignEdit}" getSectionId="{!projDocSec.Id}" rendered="{!showEcoDesign}" ></c:IPM_EcoDesignSection>
                                                                <apex:outputPanel rendered="{!if(projDocSec.IPM_Section__r.External_ID__c='Customers_Channels',true,false)}">        
                                                                    <c:IPM_Customer_Channels getProjectID="{!projectId}" getSecid="{!projDocSecId}" CCEdit="{!IsEditableOutC}"></c:IPM_Customer_Channels>
                                                                </apex:outputPanel>       
                                                                <!-- below component will render when project phase is "market ready" and project document section's master sectional external id is "Assortmment Stretegy" -->       
                                                                <c:IPM_AssortmentStrategy Editable="true" ProSecID="{!projDocSecId}" rendered="{!if(AND(project.IPM_Phase__c='Market Ready',projDocSec.IPM_Master_Section_External_Id__c='Assortment_Strategy'),true,false)}"></c:IPM_AssortmentStrategy>
                                                                <!-- below component renders when any of condition meets -->
                                                                <!-- 1. project document sections master external id is "Business case action standard" and project type is NOT "Rollot" -->
                                                                <!-- 2. project document sections master external id is "Business case action standard" and project type is "Rollot" but project span is NOT "Local"-->
                                                                 <apex:outputPanel layout="block" rendered="{!AND(project.IPM_Phase__c='Ideas',project.IPM_Project_Type__c!='Operational')}">
                                                                     <!-- below component will get render when project document sections master section external id value is containing "Mix_Qualification_Plan_and_Action_Standards"(check if string contains) but phase is NOT "Ideas" and Count of countries is greater than 1 -->
                                                                     <c:IPM_GateCMI Editable="{!isEditGateCMI}" getProjectId="{!projectId}" getSectionId="{!projDocSec.Id}" getGate="{!projDoc.IPM_GateDocuments__c}" rendered="{!if(CONTAINS(projDocSec.IPM_Master_Section_External_Id__c,'Mix_Qualification_Plan_and_Action_Standards'),If(AND(project.IPM_Phase__c='Ideas',countOfCountries<1),false,true),false)}" />   
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" rendered="{!AND(project.IPM_Phase__c!='Ideas',project.IPM_Project_Type__c!='Operational')}">
                                                                  <!-- below component will get render when project document sections master section external id value is containing "Mix_Qualification_Plan_and_Action_Standards"(check if string contains) and Project span is "Regional" -->
                                                                  <c:IPM_GateCMI_Contract Editable="{!isEditGateCMI}" getProjectId="{!projectId}"  getGate="{!projDoc.IPM_GateDocuments__c}" getSectionId="{!projDocSec.Id}" rendered="{!AND(project.IPMProject_Span__c='Regional',CONTAINS(projDocSec.IPM_Master_Section_External_Id__c,'Mix_Qualification_Plan_and_Action_Standards'))}" />  
                                                                  <!-- below component will get render when project document sections master section external id value is "Mix_Qualification_Plan_and_Action_Standards" and Project span is either "Global" or "Local" -->
                                                                  <c:IPM_GateCMI_Consolidated getGate="{!projDoc.IPM_GateDocuments__c}" getProjectId="{!projectId}" getSectionId="{!projDocSec.Id}" rendered="{!AND(projDocSec.IPM_Master_Section_External_Id__c='Mix_Qualification_Plan_and_Action_Standards',OR(project.IPMProject_Span__c='Global',project.IPMProject_Span__c='Local'))}"></c:IPM_GateCMI_Consolidated>
                                                                </apex:outputPanel>
                                                                                                                                
                                                                 <c:IPM_CU_Complexity gateType="{!projDoc.IPM_GateDocuments__c}" proModel="{project.IPM_GateKeeping_Model__c}" ProSpan="{project.IPMProject_Span__c}" phaseName="{!project.IPM_Phase__c}" getSectionId="{!projDocSec.Id}" isEdit="{!IsCRRTEditable}"  rendered="{!isCUandComplexity}">                                   </c:IPM_CU_Complexity>
                                                                 <c:IPM_CU_Complexity_Consolidated getGateType="{!projDoc.IPM_GateDocuments__c}" isGateDoc="false" getProjId="{!project.Id}" rendered="{!AND(project.IPM_Project_Type__c!='Operational',project.IPMProject_Span__c='Global',projDocSec.IPM_Master_Section_External_Id__c='CU_And_Complexity')}" /> 
                                                                    
                                                            </div>
                                                        </div> 
                                                    </div>
                                                </div>
                                                <!-- below component will get render when project document sections master section external id value is containing "Mix_Qualification_Plan_and_Action_Standards"(check if string contains) and phase is  "Ideas" and Count of countries is less than 1 and project type is "Operational" -->
                                                <apex:outputPanel rendered="{!If(AND(CONTAINS(projDocSec.IPM_Master_Section_External_Id__c,'Mix_Qualification_Plan_and_Action_Standards'),countOfCountries<1,project.IPM_Phase__c='Ideas',project.IPM_Project_Type__c!='Operational'),true,false)}" layout="block" styleClass="row alertBox">
                                                    <div class="col-sm-12 alrtContainer noPadleft noPadright"> 
                                                        <div class="col-sm-1 alertsIcon"><img alt="Alert" width="100%" height="100%" class="alertimg" src="{!URLFOR($Resource.IPM_Resource, 'images/alert_1a.png')}"/></div>
                                                        <div class="col-sm-11 alerttext noPadright">
                                                            {!$Label.IPM_GENERATE_ROLLOUT_FOR_CMI}                       
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <!-- below component will get render when project document sections master section external id value is "Consumer_Evidence_Concept"(check if string contains) and Count of countries is less than 1 and project type is "Operational" -->
                                                <apex:outputPanel rendered="{!AND(countOfCountries<1,projDocSec.IPM_Section__r.External_ID__c='Consumer_Evidence_Concept',project.IPM_Project_Type__c!='Operational')}" layout="block" styleClass="row alertBox">
                                                    <div class="col-sm-12 alrtContainer noPadleft noPadright"> 
                                                          <div class="col-sm-1 alertsIcon"><img alt="Alert"  width="100%" height="100%" class="alertimg" src="{!URLFOR($Resource.IPM_Resource, 'images/alert_1a.png')}"/></div>
                                                        <div class="col-sm-11 alerttext noPadright">
                                                            {!$Label.IPM_GENERATE_ROLLOUT_FOR_CONSUMER_EVIDENCE}                       
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                                            
                                                                        </apex:outputPanel>
                                                                        <apex:actionFunction name="CallAttachId" action="{!delet}" reRender="outptattach">
                                                                            <apex:param assignTo="{!attachId}" value="" name="Attached"/>
                                                                        </apex:actionFunction>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>      
                                                <apex:outputPanel rendered="{! If(AND(IsEditableOutC=true),'true','false')}">  
                                                    <div class="row">
                                                        <div class="col-sm-12">
                                                            <div class="panel-group">
                                                                <div class="row Mtop">      
                                                                    <div class="panel">
                                                                        <div class="pull-right ipmButtonSet custMarginRight">
                                                                            <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                            <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                            </apex:commandLink>
                                                                            <apex:commandLink title="{!$Label.IPM_ON_CLICK_OF_SAVE_NOTIFY}" styleClass="ipmButton gatesectionButton primary" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                            </apex:commandLink>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                        </div>
                                                    </div>     
                                                </apex:outputPanel> 
                                            </apex:outputPanel>  
                                        </div>
                                        <!-----FUnctional Input END---->
                                    </div>
                                    <!-----Summary Side for 2 column view Begin---->
                                    <!-- below panel renders when project document section master section external id is any of "Risk", "OTIF_Status", "Gate_Keeper_Checklist", "Country_Feedback_Requirements" or "BD/BB_Alignment" -->
                                    <apex:outputPanel rendered="{!if(OR(projDocSec.IPM_Master_Section_External_Id__c=='Risk',projDocSec.IPM_Master_Section_External_Id__c=='OTIF_Status',projDocSec.IPM_Master_Section_External_Id__c=='Gate_Keeper_Checklist',projDocSec.IPM_Master_Section_External_Id__c=='Country_Feedback_Requirements',projDocSec.IPM_Master_Section_External_Id__c=='BD/BB_Alignment'),false,true)}">
                                        <div class="col-sm-6">
                                            <div class="panel">   
                                                <div class="row">
                                                    <div class="col-sm-12 ipmSecEditorTab" id="ipmSecEditorTab">
                                                        <div class="row">
                                                            <div class="panel-group mrgbtmnone">                               
                                                                <ul class="ipmTabs">
                                                                    <li class="summary"><span>Summary</span><span class="SecButtonSet SecButtonSetInfo"><a class="icoButton info" title="Project leader can use this space to update the summary output and this goes into the gate document"></a></span></li>
                                                                    <li class="aTasks"><span>{!$Label.IPM_ASSOCIATED_TO_DOs}</span></li>
                                                                </ul>                               
                                                            </div>
                                                        </div>
                                                             <div class="panel panelMessage">           
                                                           <apex:outputText value="{!$Label.IPM_DOES_APPEAR_IN_GATE_DOC}" styleClass="asterisk"/> 
                                                           </div>
                                                            <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                <div class="row">
                                                                    <div class="col-sm-12">
                                                                        <div class="panel-group mrgbtmnone">
                                                                            <div class="row marginFloatedBlock">        
                                                                                <div class="panel">
                                                                                    <div class="pull-right ipmButtonSet mrgbtmnone custMarginRight" >
                                                                                        <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                                        <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="Gate" name="savegate"/>
                                                                                        </apex:commandLink>
                                                                                        <apex:commandLink title="{!$Label.IPM_ON_CLICK_OF_SAVE_NOTIFY}" styleClass="ipmButton gatesectionButton primary" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                            <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                                        </apex:commandLink>
                                                                                    </div>
                                                                                </div>
                                                                            </div>  
                                                                        </div> 
                                                                        <div class="row">        
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel secEditSummary">   
                                                                        <span class="filledinDesc asterisk padtopbtm">{!$Label.IPM_SUMMARY_TEXT_MINIMUM_LIMIT}</span>
                                                             <div class="row">
                                                                <div class="col-sm-12 dateUpdate one">
                                                                    <div class="panel">
                                                                        <apex:outputText value="Last updated by: {!projDocSec.IPM_GateHistory__c} on " id="txtarea" rendered="{! if(projDocSec.IPM_GateHistory__c!=null,'true','false')}"/> 
                                                                        <apex:outputField value="{!projDocSec.IPM_GateHistory_Date__c}"/>  
                                                                    </div>
                                                                </div> 
                                                            </div>
                                                                        <apex:inputField id="gate" styleClass="countTarget" value="{!projDocSec.IPM_Gate_Document_Summary__c}" rendered="{! If(AND(IsEditableSumm=true),'true','false')}" />
                                                                        <apex:outputField styleClass="countTarget" value="{!projDocSec.IPM_Gate_Document_Summary__c}" id="gate1"  rendered="{! If(AND(IsEditableSumm=true),'false','true')}" />        
                                                                        <div class="row charCount">
                                                                            <apex:outputPanel styleClass="col-sm-12 pull-right charcount textRight" rendered="{! If(AND(IsEditableSumm=true),'true','false')}">
                                                                                <span id="lblCharCountGate">{!$Label.IPM_CHAR_REMAINING} </span> <strong class="charCountRemaining" id="charCountRemaining">{!remainingChar}</strong>
                                                                            </apex:outputPanel>
                                                                            <div id="dummyCount" class="dummyCount">{!sectionCharLimit}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>  
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel-group secAttachment">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="secTitle">
                                                                                    <apex:outputText value="{!$Label.IPM_ATTACHMENT}"/>
                                                                                </div>
                                                                            </div> 
                                                                            <div class="col-sm-6">
                                                                                <div class="secLink">
                                                                                    <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                                        <a class="attachFiles" id="attachFilesSum" title="Attach Files" value="{!$Page.IPM_FileUpload}?Id={!projectId}&projDocSecId={!projDocSecId}&sectionType=summary" data-toggle="modal" data-target="#ipmModal" data-backdrop="static" data-keyboard="false">+ {!$Label.IPM_ADD_ATTACHMENTS}</a> 
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </div>    
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-sm-12">
                                                                                <div class="panelListFiles">
                                                                                    <apex:outputPanel id="outptattach1">
                                                                                        <apex:repeat value="{!attachmentList}" var="attach">
                                                                                            <apex:outPutPanel rendered="{!attach.Description='summary'}">
                                                                                                <div class="SecButtonSet attchContainer noTxtAlign delete">
                                                                                                    <apex:image styleClass="attchImage" value="{!If(Contains(attach.Name,'.xls'),URLFOR($Resource.IPM_Resource, 'images/ico_excel.png'),IF(Contains(attach.Name,'.doc'),URLFOR($Resource.IPM_Resource, 'images/ico_word.png'),IF(Contains(attach.Name,'.ppt'),URLFOR($Resource.IPM_Resource, 'images/ico_ppt.png'),IF(Contains(attach.Name,'.txt'),URLFOR($Resource.IPM_Resource, 'images/ico_text.png'),IF(Contains(attach.Name,'.pdf'),URLFOR($Resource.IPM_Resource, 'images/ico_pdf.png'),URLFOR($Resource.IPM_Resource, 'images/ico_img.png'))))))}"/>
                                                                                                    <apex:outputLink styleClass="fileName" value="/servlet/servlet.FileDownload?file={!attach.Id}" target="_blank">{!attach.Name}</apex:outputLink>  
                                                                                                    <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                                                        <a class="icoButton mdown delete" title="Delete" onclick="callAttachDelete('{!attach.Id}')"></a>
                                                                                                    </apex:outputPanel>
                                                                                                </div>
                                                                                            </apex:outputPanel>
                                                                                        </apex:repeat>
                                                                                    </apex:outputPanel>
                                                                                    <apex:actionFunction name="CallAttachId" action="{!delet}" reRender="outptattach1">
                                                                                        <apex:param assignTo="{!attachId}" value="" name="Attached"/>
                                                                                    </apex:actionFunction>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                            <apex:actionFunction action="{!IsNotify}" name="Notify" reRender="pmsg">
                                                                <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                            </apex:actionFunction>
                                                            <apex:actionFunction action="{!IsNotify}" name="Notify1" reRender="pmsg">
                                                                <apex:param assignTo="{!isChecked}" name="IsCheck" value=""/>
                                                            </apex:actionFunction>
                                                            <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                <div class="row">
                                                                    <div class="col-sm-12">
                                                                        <div class="panel-group">
                                                                            <div class="row marginFloatedBlock gateMarginTop">        
                                                                                <div class="panel">
                                                                                    <div class="pull-right ipmButtonSet custMarginRight" >
                                                                                        <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                                        <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="Gate" name="savegate"/>
                                                                                        </apex:commandLink>
                                                                                        <apex:commandLink title="{!$Label.IPM_ON_CLICK_OF_SAVE_NOTIFY}" styleClass="ipmButton gatesectionButton primary" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                            <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                                        </apex:commandLink>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div> 
                                                                    </div>
                                                                </div>  
                                                            </apex:outputPanel> 
                                                      <div class="ipmTabContent" id="summary">       
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel panelMessage">
                                                                        <!-- below component renders when project phase is "Ideas" project span is "Global"and IPM_Global_Consolidated__c is true-->
                                                                        <c:IPM_Global_Consolidated getExtId="{!projDocSec.IPM_Master_Section_External_Id__c}" getGate="{!projDoc.IPM_GateDocuments__c}" getProjId="{!project.Id}" rendered="{!AND(projDocSec.Is_IPM_Global_Consolidated__c,project.IPMProject_Span__c='Global',project.IPM_Phase__c!='Ideas')}"></c:IPM_Global_Consolidated>         
                                                                    
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                            

                                                        </div>
                                                        <div class="ipmTabContent aTasks" id="aTasks">
                                                            <div class="row">
                                                                <apex:outputPanel rendered="{!if(AND(isCreateTask,project.IPM_PM_Approach__c='Internal',isTaskReadOnly=false),true,false)}">  
                                                                    <div class="col-xs-4 pull-right addLink addTask" id="addTask" data-toggle="modal" data-target="#ipmModal" value="{!$Page.IPM_AddTaskNew}?projectId={!projectId}&projDocSecId={!projDocSecId}" title="Add To-Do" data-backdrop="static" data-keyboard="false"><span class="fa fa-plus" /><span class="addLinkText"> {!$Label.IPM_AddTaskLabel}</span></div>
                                                                </apex:outputPanel>
                                                            </div>  
                                                            <br/>
                                                            <div class="row">
                                                                 <apex:outputPanel rendered="{!If(AND(project.IPM_PM_Approach__c='External'),'true','false')}">
                                                                        <div class="col-sm-12 infoMsg toDoInfo">{!$Label.IPM_ExternalToDosMessage}</div>
                                                                </apex:outputPanel>
                                                            </div>    
                                                            <apex:actionFunction action="{!TaskDelete}" name="DeleteTask" reRender="tasklist" >
                                                                <apex:param name="taskid" assignTo="{!taskid}" value=""/>
                                                            </apex:actionFunction>
                                                            <apex:outputPanel id="tasklist" rendered="{! If(AND(isTaskViewable=true),'true','false')}">
                                                                <apex:repeat value="{!lsttask}" var="tk">
                                                                    <div class="row">
                                                                        <div class="aTabs">
                                                                            <div class="col-sm-10 noPadright noPadleft">
                                                                                <div class="col-xs-1 cboxPadding">
                                                                                    <apex:inputCheckbox value="{!tk.IPM_Completed__c}" styleClass="taskChkBox" disabled="{!if(OR(markTaskAccess=false,isTaskReadOnly=TRUE),'true','false')}">
                                                                                        <apex:actionSupport action="{!UpdateTask}" reRender="tasklist, hilightTaskScript" event="onchange" oncomplete="hilightTaskScript()">
                                                                                            <apex:param assignTo="{!taskid}" name="UpdateTask" value="{!tk.Id}"/>
                                                                                        </apex:actionSupport>
                                                                                    </apex:inputCheckbox>
                                                                                </div>
                                                                                <div class="col-xs-11 noPadleft">
                                                                                    <span class="wrapping">
                                                                                    <apex:outputPanel rendered="{!tk.IPM_Task_Type__c = 'Non-Negotiable'}">*</apex:outputPanel> 
                                                                                    <strong><apex:outputText value="{!tk.IPM_Task_Name__c}" ></apex:outputText></strong></span> 
                                                                                    <apex:outputPanel layout="block" styleClass="toDoLeft">
                                                                                        <apex:outputText value="{!$Label.IPM_IS_PENDING_WITH}" rendered="{!!tk.IPM_Completed__c}"></apex:outputText> 
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="">
                                                                                        <apex:outputText value="{!tk.IPM_Assignee__r.Name}" rendered="{!if(AND(tk.IPM_Completed__c),'false','true')}"></apex:outputText>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="toDoLeft">
                                                                                        <apex:outputText value="{!$Label.IPM_IS_COMPLETED_BY}" rendered="{!tk.IPM_Completed__c}"></apex:outputText> 
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="">
                                                                                        <apex:outputText value="{!tk.LastModifiedBy.Name}" rendered="{!if(AND(tk.IPM_Completed__c),'true','false')}"></apex:outputText>
                                                                                    </apex:outputPanel>
                                                                                    <span class="greytext toDoLeft">{!$Label.IPM_DUE_DATE}</span>
                                                                                    <apex:outputPanel layout="block" styleClass="todoDate"> 
                                                                                        <apex:outputfield value="{!tk.IPM_Due_Date1__c}" />
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </div> 
                                                                            <apex:outputPanel rendered="{! If(AND(isTaskeditable=true,isTaskReadOnly=FALSE),'true','false')}">
                                                                                <div class="col-sm-2 SecButtonSet pull-right">
                                                                                    <a class="icoButton delete" data-toggle="modal" data-target="#ipmDeleteModal"  value="{!tk.Id}" id="{!tk.Id}" 
                                                                                       onclick="ipmTaskDel('{!JSENCODE(tk.Id)}','{!JSENCODE(TEXT(lsttask.size))}','{!JSENCODE(tk.IPM_Project_Document_Section__r.IPM_Project_Document__r.IPM_GateDocuments__c)}','{!JSENCODE(tk.IPM_Project_Document_Section__r.IPM_Section_Sequence__c)}')" 
                                                                                       title="Delete" 
                                                                                       data-backdrop="static" data-keyboard="false"/>
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </apex:repeat>
                                                            </apex:outputPanel>  
                                                        </div>
                                                    </div>                            
                                                </div>              
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                    <!-- 2 Column Summary ends -->
                                    <!-- 1 Column Summary Begins -->
									<!-- below panel renders when project document section master section external id is any of "Risk", "OTIF_Status", "Gate_Keeper_Checklist", "Country_Feedback_Requirements" or "BD/BB_Alignment" -->
                                    <apex:outputPanel layout="block" rendered="{!if(OR(projDocSec.IPM_Master_Section_External_Id__c=='Risk',projDocSec.IPM_Master_Section_External_Id__c=='OTIF_Status',projDocSec.IPM_Master_Section_External_Id__c=='Gate_Keeper_Checklist',projDocSec.IPM_Master_Section_External_Id__c=='Country_Feedback_Requirements',projDocSec.IPM_Master_Section_External_Id__c=='BD/BB_Alignment'),true,false)}">
                                        <div class="col-sm-12">
                                            <div class="panel">   
                                                <div class="row">
                                                    <div class="col-sm-12 ipmSecEditorTab" id="ipmSecEditorTab">
                                                        <div class="row">
                                                            <div class="panel-group">                               
                                                                <ul class="ipmTabs">
                                                                    <li class="summary"><span>{!$Label.IPM_SUMMARY}</span><span class="SecButtonSet SecButtonSetInfo"><a class="icoButton info" title="Functional teams can use this space to update the output from their relevant tasks and activities."></a></span></li>
                                                                    <li class="aTasks"><span>{!$Label.IPM_ASSOCIATED_TO_DOs}</span></li>
                                                                </ul>                               
                                                            </div>
                                                        </div>
                                                        <div class="ipmTabContent" id="summary">        
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel panelMessage">
                                                                        <apex:outputText value="Does appear in Gate document." styleClass="asterisk"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">
                                                                <div class="row">
                                                                    <div class="col-sm-12">
                                                                        <div class="panel-group">
                                                                            <div class="row marginFloatedBlock">         
                                                                                <div class="panel" >
                                                                                    <div class="col-sm-6 ipmButtonSet pull-right">
                                                                                        <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                                        <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="Gate" name="savegate"/>
                                                                                        </apex:commandLink>
                                                                                        <apex:commandLink styleClass="ipmButton gatesectionButton primary" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                            <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                                        </apex:commandLink>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div> 
                                                                        
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="row">
                                                                <div class="col-sm-12 dateUpdate">
                                                                    <div class="panel">
                                                                        <apex:outputText value="Last updated by: {!projDocSec.IPM_GateHistory__c} on " id="txtarea1" rendered="{! if(projDocSec.IPM_GateHistory__c!=null,'true','false')}"/>
                                                                          <apex:outputField value="{!projDocSec.IPM_GateHistory_Date__c}"/>  
                                                                    </div>
                                                                </div> 
                                                            </div> 
                                                            <!-- below component renders when project phase is "Global" span is "Global" and project document section's master exteranl id is "BD/BB_Alignment" --> 
                                                            <c:IPM_BCC_Consolidate gateType="{!projDoc.IPM_GateDocuments__c}" projSpan="{!project.IPMProject_Span__c}" projectId="{!project.Id}" rendered="{!AND(projDocSec.IPM_Master_Section_External_Id__c=='BD/BB_Alignment',project.IPM_Phase__c!='Ideas',project.IPMProject_Span__c!='Global')}"></c:IPM_BCC_Consolidate>
                                                            <apex:outputPanel rendered="{!if(OR(projDocSec.IPM_Section_Name__c='OTIF',projDocSec.IPM_Master_Section_External_Id__c='OTIF_Status'),true,false)}">
                                                                
                                                                <c:IPM_OTIFStatusTable otfType="Table" getSectionId="{!projDocSec.Id}" IsEdtable="{!IsEditableSumm}"/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! If(projDocSec.IPM_Master_Section_External_Id__c=='Country_Feedback_Requirements',true,false)}">
                                                                <c:IPM_Country_Feedback />
                                                            </apex:outputPanel>
                                                            
                                                            <apex:outputPanel rendered="{!if(projDocSec.IPM_Master_Section_External_Id__c='Gate_Keeper_Checklist',true,false)}">
                                                                <c:IPM_GateKeeperList setEdit="true" getDocType="{!projDoc.IPM_GateDocuments__c}"  GateEdit="{!IsEditableSumm}"></c:IPM_GateKeeperList>
                                                            </apex:outputPanel>                   
                                                            <div class="row">
                                                                <apex:outputPanel rendered="{!if(projDocSec.IPM_Master_Section_External_Id__c='Risk',true,false)}">
                                                                    <c:IPM_Risk_Questionnaire getProjectId="{!if(AND(project.IPMProject_Span__c=='Local',project.IPM_Project_Type__c=='Rollout'),project.IPM_Parent_Project__c,projectId)}" getProjectSectionId="{!projDocSecId}" riskedit="{!IsEditableSumm}" editSection="true" gateType="{!projDoc.IPM_GateDocuments__c}"></c:IPM_Risk_Questionnaire>
                                                                </apex:outputPanel>            
                                                            <c:IPM_Section_GateChecklist getDocType="{!projDoc.IPM_GateDocuments__c}" getSecid="{!projDocSecId}" editGateSect="{!IsEditableSumm}" rendered="{!if(AND(projDocSec.IPM_Master_Section_External_Id__c = 'Risk'),'true','false')}"></c:IPM_Section_GateChecklist>               
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel secEditSummary">
                                                                        <div class="row">
                                                                            <span class="filledinDesc asterisk">{!$Label.IPM_SUMMARY_TEXT_MINIMUM_LIMIT}</span>
                                                                            <div class="col-sm-5 pull-right charcount textRight">
                                                                                <span>{!$Label.IPM_CHAR_REMAINING} </span> <strong id="lblCharCountGate2">{!remainingChar}</strong>
                                                                            </div>
                                                                            <div id="secEditCount" class="secEditCount">{!sectionCharLimit}</div>
                                                                        </div>
                                                                        <!-- <apex:inputField value="{!projDocSec.IPM_Gate_Document_Summary__c}"/>-->
                                                                        <apex:inputField styleClass="countTarget" value="{!projDocSec.IPM_Gate_Document_Summary__c}" id="gate2"  rendered="{! If(AND(IsEditableSumm=true),'true','false')}" />
                                                                        <apex:outputField styleClass="countTarget" value="{!projDocSec.IPM_Gate_Document_Summary__c}" id="gate3"  rendered="{! If(AND(IsEditableSumm=true),'false','true')}" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <div class="panel-group secAttachment">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="secTitle">
                                                                                    <apex:outputText value="{!$Label.IPM_ATTACHMENT}"/>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-sm-6">
                                                                                <div class="secLink">
                                                                                    <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                                        <a class="attachFiles" id="attachFilesSum1" title="Attach Files" value="{!$Page.ipm_FileUpload}?Id={!projectId}&projDocSecId={!projDocSecId}&sectionType=summary" data-toggle="modal" data-target="#ipmModal" data-backdrop="static" data-keyboard="false">+ {!$Label.IPM_ADD_ATTACHMENTS}</a> 
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-sm-12">
                                                                                <div class="panelListFiles">
                                                                                    <apex:outputPanel id="outptattach2">
                                                                                        <apex:repeat value="{!attachmentList}" var="attach">
                                                                                            <apex:outPutPanel rendered="{!attach.Description='summary'}">
                                                                                                <div class="SecButtonSet attchContainer noTxtAlign delete">
                                                                                                    <apex:image styleClass="attchImage" value="{!If(Contains(attach.Name,'.xls'),URLFOR($Resource.IPM_Resource, 'images/ico_excel.png'),IF(Contains(attach.Name,'.doc'),URLFOR($Resource.IPM_Resource, 'images/ico_word.png'),IF(Contains(attach.Name,'.ppt'),URLFOR($Resource.IPM_Resource, 'images/ico_ppt.png'),IF(Contains(attach.Name,'.txt'),URLFOR($Resource.IPM_Resource, 'images/ico_text.png'),IF(Contains(attach.Name,'.pdf'),URLFOR($Resource.IPM_Resource, 'images/ico_pdf.png'),URLFOR($Resource.IPM_Resource, 'images/ico_img.png'))))))}"/>
                                                                                                    <apex:outputLink styleClass="fileName" value="/servlet/servlet.FileDownload?file={!attach.Id}" target="_blank">{!attach.Name}</apex:outputLink>  
                                                                                                    <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">  
                                                                                                        <a class="icoButton mdown delete" title="Delete" onclick="callAttachDelete('{!attach.Id}')"></a>
                                                                                                    </apex:outputPanel>
                                                                                                </div>
                                                                                            </apex:outputPanel>
                                                                                        </apex:repeat>
                                                                                    </apex:outputPanel>
                                                                                    <apex:actionFunction name="CallAttachId" action="{!delet}" reRender="outptattach2">
                                                                                        <apex:param assignTo="{!attachId}" value="" name="Attached"/>
                                                                                    </apex:actionFunction>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <c:IPM_Section_GateChecklist getDocType="{!projDoc.IPM_GateDocuments__c}" getSecid="{!projDocSecId}" editGateSect="{!IsEditableSumm}" rendered="{!if(AND(projDocSec.IPM_Master_Section_External_Id__c = 'Risk'),'false','true')}"></c:IPM_Section_GateChecklist> 
                                                            <apex:actionFunction action="{!IsNotify}" name="Notify" reRender="pmsg">
                                                                <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                            </apex:actionFunction>
                                                            <apex:actionFunction action="{!IsNotify}" name="Notify1" reRender="pmsg">
                                                                <apex:param assignTo="{!isChecked}" name="IsCheck" value=""/>
                                                            </apex:actionFunction>
                                                            <apex:outputPanel rendered="{! If(AND(IsEditableSumm=true),'true','false')}">
                                                                <div class="row">
                                                                    <div class="col-sm-12">
                                                                        <div class="panel-group">
                                                                            <div class="row marginFloatedBlock gateMarginTop">
                                                                                <div class="panel">
                                                                                    <div class="col-sm-6 ipmButtonSet pull-right">
                                                                                        <span class="ipmButton buttonMarginRight" onclick="gotoPageNew()">{!$Label.IPM_CANCEL}</span>
                                                                                        <apex:commandLink styleClass="ipmButton buttonMarginRight primary" value="{!$Label.IPM_SAVE}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="Gate" name="savegate"/>
                                                                                        </apex:commandLink>
                                                                                        <apex:commandLink styleClass="ipmButton gatesectionButton primary" value="{!$Label.IPM_SAVE_AND_NOTIFY}" action="{!save}" onClick="saveChanges();" reRender="pmsg">
                                                                                            <apex:param assignTo="{!IsGateSave}" value="" name="savegate"/>
                                                                                            <apex:param assignTo="{!isChecked}" name="IsCheck" value="Checked"/>
                                                                                        </apex:commandLink> 
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div> 
                                                                    </div>
                                                                </div>  
                                                            </apex:outputPanel>
                                                        </div>
                                                        <div class="ipmTabContent aTasks" id="aTasks">
                                                            <div class="row">
                                                                <apex:outputPanel rendered="{!If(AND(isTaskeditable=true,isTaskViewable=true,project.IPM_PM_Approach__c='Internal',isTaskReadOnly=FALSE),'true','false')}">
                                                                    <div class="col-xs-4 pull-right addLink addTask" id="addTask" data-toggle="modal" data-target="#ipmModal" value="{!$Page.IPM_AddTaskNew}?projectId={!projectId}&projDocSecId={!projDocSecId}" title="Add To-Do" data-backdrop="static" data-keyboard="false"><span class="fa fa-plus" /><span class="addLinkText"> {!$Label.IPM_AddTaskLabel}</span></div>
                                                                </apex:outputPanel>
                                                            </div> 
                                                            <br/> 
                                                            <div class="row">
                                                                <apex:outputPanel rendered="{!If(AND(project.IPM_PM_Approach__c='External'),'true','false')}">
                                                                        <div class="col-sm-12 infoMsg toDoInfo">{!$Label.IPM_ExternalToDosMessage}</div>
                                                                </apex:outputPanel>
                                                            </div>  
                                                            <apex:actionFunction action="{!TaskDelete}" name="DeleteTask" reRender="tasklist">
                                                                <apex:param name="taskid" assignTo="{!taskid}" value=""/>
                                                            </apex:actionFunction>
                                                            <apex:outputPanel id="tasklist1" rendered="{! If(AND(isTaskViewable=true),'true','false')}">
                                                                <apex:repeat value="{!lsttask}" var="tk">
                                                                    <div class="row">
                                                                        <div class="aTabs">
                                                                            <div class="col-sm-10 noPadright noPadleft">
                                                                                <div class="col-xs-1 cboxPadding">
                                                                                    <apex:inputCheckbox value="{!tk.IPM_Completed__c}" styleClass="taskChkBox" disabled="{!if(OR(markTaskAccess=false,isTaskReadOnly=TRUE),'true','false')}">
                                                                                        <apex:actionSupport action="{!UpdateTask}" reRender="tasklist, hilightTaskScript" event="onchange" oncomplete="hilightTaskScript()">
                                                                                            <apex:param assignTo="{!taskid}" name="UpdateTask" value="{!tk.Id}"/>
                                                                                        </apex:actionSupport>
                                                                                    </apex:inputCheckbox>
                                                                                </div>
                                                                                <div class="col-xs-11 noPadleft">
                                                                                    <span class="wrapping"><strong><apex:outputText value="{!tk.IPM_Task_Name__c}" ></apex:outputText></strong></span>  
                                                                                    <apex:outputPanel layout="block" styleClass="toDoLeft">
                                                                                        <apex:outputText value="{!$Label.IPM_IS_PENDING_WITH}" rendered="{!!tk.IPM_Completed__c}"></apex:outputText> 
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="">
                                                                                        <apex:outputText value="{!tk.IPM_Assignee__r.Name}" rendered="{!if(AND(tk.IPM_Completed__c),'false','true')}"></apex:outputText>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="toDoLeft">
                                                                                        <apex:outputText value="{!$Label.IPM_IS_COMPLETED_BY}" rendered="{!tk.IPM_Completed__c}"></apex:outputText> 
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="">
                                                                                        <apex:outputText value="{!tk.LastModifiedBy.Name}" rendered="{!if(AND(tk.IPM_Completed__c),'true','false')}"></apex:outputText>
                                                                                    </apex:outputPanel>
                                                                                    <span class="greytext toDoLeft">{!$Label.IPM_DUE_DATE}</span>
                                                                                    <apex:outputPanel layout="block" styleClass="todoDate"> 
                                                                                        <apex:outputfield value="{!tk.IPM_Due_Date1__c}" />
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </div> 
                                                                            <apex:outputPanel rendered="{! If(AND(isTaskeditable=true,isTaskReadOnly=FALSE),'true','false')}">
                                                                                <div class="col-sm-2 SecButtonSet pull-right">
                                                                                    <a class="icoButton delete" data-toggle="modal" data-target="#ipmDeleteModal"  value="{!tk.Id}" 
                                                                                       onclick="ipmTaskDel('{!JSENCODE(tk.Id)}','{!JSENCODE(TEXT(lsttask.size))}','{!JSENCODE(tk.IPM_Project_Document_Section__r.IPM_Project_Document__r.IPM_GateDocuments__c)}','{!JSENCODE(tk.IPM_Project_Document_Section__r.IPM_Section_Sequence__c)}')"
                                                                                       title="Delete" 
                                                                                       data-backdrop="static" data-keyboard="false"/>
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </apex:repeat>
                                                            </apex:outputPanel>  
                                                        </div>
                                                    </div>                            
                                                </div>              
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                    <!-- 1 column summary ends -->
                                </div>
                            </div>
                        </div>
                    </div> 
                    <div id="ipmModalDiv">
                        <c:IPM_ModalHeaderDiv />
                    </div>  
                    <div id="ipmDeleteModalDiv">
                        <c:IPM_ConfirmModal />
                    </div>
                </div>  
                <div>      
                <c:IPM_MarketPerformance projId="{!projectId}" isEditable="{!isEditMarketPerformance}" rendered="{!AND(projDocSec.IPM_Master_Section_External_Id__c=='Monitoring_Performance_in_Market' && projDocSec.IPM_Section_Sequence__c =='6.5' && (project.IPMProject_Span__c='Regional' || (project.IPMProject_Span__c='Global' && project.IPM_ProjectGKM__c = 'GKM3')) && project.IPM_Project_Type__c!='Operational')}" ></c:IPM_MarketPerformance>
                <c:IPM_PerformanceBreakdown projId="{!projectId}" isAppendix="false" rendered="{!if(projDocSec.IPM_Master_Section_External_Id__c=='Monitoring_Performance_in_Market' && projDocSec.IPM_Section_Sequence__c =='6.5' && project.IPMProject_Span__c='Local' && project.IPM_Project_Type__c!='Operational',true,false)}" isEditable="{!isEditMarketPerformance}"></c:IPM_PerformanceBreakdown> 
                <c:IPM_Financial_Action_Standards_Inverse gate="{!projDoc.IPM_GateDocuments__c}" isEditable="{!isGlobalActionStandards}"  secId="{!projDocSec.Id}" projId="{!projectId}" rendered="{!AND(projDocSec.IPM_Master_Section_External_Id__c='Business_Case_Action_Standards',projDoc.IPM_GateDocuments__c!='Market Deployment',OR(project.IPMProject_Span__c='Regional',AND(project.IPMProject_Span__c='Local',project.IPM_Project_Type__c='Operational'),AND(project.IPMProject_Span__c='Global',project.IPM_Project_Type__c='Operational'),AND(project.IPMProject_Span__c='Global',projDoc.IPM_GateDocuments__c!='Charter')))}"  ></c:IPM_Financial_Action_Standards_Inverse>                                                                                                                                    
                <c:IPM_GlobalFinancialActionStandards gate="{!projDoc.IPM_GateDocuments__c}" isEditable="{!isGlobalActionStandards}"  secId="{!projDocSec.Id}" projId="{!projectId}" rendered="{!AND(projdocsec.IPM_Master_Section_External_Id__c='Business_Case_Action_Standards',project.IPMProject_Span__c='Global',project.IPM_Project_Type__c='Original',OR(project.IPM_Phase__c='Ideas',projDoc.IPM_GateDocuments__c='Charter'))}"  ></c:IPM_GlobalFinancialActionStandards>
                </div> 
                <div style="width:50%;float:left;" class="glbSeclist"> 
                    <c:IPM_Section_GateChecklist getDocType="{!projDoc.IPM_GateDocuments__c}" getSecid="{!projDocSecId}" editGateSect="{!IsEditableSumm}" rendered="{!projdocsec.IPM_Master_Section_External_Id__c='Business_Case_Action_Standards'}"></c:IPM_Section_GateChecklist>
                    <c:IPM_OTIFSectionStatus otfType="Section" getSectionId="{!projDocSec.Id}" isEdtable="{!IsEditableOutC}" rendered="{!projdocsec.IPM_Master_Section_External_Id__c='Business_Case_Action_Standards'}"></c:IPM_OTIFSectionStatus>
                </div>
            </apex:form> 
        </apex:define>
    </apex:composition>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/jquery-ui.min.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_functions.js')}" type="text/javascript"></script>    
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_Count.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_CountExt.js')}" type="text/javascript"></script>
     <apex:outPutPanel id="hilightTaskScript">
        <script>
         var IPMAppSE = {projectId:'{!projectId}',wmessage:'{!$Label.IPM_Unsaved_Alert}', projDocSecId:'{!projDocSecId}', SectionEditorPageRef:'{!$Page.IPM_ProjectDocumentSectionEditor}', deleteTaskMsg:'{!$Label.IPM_Delete_task_msg}', RemoveTask:'{!$Label.IPM_RemoveTask}', CountTitle:'{!$Label.IPM_CHAR_COUNT_ALERT_TITLE}', CountMessage:'{!$Label.IPM_CHAR_COUNT_EXCEED}', charRemaining:'{!$Label.IPM_CHAR_REMAINING}', exLimitBtmMsg:'{!$Label.IPM_ExcLimitBtmMsg}'};          
         var IPMAPPCMI = {concepts:'{!projDocSec.IPM_CMI_Selected_Test_Concepts__c}'};
        </script>
    </apex:outPutPanel> 
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_SecEditor.js')}" type="text/javascript"></script>   
</apex:page>