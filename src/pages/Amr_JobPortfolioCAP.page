<apex:page controller="Amr_CAPJobPortfolioController" sidebar="false" standardStylesheets="false">
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css"/>
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css"/>
<script>

  $(function() {
    $( "#datepicker" ).datepicker();
     $( "#datepicker1" ).datepicker();
  });
  </script>
  
  <script type="text/javascript">
  
      function callActionFunctionStartDate(startDate) {
        
        callContrlStartDate(startDate);
       }  
     function callActionFunctionEndDate(endDate) {
    
       callContrlEndDate(endDate);
      
    }
     function callFuctionForJobsSort(jobsSort){
    alert('pendingSortOption!!'+jobsSort);
        callContrlJobsSort(jobsSort);
    }
    
     function callFuctionForCancelSort(jobsCancel){
    alert('pendingSortOption!!'+jobsCancel);
        callContrlCancelSort(jobsCancel);
    }
    </script>
    <script type="text/javascript">
     $ = jQuery.noConflict();
    function transferValue(projName)
        {
       // alert('inside function'+projName);
     
        $('.projecttextProjDetail').val(projName);
          // alert('Hi---'+$('.projecttextProjDetail').val());
        }
    </script>
    <style>
    .hide{
            display:none;           
            }
    </style>
  <apex:form >
  
  <apex:pageBlock id="searchBlockId">
    
    <apex:pageBlockSection id="searchSectionId" collapsible="true"  title="Search And Filters" columns="1" >
    
    <table style="border:0px">
        <tr>
            <td width='190' style="text-align:right;border:none;height:10px;line-height:38px;">Start Date</td>
            <td style="text-align:right;border:none;height:10px;line-height:38px;"><input type="text" class="inputTextCommon" id="datepicker" onchange="callActionFunctionStartDate(this.value);"/></td>
        </tr>
        <tr>
            <td width='190' style="text-align:right;border:none;height:10px;line-height:38px;">End Date</td>
            <td style="text-align:right;border:none;height:10px;line-height:38px;"><input type="text" class="inputTextCommon" id="datepicker1" onchange="callActionFunctionEndDate(this.value);"/></td>
        </tr>
    </table>
    
    <apex:actionRegion >
    <apex:outputLabel value="Category"/>
     <apex:selectList value="{!categoryName}" size="1"  multiselect="false" >  
         <apex:actionSupport event="onchange" reRender="brandPosPick,brandPick" />        
        <apex:selectOptions value="{!CategoryList}" />              
      </apex:selectList>
    
      <apex:outputLabel value="Brand Position Name"/>
      <apex:selectList id="brandPosPick" value="{!brandPos}" size="1" multiselect="false" > 
      <apex:actionSupport event="onchange" reRender="brandPick" />              
        <apex:selectOptions value="{!BrandPositioningList}" />              
      </apex:selectList>
     
      <apex:outputLabel value="Brand Name"/>
      <apex:selectList id="brandPick" value="{!brandName}" size="1" multiselect="false" >                   
        <apex:selectOptions value="{!BrandList}" />              
      </apex:selectList>
      
     </apex:actionRegion> 
     
    <apex:inputField value="{!jobDetails.Project_Leader_Cluster__c}"   />
     <apex:inputField value="{!jobDetails.Project_Leader_Country__c}"   />
    
    <apex:inputField value="{!jobDetails.Lead_Creative_Agency_name__c}" />
   
   <apex:inputField value="{!jobDetails.Broadcast_Market__c}" />
     
    <apex:inputField value="{!jobDetails.Stage_of_Production_Activity__c}" />
   <apex:inputField value="{!jobDetails.AdManagerText__c}"  />
    <apex:inputText value="{!jobDetails.Unilever_Project_Leader_Email__c}" Styleclass="inputTextCommon" />
    <!-- <apex:outputLabel value="Project Name"/>
    <apex:selectList value="{!projectName}" size="1" multiselect="false">
        <apex:selectOptions value="{!ProjectNameList}" />
    </apex:selectList>-->
    
  
   <!--select tag-->
                                                       
     <apex:inputField value="{!jobDetails.Project_Details__c}" styleClass="projecttextProjDetail hide"/><select id="projectList" size="1" style="width: 300px;" onchange="transferValue(this.value)"></select>
     <apex:inputField value="{!jobAllocation.Job_Allocated__c}" />
     <apex:outputLabel value="RAP Allocated"/>
      <apex:selectList value="{!userName}" size="1" multiselect="false" >                   
        <apex:selectOptions value="{!UserList}" />              
      </apex:selectList>
     
    
     </apex:pageBlockSection>
     <script>
      twistSection(document.getElementById('{!$Component.searchBlockId.searchSectionId}').getElementsByTagName('img')[0])
     </script>  
    </apex:pageBlock> 
    
     <apex:commandButton value="Apply" action="{!getJobSearchDetails}" reRender="listRefresh">
      
   </apex:commandButton>
    
    <apex:actionFunction action="{!getJobSearchDetails}" name="callContrlStartDate" reRender="listRefresh1">
       <apex:param name="param" value="" id="y" assignTo="{!startDate}" />
    </apex:actionFunction>
    
    <apex:actionFunction action="{!getJobSearchDetails}" name="callContrlEndDate" reRender="listRefresh1">
       <apex:param name="param16" value="" id="y16" assignTo="{!endDate}" />
    </apex:actionFunction> 
    
    <apex:actionFunction action="{!getJobSearchDetails}" name="callContrlJobsSort" reRender="listRefresh">
       <apex:param name="param18" value="" id="y18" assignTo="{!selectedSortJobsOption}" />
    </apex:actionFunction>
    
    <apex:actionFunction action="{!getJobSearchDetails}" name="callContrlCancelSort" reRender="listRefresh">
       <apex:param name="param19" value="" id="y19" assignTo="{!selectedSortCancelOption}" />
    </apex:actionFunction>
   
  <apex:outputPanel id="listRefresh">  
  <apex:pageBlock >
  <apex:pageBlockSection title="Job List"  columns="1" collapsible="true">
  
  <apex:outputPanel rendered="{!showPageButtonForActive}">
              <apex:commandButton value="<<" action="{!beginningForActiveJobs}" disabled="{!DisablePreviousForActiveJobs}"  reRender="listRefresh"/>
              <apex:commandButton value="<" action="{!previousForActiveJobs}" disabled="{!DisablePreviousForActiveJobs}" reRender="listRefresh"/>
              <apex:commandButton value=">" action="{!nextForActiveJobs}" disabled="{!DisableNextForActiveJobs}" reRender="listRefresh"/>
              <apex:commandButton value=">>" action="{!lastForActiveJobs}" disabled="{!DisableNextForActiveJobs}" reRender="listRefresh"/>
    </apex:outputPanel>
  
  <apex:outputPanel rendered="{!if(activeJobsToShow.size>0,true,false)}">
    <apex:outputLabel value="Sort By"></apex:outputLabel> 
   <apex:selectList value="{!selectedSortJobsOption}" size="1" multiselect="false"  onchange="callFuctionForJobsSort(this.value);">                   
        <apex:selectOptions value="{!SortOptions}" />              
   </apex:selectList>
   </apex:outputPanel>
   
  <apex:pageBlockTable value="{!activeJobsToShow}" var="job" rendered="{!if(activeJobsToShow.size>0,true,false)}">
               <apex:column headerValue="ADManager Number">
               <apex:commandLink value="{!job.AM_Job_Detail__r.AdManagerText__c}"  action="{!jobSheetPageTransfer}"  target="_blank">
               <apex:param name="chosenId" value="{!job.id}" assignTo="{!chosenId}"/>  
               </apex:commandLink>
               </apex:column>
               <apex:column headerValue="Date Logged">
               <apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!job.AM_Job_Detail__r.CreatedDate}" /></apex:outputText>
               </apex:column> 
               <apex:column value="{!job.AM_Job_Detail__r.Stage_of_Production_Activity__c}" headerValue="Stage Of production Activity"/>
               <apex:column value="{!job.AM_Job_Detail__r.Unilever_Project_Leader_Email__c}" headerValue="Project Leader Email"/>
               <apex:column value="{!job.AM_Job_Detail__r.Project_Leader_Country__c}" headerValue="Location of Unilever Project Leader (Country)"/>
              <!-- <apex:column value="{!job.AM_Job_Detail__r.Category__c}" headerValue="Category"/>
               <apex:column value="{!job.AM_Job_Detail__r.Brand__c}" headerValue="Brand Name"/>-->
               <apex:column value="{!job.AM_Job_Detail__r.Project_Details__c}" headerValue="Project Name"/>
               <apex:column value="{!job.AM_Job_Detail__r.Lead_Creative_Agency_name__c}" headerValue="Lead/Creative Agency Name"/>
               <apex:column value="{!job.AM_Job_Detail__r.Allocated_Budget_euro__c}" headerValue="Allocated Budget (Euro)"/>
               <apex:column value="{!job.AM_Job_Detail__r.Broadcast_Market__c}" headerValue="Broadcast market"/>
               <apex:column value="{!job.AM_Job_Detail__r.Production_Activity__c}" headerValue="Production Activity Type"/>
               <apex:column value="{!job.User__c}" headerValue="RAP Allocated"/>
               <apex:column value="{!job.Job_Allocated_Image__c}" headerValue="Allocated"/>
               <apex:column value="{!job.Job_Status_Image__c}" headerValue="Accepted"/>
               
               
   </apex:pageBlockTable>
   </apex:pageBlockSection>
   </apex:pageBlock>
   
   <apex:pageBlock >
  <apex:pageBlockSection title="Cancellation List"  columns="1" collapsible="true">
  
   <apex:outputPanel rendered="{!showPageButtonForCancel}">
              <apex:commandButton value="<<" action="{!beginningForCancelJobs}" disabled="{!DisablePreviousForCancelJobs}"  reRender="listRefresh"/>
              <apex:commandButton value="<" action="{!previousForCancelJobs}" disabled="{!DisablePreviousForCancelJobs}" reRender="listRefresh"/>
              <apex:commandButton value=">" action="{!nextForCancelJobs}" disabled="{!DisableNextForCancelJobs}" reRender="listRefresh"/>
              <apex:commandButton value=">>" action="{!lastForCancelJobs}" disabled="{!DisableNextForCancelJobs}" reRender="listRefresh"/>
    </apex:outputPanel>
  
  <apex:outputPanel rendered="{!if(cancelJobsToShow.size>0,true,false)}">
    <apex:outputLabel value="Sort By"></apex:outputLabel> 
   <apex:selectList value="{!selectedSortCancelOption}" size="1" multiselect="false"  onchange="callFuctionForCancelSort(this.value);">                   
        <apex:selectOptions value="{!SortOptions}" />              
   </apex:selectList>
   </apex:outputPanel>
   
  <apex:pageBlockTable value="{!WrapperList}" var="job" rendered="{!if(cancelJobsToShow.size>0,true,false)}">
               <apex:column headerValue="Select" >
                <apex:inputcheckbox value="{!job.SelectBox}" id="eachrow"  />
               </apex:column> 
              <apex:column headerValue="ADManager Number">
               <apex:commandLink value="{!job.sObjRec.AM_Job_Detail__r.AdManagerText__c}"  action="{!jobSheetPageTransfer}"  target="_blank">
               <apex:param name="chosenId" value="{!job.sObjRec.AM_Job_Detail__r.id}" assignTo="{!chosenId}"/>  
               </apex:commandLink>
               </apex:column>
               <apex:column headerValue="Date Logged">
               <apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!job.sObjRec.AM_Job_Detail__r.CreatedDate}" /></apex:outputText>
               </apex:column> 
               
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Stage_of_Production_Activity__c}" headerValue="Stage Of production Activity"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Unilever_Project_Leader_Email__c}" headerValue="Project Leader Email"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Project_Leader_Country__c}" headerValue="Location of Unilever Project Leader (Country)"/>
               <!--<apex:column value="{!job.sObjRec.AM_Job_Detail__r.Category__c}" headerValue="Category"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Brand__c}" headerValue="Brand Name"/>-->
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Project_Details__c}" headerValue="Project Name"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Lead_Creative_Agency_name__c}" headerValue="Lead/Creative Agency Name"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Allocated_Budget_euro__c}" headerValue="Allocated Budget (Euro)"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Broadcast_Market__c}" headerValue="Broadcast market"/>
               <apex:column value="{!job.sObjRec.AM_Job_Detail__r.Production_Activity__c}" headerValue="Production Activity Type"/>
               <apex:column value="{!job.sObjRec.User__c}" headerValue="RAP Allocated"/>
               <apex:column value="{!job.sObjRec.Job_Allocated_Image__c}" headerValue="Allocated"/>
               <apex:column value="{!job.sObjRec.Job_Status_Image__c}" headerValue="Accepted"/>
               
               
   </apex:pageBlockTable>
   </apex:pageBlockSection>
   </apex:pageBlock>
   </apex:outputPanel>
  </apex:form>
   <script>
   $(function(){
   //alert('hello');
       var stringArray = JSON.parse('{!MethodToPassProjectNames}');
      // alert(stringArray );
                    for(var i=0;i<stringArray.length;i++){
                    console.log(stringArray);
                         var newOption = $('<option value="'+stringArray[i].Name+'">'+stringArray[i].Name+'</option>');
                         $('#projectList').append(newOption);
                    }
                   console.log('options'+newOption );
   });
                    
                         
 </script>
</apex:page>