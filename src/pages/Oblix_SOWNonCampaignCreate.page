<apex:page sidebar="false" controller="Oblix_SOWNonCampaignCreateController" docType="html-5.0" showHeader="false" standardStylesheets="true">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/s/bs-3.3.5/jqc-1.11.3,dt-1.10.10/datatables.min.css" />
    <script type="text/javascript" src="https://cdn.datatables.net/s/bs-3.3.5/jqc-1.11.3,dt-1.10.10/datatables.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/css/unilever-style.css')}" />
    <script src="{!URLFOR($Resource.Oblix_JQueryBlockUI)}"></script>
    <script src="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/js/swopJS.js')}" />
    <script>
        // this global variable is used from static resources
        var sow_id = '{!marketing_SOW.Id}';
    </script>
    <script src="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/js/Oblix_SOWNonCampaignCreate.js')}" />
    
    <apex:form >
        <head>
            <title>SWOP : {!marketing_SOW.Name}</title>
        </head>


        <apex:actionFunction oncomplete="$.unblockUI()" name="refreshActivitySelection" reRender="agencyDepartment,dedicatedAgencyDepartment,selectedRole,rate,RoundedRate,errMsg,other_pane,addUpdateButton,addResourceUpdateButton,dedicatedSelectedRole,dedicatedRate,hours" action="{!refreshActivitySelection}" >
        
            <apex:param name="selectedTab" assignTo="{!selectedTab}" value="" />
        </apex:actionFunction>  

        <apex:actionFunction oncomplete="$.unblockUI()" name="activityUpdate" reRender="other_pane" >
        </apex:actionFunction>

        <!-- <apex:actionFunction action="{!fillAgencyDepartment}" oncomplete="$.unblockUI()" name="adupdate" reRender="agencyDepartment,dedicatedAgencyDepartment,selectedRole,rate,errMsg,other_pane,addUpdateButton,addResourceUpdateButton" >
            <apex:param name="selectedTab" assignTo="{!selectedTab}" value="" />
        </apex:actionFunction>

        <apex:actionFunction action="{!fillRoleTitle}" oncomplete="$.unblockUI()" name="RTupdate" reRender="selectedRole,dedicatedSelectedRole,rate,errMsg,addUpdateButton,addResourceUpdateButton" >
            <apex:param name="selectedTab" assignTo="{!selectedTab}" value="" />
        </apex:actionFunction>

        <apex:actionFunction action="{!fillRate}" oncomplete="$.unblockUI()" name="Rateupdate" reRender="rate,dedicatedRate,hours,errMsg,addUpdateButton,addResourceUpdateButton" >
            <apex:param name="selectedTab" assignTo="{!selectedTab}" value="" />
        </apex:actionFunction> -->       


        <apex:actionFunction action="{!getAndSetActivitiesByName}" oncomplete="$.unblockUI()" name="getAndSetActivitiesByName" reRender="selectionTable,resource_input_fields,activity_tabs, addResourceUpdateButton,activity_resource_input_field_panel">
            <apex:param name="campaignItem" assignTo="{!selectedName}" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!addToActivitySelectionMap}" oncomplete="$.unblockUI()" name="addToActivitySelectionMap" reRender="selectionTable,activity_resource_input_field_panel">
            <apex:param name="campaignItem" assignTo="{!seletedActivity}" value="" />
            <!-- <apex:param name="is_selection_for_edit_mode" assignTo="{!is_selection_for_edit_mode}" value="false" /> -->
        </apex:actionFunction>
        <apex:actionFunction action="{!removeFromSelectionMap}" oncomplete="$.unblockUI()" name="removeFromSelectionMap" reRender="selectionTable,shoppingBasketPanel,campaignTotalPanel">
            <apex:param name="selectedkey" assignTo="{!selectedkey}" value="" />
            <!-- <apex:param name="is_selection_for_edit_mode" assignTo="{!is_selection_for_edit_mode}" value="false" /> -->
        </apex:actionFunction>
        <apex:actionFunction action="{!removeItemFromBasketList}" oncomplete="$.unblockUI()" name="removeItemFromBasketList" reRender="shoppingBasketPanel,campaignTotalPanel,shoppingBasketPanel,activity_resource_input_field_panel">
            <apex:param name="basketItemToRemove" assignTo="{!basketItemToRemove}" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!insertSelectedActivitiesAndRefreshBasket}" oncomplete="$.unblockUI()" name="insertSelectedActivities" reRender="shoppingBasketPanel,selectionTable,campaignTotalPanel,shoppingBasketPanel" >
            <!-- <apex:param name="is_selection_for_edit_mode" assignTo="{!is_selection_for_edit_mode}" value="false" /> -->
        </apex:actionFunction>
        <apex:actionFunction action="{!upsertSelectedResourceAndRefreshBasket}" oncomplete="$.unblockUI()" name="insertSelectedResource" reRender="shoppingBasketPanel,selectionTable,campaignTotalPanel,shoppingBasketPanel, activity_resource_input_field_panel" />    

        <apex:actionFunction action="{!setActivityInputFieldsForSelectedItem}" oncomplete="$.unblockUI()" name="setActivityInputFieldsForSelectedItem" reRender="activity_resource_input_field_panel">
            <apex:param name="selected_activity" assignTo="{!selected_activity}" value="" />
            <apex:param name="selected_country" assignTo="{!selected_country}"  value=""/>
            <apex:param name="selected_agent_department" assignTo="{!selected_agent_department}"  value=""/>
            <apex:param name="selected_other" assignTo="{!selected_other}" value="" />
            <apex:param name="selected_role" assignTo="{!selected_role}" value="" />
            <apex:param name="selected_hours" assignTo="{!selected_hours}" value="" />
            <!--apex:param name="selected_hourly_rate" assignTo="{!selected_hourly_rate}" value="" /-->
            <!-- <apex:param name="is_selection_for_edit_mode" assignTo="{!is_selection_for_edit_mode}" value="true" /> -->
        </apex:actionFunction>

        <div class="Oblix_header_bkgd">
            <header class="Oblix_header_panel">
                <img alt="Unilever logo" src="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/images/Oblix_Unilever_logo.png')}" width="54" height="60" />
                <div class="header_divider_vertical"></div>
                <div class="header_panel_text">
                    <h2>Hi  {!$User.FirstName} {!$User.LastName }, Welcome to SWOP the Scope of Work Online Planner</h2>
                    <p><a href="{!URLFOR($Page.oblix_sowmain)}">SWOP Home</a>&nbsp;<span>&#9658;</span>&nbsp;<a href="{!URLFOR($Page.oblix_sowmaindetail)}?sowId={!marketing_SOW.Id}">{!marketing_SOW.Name}</a>&nbsp;<span>&#9658;</span>&nbsp;Add non-campaign items
                    </p>
                </div>
                <apex:commandButton styleClass="btn btn-xs pull-right btn_cross btn_exit_swop" action="{!exitSwop}" value="DONE FOR TODAY? EXIT SWOP">
                </apex:commandButton>
                <apex:commandLink styleClass="btn btn-xs pull-right btn-danger btn_report btn_go_to_reports" action="{!goToReportsHome}" value="REPORTS" target="_blank">
                </apex:commandLink> 
                <!--a target="_blank" href="/00O/o"><button class="btn btn-xs pull-right btn-danger btn_report btn_go_to_reports" >REPORTS</button></a-->
            </header>
        </div>
        <div class="container SOW_body">
            <div class="row">
                <div class="col-lg-6 col-md-6">
                    <h1 class="SOW_header_title">Add Non-Campaign Items to {!marketing_SOW.Name}</h1>
                </div>
                <apex:outputPanel id="campaignTotalPanel">
                    <table class="SOW_header_value_summary">
                        <tr>
                            <td class="SOW_header_value_title">Non Campaign Estimated Fee</td>
                            
                            <td class="SOW_header_value">
                                <h2>€<apex:outputText value="{0, number,###,###,##0}">
                                        <apex:param value="{!campaignTotalValue}"/>
                                    </apex:outputText>
                                </h2>
                            </td>
                        </tr>
                    </table>
                </apex:outputPanel>
            </div>
            <hr class="divider" />
            <apex:outputPanel id="errMsg">
               <apex:outputPanel rendered="true"  >                          
                    <apex:pagemessages ></apex:pagemessages>
               </apex:outputPanel>   
            </apex:outputPanel>
            <div class="row">
                <div class="col-lg-9">
                    <apex:outputPanel id="activity_tabs">

                    <div class="row">
                         <ul class="sow_tab_style nav nav-tabs sow_tab_align" data-tabs="tabs">
                            <li role="presentation" class="non_camp_tab_line_align {!if(selectedTab<>'dedicated resource','active','')}"><a href="#activity" data-toggle="tab">Add activity</a>
                            </li>
                            <li role="presentation" class="non_camp_tab_line_align {!if(selectedTab=='dedicated resource','active','')}"><a href="#resource" data-toggle="tab">Add dedicated resource</a>
                            </li>
                        </ul> 
                        <!--ul class="sow_tab_style nav nav-tabs sow_tab_align" data-tabs="tabs">
                            <li role="presentation" class="non_camp_tab_line_align active"><a href="#activity" data-toggle="tab">Add activity</a>
                            </li>
                            <li role="presentation" class="non_camp_tab_line_align"><a href="#resource" data-toggle="tab">Add dedicated resource</a>
                            </li>
                        </ul-->
                    </div>
                    </apex:outputPanel>

                    <apex:outputPanel id="activity_resource_input_field_panel">
                    <div id="my-tab-content" class="tab-content">
                        <div class="tab-pane {!if(selectedTab<>'dedicated resource','active','')}" id="activity">
                    

                            <div class="row">
                                <div class="col-lg-4">
                                    <p class="create_SOW_form_titles">Activity*</p>
                                    <apex:inputField value="{!activity.nonCampaignItem.Activities__c}" styleclass="investment_project_dropdowns_right" id="activityId" onchange="activityUpdate();blockme();" />
                                    <!-- <apex:inputField value="{!activity.nonCampaignItem.Activities__c}" styleclass="investment_project_dropdowns_right" id="activityId" onchange="if ($(this).val()=='Other'){ $('.otherr').prop('disabled', false);}else{ $('.otherr').prop('disabled', true);}" /> -->
                                </div>
                                <div class="col-lg-4">
                                    <p class="create_SOW_form_titles">Country*</p>
                                    <apex:selectList size="1" value="{!activity.selectedCountryname}" onchange="refreshActivitySelection('activity');blockme();" styleclass="investment_project_dropdowns_right" id="country">
                                        <apex:selectOptions value="{!countries}" />
                                    </apex:selectList>
                                </div>
                                <div class="col-lg-4">
                                    <p class="create_SOW_form_titles">Agency department*</p>
                                    <apex:selectList size="1" value="{!activity.selectedAgencyDepartment}" styleclass="picklist_init investment_project_dropdowns_right" id="agencyDepartment" onchange="refreshActivitySelection('activity');blockme();" disabled="{!IF(activity.agencyVisible==false,true,false)}" style="min-width:100%;">
                                        <apex:selectOptions value="{!AgencyDepartments}" />
                                    </apex:selectList>
                                </div>
                            </div>
                            <apex:outputPanel id="other_pane"> 
                                <apex:outputPanel id="otherInfoField" rendered="{!if(activity.nonCampaignItem.Activities__c == 'Other',true,false)}">
                                    <div class="row">
                                        <div class="col-lg-4">
                                            <p class="non_campaign_other"><strong>Please describe "other" *</strong></p>
                                            <apex:inputField styleClass="resource_name_box_align" value="{!activity.nonCampaignItem.name}" id="dedicatedResourceOther"  />
                                        </div>
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>
                            <div class="row">
                                <div class="col-lg-4 non_camp_dropdown_spacing">
                                    <p class="create_SOW_form_titles">Role*</p>
                                    <apex:selectList size="1" value="{!activity.selectedRole}" id="selectedRole" styleclass="picklist_init" style="min-width:100%;" disabled="{!IF(activity.roleVisible==false,true,false)}" onchange="refreshActivitySelection('activity');blockme();">
                                        <apex:selectOptions value="{!agencyRoleTitle}" />
                                    </apex:selectList>
                                </div>
                                <div class="col-lg-8 non-campaign_hourly_rate_section">
                                    <p>Hourly rate €
                                        <apex:outputText value="{0, number,###,###,##0}" id="RoundedRate">
                                            <apex:param value="{!VALUE(activity.hourlyRate)}"/>
                                        </apex:outputText>
                                        <apex:outputText value="{!activity.hourlyRate}" id="rate" style="display:none;"/>
                                        <!-- <div id="rate" style="display:none;">{!VALUE(activity.hourlyRate)}</div> -->
                                        <apex:input type="number" styleClass="hourly_rate_box" html-min="0" html-step="1" value="{!activity.hoursSelected}"  disabled="{!IF(activity.valVisible==false,false,false)}" id="hoursSelected" onkeyup="   if($(this).val()<0)  $(this).val($(this).val()*-1);" onkeypress="return event.charCode >= 48 && event.charCode <= 57"/>
                                        <!--input type="number" class="hourly_rate_box" name="hourlyRate" /-->hours
                                        <!--button class="btn btn-primary btn_plus btn_asset_add" onclick="addToActivitySelectionMap();">ADD</button-->
                                        <apex:outputPanel id="addUpdateButton">
                                            <apex:outputPanel rendered="{!IF(can_manage_non_campaign,true,false)}">
                                            <apex:commandButton value="{!(IF(setUpdateButton,'UPDATE','ADD'))}" styleClass="btn btn-primary btn_plus {!(IF(setUpdateButton,'btn_update','btn_asset_add'))}" onclick="addToActivitySelection(); return false;" /> 
                                            </apex:outputPanel> 
                                        </apex:outputPanel>                                  
                                    </p>
                                </div>
                            </div>
                            <apex:outputPanel id="selectionTable"  >
                                <apex:outputPanel rendered="{!IF(selectedActivitiesSize > 0, true, false)}">
                                    <table class="table table-striped" id="swopTable">
                                        <thead>
                                            <tr>
                                                <td style="display:none;">key</td>
                                                <td style="display:none;">Activity Id</td>
                                                <th>Activity</th>
                                                <th>Country</th>
                                                <th>Agency department</th>
                                                <th>Role</th>
                                                <th>Hourly rate</th>
                                                <th>Hours</th>
                                                <th>Total €</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <apex:repeat value="{!activitySelectionMap}" var="eachActivity">
                                                <tr >
                                                    <th style="display:none;" id="idColumn_{!activitySelectionMap[eachActivity].key}" >{!activitySelectionMap[eachActivity].key}</th>
                                                    <th style="display:none;" id="idColumn_{!activitySelectionMap[eachActivity].activityId}">{!activitySelectionMap[eachActivity].activityId}</th>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].selectedActivity}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].selectedCountryname}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].selectedAgencyDepartment}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].selectedRole}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].roundedRate}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">{!activitySelectionMap[eachActivity].hoursSelected}</td>
                                                    <td onclick="setActivityInputFieldsForSelectedItem('{!activitySelectionMap[eachActivity].selectedActivity}', '{!activitySelectionMap[eachActivity].selectedCountryname}', '{!activitySelectionMap[eachActivity].selectedAgencyDepartment}', '{!activitySelectionMap[eachActivity].name}' ,'{!activitySelectionMap[eachActivity].selectedRole}', {!activitySelectionMap[eachActivity].hoursSelected}, {!activitySelectionMap[eachActivity].hourlyRate});">
                                                        <apex:outputText value="{0, number,###,###,##0}"> 
                                                            <apex:param value="{!activitySelectionMap[eachActivity].totalAmount}"/>
                                                        </apex:outputText>
                                                    </td>
                                                    <td>
                                                        <apex:outputPanel rendered="{!IF(can_manage_non_campaign,true,false)}">
                                                            <a href="#" id="removeRow_{!activitySelectionMap[eachActivity].key}" value="{!activitySelectionMap[eachActivity].key}" onclick="removeRow('{!activitySelectionMap[eachActivity].key}');"> <img alt="Remove" src="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/images/redcross.png')}" width="12" height="12" />
                                                            </a>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
                                    <apex:outputPanel rendered="{!IF(can_manage_non_campaign,true,false)}">
                                        <apex:commandButton value="ADD SELECTION TO BASKET" styleClass="btn btn-primary btn-xs pull-right btn_plus btn_add_selection" onclick="insertSelectedActivities(); return false;" />
                                    </apex:outputPanel>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </div>
                            <div class="tab-pane {!if(selectedTab=='dedicated resource','active','')}" id="resource">
                                <apex:outputPanel id="resource_input_fields">
                                <div class="row">
                                    <div class="col-lg-4">
                                        <p class="create_SOW_form_titles">Resource Name*</p>
                                        <apex:inputField styleClass="resource_name_box_align" value="{!resource.nonCampaignItem.name}" id="dedicatedResourceName"  />
                                    </div>
                                    <div class="col-lg-4">
                                        <p class="create_SOW_form_titles">Country*</p>
                                        <apex:selectList size="1" value="{!resource.selectedCountryname}" onchange="refreshActivitySelection('resource');blockme();" styleclass="investment_project_dropdowns_right" id="dedicatedCountry">
                                            <apex:selectOptions value="{!countries}" />
                                        </apex:selectList>
                                    </div>
                                    <div class="col-lg-4">
                                        <p class="create_SOW_form_titles">Agency department*</p>
                                        <apex:selectList size="1" value="{!resource.selectedAgencyDepartment}" styleclass="picklist_init investment_project_dropdowns_right" id="dedicatedAgencyDepartment" onchange="refreshActivitySelection('resource');blockme();" disabled="{!IF(resource.agencyVisible==false,true,false)}" style="min-width:100%;">
                                            <apex:selectOptions value="{!resourceAgencyDepartment}" />
                                        </apex:selectList>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-4 non_camp_dropdown_spacing">
                                        <p class="create_SOW_form_titles">Role*</p>
                                        <apex:selectList size="1" value="{!resource.selectedRole}" id="dedicatedSelectedRole" styleclass="picklist_init" style="min-width:100%;" disabled="{!IF(resource.roleVisible==false,true,false)}" onchange="refreshActivitySelection('resource');blockme();">
                                            <apex:selectOptions value="{!resourceRoleTitle}" />
                                        </apex:selectList>
                                    </div>
                                    <div class="col-lg-8 non-campaign_hourly_rate_section yearly_rate_form_align">
                                        <p>FTE €&nbsp;&nbsp;
                                            <!--apex:outputLabel value="{!resource.hourlyRate}" id="dedicatedRate" /-->
                                            <apex:outputText value="{0, number,###,###,##0}" id="dedicatedRate" >
                                                <apex:param value="{!VALUE(resource.hourlyRate)}" />
                                            </apex:outputText>
                                            <!--apex:input type="number" styleClass="hourly_rate_box" html-min="0" value="{!resource.hoursSelected}" onchange="if(!isNaN(parseInt($('.rateclass').text()))){ $('.rslt').text(Math.round(($(this).val()*parseFloat($('.rateclass').text()))+' '));formatNumber ($('.rslt'));}" disabled="{!IF(resource.valVisible==false,false,false)}" id="dedicatedHoursSelected" onkeyup="   if($(this).val()<0)  $(this).val($(this).val()*-1);" /-->&nbsp;&nbsp;
                                            <apex:input type="number" styleclass="prcentt input_init" html-min="0" html-max="100" html-step="1" value="{!resource.hoursSelected}"  style="width:40px;" id="prcent"   onkeyup="   if($(this).val()<0)  $(this).val($(this).val()*-1);  if($(this).val()>100)  $(this).val(100);  " onkeypress="return event.charCode >= 48 && event.charCode <= 57" />
                                            <!--input type="number" class="hourly_rate_box" name="hourlyRate" /-->%
                                            
                                            <!--button class="btn btn-primary btn_plus btn_asset_add" onclick="addToActivitySelectionMap();">ADD</button-->
                                            <apex:outputPanel id="addResourceUpdateButton">
                                                <apex:outputPanel rendered="{!IF(can_manage_non_campaign,true,false)}">
                                                <apex:commandButton value="{!(IF(setResourceUpdateButton,'UPDATE','ADD'))}" styleClass="btn btn-primary btn_plus {!(IF(setResourceUpdateButton,'btn_update','btn_asset_add'))} " onclick="validateResourceSelection(); return false;" />
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                        </p>
                                    </div>
                                </div>
                                </apex:outputPanel>
                            </div>
                    </div>

                    </apex:outputPanel>
                </div>
                <div class="col-lg-3 asset_shopping_basket_margin">
                    <apex:outputPanel id="shoppingBasketPanel">
                        <div class="asset_shopping_basket">
                            <div class="asset_shopping_basket_title_bar">
                                <h2>Non Campaign Basket ({!campaignBasketList.size})</h2>
                            </div>
                                
                            <apex:repeat value="{!campaignBasketList}" var="eachItem">
                                <div class="asset_shopping_basket_item">
                                    <div class="campaign_create_agency_hub_split_table_subtitle padding_bottom0">
                                        <apex:outputPanel rendered="{!IF(can_manage_non_campaign,true,false)}">
                                            <a href="#" id="basketRemoveRow_{!eachItem.activityName}" value="{!eachItem.activityName}" onclick="basketRemoveRow('{!eachItem.activityName}');"><img alt="Remove" src="{!URLFOR($Resource.Oblix_SwopAssets, 'Oblix_SwopAssets/images/redcross.png')}" class="attachement_redcross" height="12" width="12" /></a>
                                        </apex:outputPanel>
                                        <a href="#" id="basketItem_{!eachItem.activityName}" onclick="getAndSetActivitiesByName('{!JSENCODE(eachItem.activityName)}');blockme();">{!eachItem.activityName} - €<apex:outputText value="{0, number,###,###,##0}"> <apex:param value="{!eachItem.totalAmount}"/></apex:outputText>
                                        </a>
                                    </div>
                                </div>    
                            </apex:repeat>
                                
                            <div class="asset_shopping_basket_total">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <p class="asset_shopping_basket_total_fee_text">Non Campaign Estimated Fees</p>
                                    </div>
                                    <div class="col-lg-4">
                                        <h2 class="asset_shopping_basket_total_fee_value">€<apex:outputText value="{0, number,###,###,##0}">
                                                                                                <apex:param value="{!campaignTotalValue}"/>
                                                                                            </apex:outputText></h2>
                                    </div>
                                </div>
                            </div>
                            <div class="asset_shopping_basket_btn">
                                <apex:commandButton value="FINISH WITH BASKET" styleClass="btn btn-primary btn-xs btn_check btn_finish_basket" action="{!finishBasket}" />
                            </div>
                        </div>
                    </apex:outputPanel>
                </div>
            </div>
        </div>
    </apex:form>
</apex:page>