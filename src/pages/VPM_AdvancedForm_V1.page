<apex:page standardController="VPM_PurchasingRequests__c">  
    <apex:includeScript value="/soap/ajax/15.0/connection.js"/>
    <apex:stylesheet value="{!URLFOR($Resource.vpmadvancedformcss)}" />
    <apex:includeScript value="{!$Resource.vpmjqueryresources}"/>
    <apex:includeScript value="{!URLFOR($Resource.vpmjqueryresources, 'vpmjqueryresources/jquery-1.12.2.min.js')}"/>
    <!--apex:stylesheet value="{!URLFOR($Resource.VPMstyle)}"/-->
    <apex:stylesheet value="{!URLFOR($Resource.vpmjqueryresources, 'vpmjqueryresources/jquery-ui.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.vpmstyles, 'vpmstyles.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.vpmbootstrapresources, 'vpmbootstrapresources/bootstrap.css')}" />
    <!--style>
        body .bPageBlock label {
            line-height: 1em !important;
            font-size: 12px !important;
         	display: inline;
    		padding-left: 5px;
        }
        .bPageBlock button{
        	font-family: sans-serif;
    		font-size: 11px;
        }
        input, button, select, textarea {
            line-height: 1em !important;
        }
        body{
            font-size: 0.8rem !important;
            line-height: 1 !important;
        }
        h2{
        	font-size: 0.9rem;
        }
        body .bPageBlock .btn-primary{
       		color: #fff !important;
   	 		background-color: #0275d8 !important;
    		border-color: #0275d8 !important;
        	background: !important;
        	background-image : none !important;
        	padding: 8px !important;
        }
        .FlowPageBlockBtns{
        	text-align: center !important;
        	text-indent: -70px !important
        }
        body .bPageBlock label {
            line-height: 1em !important;
            font-size: 13px !important;
         	display: inline;
    		padding-left: 5px;
        }
         .bPageBlock .detailList .dataCol {
               width: 34%
        }
        body .bPageBlock input[type="text"]{
        	border-radius: 5px;
    		border-style: ridge;
    		height: 1.9em;
    		width: 63%;
        }
        .bPageBlock button{
        	font-family: sans-serif;
    		font-size: 11px;
        }
        .Custom17Tab .brdPalette{
        	    border-top-color: #0275D8;
        }
        .Custom17Tab .secondaryPalette, .individualPalette .Custom17Block .secondaryPalette{
        	 border-color: #0275D8;
        }
        .emphasizeHeader{
        	 text-transform: uppercase;
            font-size: 16px;
            text-decoration: underline;
        }
        .statusAlignment{
            float: left;
            position: relative;
            left:-2.5em;
        }
        .typeAlignment{
        	position: relative;
    		left: -1em;
        }
    </style-->
    <script type = "text/javascript">
    window.onload=function() {            
        var criteria1 = "{!VPM_PurchasingRequests__c.VPM_Status__c}"; 
        var links = $("head").find("link");
        // alert({!$ObjectType.VPM_PurchasingRequests__c.accessible})<link class="user" href="/resource/1460627090000/vpmadvancedformcss" rel="stylesheet" type="text/css">
        $('link[href="/resource/1460627090000/vpmadvancedformcss"]').remove();
        /*for(var i=0;links.length-2;i++){
            var linkMarkup = links[i];
            if($(linkMarkup).prop("href")){
        		if($(linkMarkup).prop("href").indexOf("vpmadvancedformcss") > -1){
            		$(linkMarkup).remove();
            	}
             }
        }*/
        if(criteria1=="FLS Review") {
            alert("Please Approve / Reject the Request before completing the Advanced Form");
            //return false;
        }
    };
    function showValuesFunc(){
        var pur = new sforce.SObject("VPM_PurchasingRequests__c");
        
        //alert("Function Called!");
        //console.log(JSON.stringify(pur));
        var vendorName = document.getElementById('j_id0:j_id4:i:f:pb:d:VPM_SearchVendorName.input').value;
        var street = document.getElementById('j_id0:j_id4:i:f:pb:d:VPM_SearchStreet1.input').value;
        var zipCode = document.getElementById('j_id0:j_id4:i:f:pb:d:VPM_SearchZIPPostcode.input').value;
        var taxCode = document.getElementById('j_id0:j_id4:i:f:pb:d:VPM_SearchTaxCode.input').value;
        if(vendorName && street && zipCode && taxCode!="")
    		alert("Input Values:\n "+ vendorName +"\n"+ street +"\n"+ zipCode +"\n"+ taxCode);
        else
            alert("Input non-empty values in the fields");
    }
    
    $(document).ready(function(){
        var el = $('tr>td.pbTitle');
        var savedRow = '';
        var spanToAlign = document.getElementById("j_id0:j_id8:i:f:pb:d:VPM_MaintainTypeInfo");
        var numberOfTextFields = $('.detailList input[type="text"]').length;
        var vendorDetailHeader = document.getElementById("j_id0:j_id8:i:f:pb:d:VPM_CreateVendorDetailInfo");
        var maintainVendorHeader= document.getElementById("j_id0:j_id8:i:f:pb:d:VPM_Maintain1VendorDetailsScreenInfo");
        var maintainRadioBtns = document.getElementById("j_id0:j_id8:i:f:pb:d:VPM_MaintainTypeInfo");
        
        $("#01r190000000Jj6_Tab").css("background-color","#0275D8");
        $('input[type="button"],input[type="submit"],button').addClass("btn-primary");
        $(vendorDetailHeader).find("b").addClass('emphasizeHeader');
        $(maintainVendorHeader).find("b").addClass('emphasizeHeader');
       	$(spanToAlign).css("float","left");
        var allDivs =$(spanToAlign).find('div');
        if($(allDivs[2]).find('font').text().indexOf('Status')!=-1)
            $(allDivs[2]).css({"float":"left"},{"margin-left":"6em"});
        for(var i=0;i<el.length;i++){
            //if($(el[i]).children().length == 0)
                 //el[i].remove(); 
         }
         
         if($(".interviewDisplayTextRow b").text().indexOf("Type") > -1){
             	savedRow = $(".interviewDisplayTextRow")[1];
             	$(".interviewDisplayTextRow")[1].remove();
             $(savedRow).insertBefore($(".interviewDisplayTextRow")[0]);
             $($(".interviewDisplayTextRow")[0]).css("display","table-cell");
             $($(".interviewDisplayTextRow")[1]).css({"float": "right",
                                                      "position": "relative",
                                                      "right": "22.5em"});
             }
        if($(maintainRadioBtns).find("span").text().indexOf("Maintain") > -1){
        	savedRow = $(maintainRadioBtns).find("span");
            if($(maintainRadioBtns).find("div").text().indexOf("Status") > -1){
            	$(savedRow).insertBefore($(maintainRadioBtns).find("div:last-child"));
            }
            $(maintainRadioBtns).find("div:nth-child(3)").addClass("statusAlignment");
            $(maintainRadioBtns).find("span").addClass("typeAlignment");
        }
        if(numberOfTextFields > 10){
        	var remainingRows = [];
            var toRemove ='';
            for(var i=(Math.round(numberOfTextFields/2));i<numberOfTextFields;i++){
                toRemove = $('.detailList input[type="text"]')[i]; 
            	remainingRows.push($(toRemove).parent().parent());
            }

            for(var j=0,i=2;j<remainingRows.length,i<$('.detailList tr').length;j++,i++){
            	 var row = ($('.detailList tr')[i]);
                 $(row).find(".labelCol.last.empty").remove();
                 $(row).find(".dataCol.last.empty").remove();
                 if(remainingRows[j] && remainingRows[j].children()){
                 	$(row).append(remainingRows[j].children());
                 }
            }
        }
    });
    </script>
   
 <flow:interview name="VPM_PurchasingRequestAdvancedForm" finishLocation="/{!VPM_PurchasingRequests__c.Id}" rendered="{!VPM_PurchasingRequests__c.VPM_Status__c != 'FLS Review'}" >    
        <apex:param name="VPM_PurchasingRequestID" value="{!VPM_PurchasingRequests__c.Id}"/>    
    </flow:interview>

    <div>
    <apex:outputLink onclick="openPopup('{!$Page.VPM_AttachmentSectionPopUp}');return false;">Help for uploading documents</apex:outputLink>
    </div>
    <apex:relatedList subject="{!VPM_PurchasingRequests__c}" list="CombinedAttachments" rendered="{!VPM_PurchasingRequests__c.VPM_Status__c != 'FLS Review'}">
    <!--apex:facet name="footer">
        <apex:outputLink onclick="openPopup('{!$Page.VPM_AttachmentSectionPopUp}');return false;">Help for uploading documents</apex:outputLink>
    </apex:facet-->
    </apex:relatedList>
    
    
    <apex:detail subject="{!VPM_PurchasingRequests__c.Id}" rendered="{!VPM_PurchasingRequests__c.VPM_Status__c == 'FLS Review'}" showChatter="true"/>
</apex:page>