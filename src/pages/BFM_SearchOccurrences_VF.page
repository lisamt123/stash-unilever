<apex:page standardController="BFM_Occurrence__c"  recordSetVar="BFM_Occurrence" extensions="BFM_SearchOccurrenceController_CC"  sidebar="false" id="pge">  
    <apex:form id="frm">        
        <style>
            th, td { white-space: nowrap; }
            div.dataTables_wrapper {
                width: 1250px;
                margin: 0 auto;
            }   
        </style>
         
         <script>
             $(document).ready(function() {
                    $('#example').dataTable( {
                        "scrollY": 200,
                        "scrollX": true
                    } );
                } );
        </script>
        
        <apex:actionstatus id="status">
            <apex:facet name="start">
                <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb;
                       height: 100%;opacity:0.65;width:100%;"> 
                    <div class="waitingHolder" style="top: 74.2px; width: 91px;">
                        <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                        <span class="waitingDescription">Loading...</span>
                    </div>
                </div>
            </apex:facet>
       </apex:actionstatus>
    
        <apex:pageBlock >
            <apex:pageBlockSection columns="2" id="ocrno">
            <apex:inputText value="{!searchOccurrence.Occurrence_Number__c}" id="occnum"/>
            <apex:inputText value="{!searchOccurrence.Range_of_Extent_of_Occurrence_From__c}"/>
            </apex:pageBlockSection>
             <div align="center">
                 <apex:commandButton value="Search Occurrence" action="{!mySearch}" status="status" rerender="frm" oncomplete="Checkfiled()"/>
             </div>
        </apex:pageBlock>
        
        <apex:pageBlock title="Search Result" id="noRec" rendered="{! IF(OccList!= null && OccList.size ==0,true,false)}" >
              <apex:outputPanel >
                <h1>No Records Found</h1>
              </apex:outputPanel>
        </apex:pageBlock>
        
        <apex:pageblock title="Search Result" rendered="{!IF(AND(NOT(ISBLANK(OccList)),OccList.size>0),true,false)}">
        <apex:outputPanel id="occur">
        <apex:pageblockTable value="{!OccList}" var="Occ" id="occurnce">
         <apex:column headerValue="Name">  
         <apex:outputlink target="_blank" value="/{!Occ.id}">{!Occ.Name}</apex:outputlink>  
         </apex:column> 
         <apex:column value="{!Occ.Occurrence_Number__c}"/>
         <apex:column value="{!Occ.Status__c}"/>
         <apex:column value="{!Occ.Range_of_Extent_of_Occurrence_From__c}"/>
         <apex:column value="{!Occ.Range_of_Extent_of_Occurrence_To__c}"/>
         </apex:pageBlockTable>
         </apex:outputPanel>
         <apex:pageBlockButtons location="top">
        <div style="text-align:right"> 
        Total Records Found: {!Con.resultSize} 
            <apex:selectList value="{!recordscount}" multiselect="false" size="1">                
                <apex:selectOptions value="{!recordsize}"/>
                <apex:actionSupport event="onchange" action="{!getoccurences}" reRender="occur,occurnce"/>
           </apex:selectList>
            
     <apex:commandLink action="{!First}" title="First" value="First" rendered="{!Con.HasPrevious}"/>&nbsp;    
     <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(Con.HasPrevious)}">First</apex:outputPanel>&nbsp;
      
     <apex:image url="/img/search_prevarrow_disabled.gif" styleClass="prevArrow" rendered="{!NOT(Con.HasPrevious)}"/> 
     <apex:image url="/img/search_prevarrow.gif" title="Previous Page" styleClass="prevArrow" rendered="{!Con.HasPrevious}"/>&nbsp;  
     <apex:commandLink action="{!Previous}" title="Previous Page" value="Previous Page" rendered="{!Con.HasPrevious}"/>&nbsp;    
     <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(Con.HasPrevious)}">Previous Page</apex:outputPanel>&nbsp;
               
     <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(Con.HasNext)}">Next Page</apex:outputPanel>          
     <apex:commandLink title="Next Page" value="Next Page" rendered="{!Con.HasNext}" action="{!Next}"/>&nbsp;  
     <apex:image url="/img/search_nextarrow.gif" title="Next Page" styleClass="nextArrow" rendered="{!Con.HasNext}"/>&nbsp; 
     <apex:image url="/img/search_nextarrow_disabled.gif" rendered="{!NOT(Con.HasNext)}"/> 
  
     <apex:outputPanel styleClass="pShowLess noLink" style="color:grey" rendered="{!NOT(Con.HasNext)}">Last</apex:outputPanel> 
     <apex:commandLink title="Last"  value="Last" rendered="{!Con.HasNext}" action="{!last}"/> 
    
      </div>
      </apex:pageBlockButtons>                      
      </apex:pageblock>
    </apex:form>
    <script language="JavaScript" type="text/javascript">
    function CloseWindow(){  
        var occnum=document.getElementById("pge:frm:j_id2:ocrno:occnum").value;
        if(occnum==''){
            alert('Please enter occurence no');
        }else{
            if(window.parent){
                window.parent.opener.location.href = window.parent.opener.location.href;
                window.parent.close();
                window.parent.reload();
            }   
            else{
                window.opener.location.href = "{!JSENCODE($CurrentPage.parameters.occrid)}"
                window.close();   
            }   
        }
    </script>
</apex:page>