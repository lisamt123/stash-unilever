<apex:page controller="ipmDownloadTemplateController" sidebar="false" standardStylesheets="false"> 
    <apex:stylesheet value="{!URLFOR($Resource.ipmResource, 'css/ipmModal.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ipmResourceRevamp, 'css/ipmHeader-new.css')}"/>

<style>
    /* header new styles */
    .ipmFunnelPanel {bottom: 4px;}
    
       // .htmlDetailElementTable img {width:44px!important;max-width: 100%; height: 44px!important; border-radius: 50% !important;}
        .ipmProjectDetails .panel-title {line-height:2em!important;}  
             
        .uploadImg img {border-radius: 50% !important;max-width: 44px;} 
        .ipmProjectDetails .panel {background:transparent;}
        .ipmProjectDetails .uploadImg {overflow:hidden;padding:0!important;margin:0!important;}
        
        .ipmProjectDetails .panel-body .col-sm-3 {padding-left:3px!important;margin-top: 18px;}
        .pageHeadToolbar { border-bottom:1px solid #ddd; margin:0 15px; }       
        .pageHeadToolbar h2.pageTitle {margin:20px 7px 20px 0!important;display:inline-block; font-size:1.8402083517355998em;color:#253b78; font-weight:bold;padding-right: 10px;border-right: 1px solid #929292;}
        .pageHeadToolbar .SecFillProgress {display:inline-block; }
        .pageHeadToolbar .SecFillProgress .fillProgress {display:inline-block;color:#e98824;font-size:22px; font-weight:normal;}
        .pageHeadToolbar .SecFillProgress .fillProgress span {font-size:12px!important;}
        .pageHeadToolbar .SecFillProgress .fillProgressTxt {color:#364354!important;display:inline-block; font-size:12px;}
        .pageHeadToolbar .SecStatusUpdate {display:inline-block;margin:15px 0; padding-right:15px;border-right: 1px solid #929292;}        
        .pageHeadToolbar .SecCurrentStatus {display:inline-block; color:#364354; margin: 15px;text-align:right;}
        .pageHeadToolbar .status {color:#e98824;display:block;font-weight:bold;}
        .icoButton {cursor:pointer;}
        
        .leftSideBar {margin-top:10px;}
        .leftSideBar h4 {color:#253b78; font-size:1.1em; font-weight:bold;}
        .leftSideBar ul.docFilter {padding:0!important; margin:20px 0 0!important; list-style:none;}
        .leftSideBar ul.docFilter li {margin-left:0!important; display:block; background:#edeef0; color:#253b78; border-bottom:1px solid #d7e0e0; padding:7px;}
        .leftSideBar ul.docFilter li > input[type=checkbox]{position:relative; margin-right:5px; top:2px;}
        .leftSideBar ul.docFilter h4 {display:block; background:#edeef0; color:#253b78; margin-bottom:0!important; border-bottom:1px solid #d7e0e0; border-top:1px solid #d7e0e0; padding:10px 7px;}
        .tempWrapper .expandTool {text-align:right;}
        .tempWrapper .expandTool span {display:inline-block; margin:5px; font-weight:bold; color:#0f81bb; cursor:pointer; }
        .contenWrapper { margin-top:11px;}
        /* Generic Accordian Styles */
        .ipmAccordian {display:block;}
        .ipmAccordian .aHead {display:block;}
        .ipmAccordian > .ipmAcrdnExpand {border:1px solid #dce3e2; display:block; border-top:none!important; margin-bottom:10px;}        
        .ipmAccordian > .aHead {color: #253b78;font-size: 1.5em;font-weight: bold;display: block;background: #f7f7f7;border: 1px solid #dce3e2;margin-bottom: 2px;padding: 13px 10px 14px;}
        .ipmAccordian > .ipmAcrdnExpand > .aHead {color:#0f7fb8!important; font-size:1.2em; font-style:normal; font-weight:bold; display:block;border-bottom:1px solid #dce3e2; margin:0 20px; padding:12px 0;}
        .ipmAccordian > .ipmAcrdnExpand > .ipmAcrdnExpand > .aHead {font-size:1em;font-style:normal;font-weight:bold;color:#0f7fb8; display:block; border-bottom:1px solid #eee; padding: 12px 0 15px; margin:0 0 0 20px;}
        .ipmAccordian > .ipmAcrdnExpand > .ipmAcrdnExpand > .aHead:first-child {padding-top:2px;}
        .ipmAccordian .ipmAcrdnExpand .ipmAcrdnExpand {padding:10px 20px 0 45px;display:block;}
        .ipmAccordian .ipmAcrdnExpand .col-sm-3 {padding-right:0!important; position:relative;}
        .ipmAccordian .ipmAcrdnExpand .ipmAcrdnExpand .ipmAcrdnExpand {padding:10px 10px 0 45px;display:block;}
        .ipmAccordian .ipmAcrdnExpand {color:#797979;display:block;}
        .ipmAccordian > .aHead span.expico {display: inline-block; cursor:pointer; font-family: FontAwesome;width: 21px;height: 21px;text-align: center;font-weight: normal;line-height: 23px;background: #81bd42;position: relative;margin-right: 5px;
        font-size: 0.8em;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;color: #fff;}
        .ipmAccordian .ipmAcrdnExpand .aHead span.expico {display: inline-block; cursor:pointer; font-family: FontAwesome;width: 16px;height: 16px;text-align: center;font-weight: normal;line-height: 17px;background: #d4d4d4;position: relative;margin-right: 5px;
        font-size: 0.7em;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;color: #fff;}
        .ipmAccordian span.wrpHead {display: inline-block;padding: 5px 10px 5px 0;border-right: 1px solid #797979;}
        .ipmAccordian .Filled-in {display: inline-block;padding: 0 8px;margin-left: 5px; border-left: 1px solid #797979; color:#e68627!important;font-size:13px!important; font-weight:normal!important; }
        .ipmAccordian .Not.Started {display: inline-block;padding: 0 8px;margin-left: 5px; border-left: 1px solid #797979; color:#797979!important;font-size:13px!important; font-weight:normal!important; }
        .ipmAccordian .Excluded {display: inline-block;padding: 0 8px;margin-left: 5px; color:#222!important; background:#ebebeb; font-size:13px!important; font-weight:normal!important; }
        .ipmAccordian span.lastupdate {display:block; margin: 6px 0 0 0; color:#d4d4d4!important; font-weight:normal!important; }        
        .ipmAccordian .acHead {padding-top:4px;}
        .ipmAccordian .lastUpdate {color:#c2c2c2; display:block; margin-top:10px;font-size:0.9em;}
        .messageBox .SecButtonSet {margin-top:0!important;margin-right:10px!important; position:relative; top:2px;}
        .messageBox .SecButtonSet .icoButton {width:16px!important;height:16px!important;top: -2px; }
        .messageBox .SecButtonSet a {display:block; float:left; border:1px solid #015ba7; cursor:default; border-radius:50%; -moz-border-radius:50%; -webkit-border-radius:50%;}
        .messageBox .SecButtonSet span.msgTxt {position: relative; top: -2px; display:block; margin-left:25px;text-align:left;}
        
        
        .ipmAccordian .SecButtonSet {display:inline-block; text-align:right; margin-top:-5px;}
        .ipmAccordian .SecButtonSet .icoButton {display:inline-block;width:30px; margin: 0 5px; height:30px;border:1px solid #1568b6;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;}
        
        .ipmProjectDetails .SecButtonSet {display:inline-block; text-align:right; position:relative;}

       
        .StatusComment {background:#d9ecc6;border:1px solid #bdbdbd;margin-top:20px;margin-bottom:20px;}
        .StatusComment .panelTitle {font-size:1.2em; font-weight:bold;color: #364354; margin:0px 20px 0; padding:15px 0px; border-bottom:1px solid #aecaab;}
        .StatusComment .panelRow {margin: 10px 20px 0;border-bottom:1px solid #aecaab;}
        .StatusComment .innerHead {font-weight:bold; color:#333333;margin-left:10px;}
        .StatusComment .updateStatus {color:#666;}
        .StatusComment .panelRow:last-child {border:none!important;}
        .StatusComment .marginbottom {margin-bottom:6px;}
        .StatusComment .txtRight{text-align:right;}                
        /* ipmModal Styles */
        #ipmModal .modal-header{background: url({!URLFOR($Resource.ipmResourceRevamp, '/images/pop_header.png')}) repeat-x !important;padding:17.5px 10px 17.5px 17.5px; border-bottom:1px #d7d7d7 solid;border-radius:3px;-webkit-border-radius:3px;}
        #ipmModal .modal-title{color:#253b78 !important;font-weight:bold;font-size:1em;}
        #ipmModal .modal-header button.close{border: 1px #007dbb solid;border-radius: 50%;padding: 3px 5px;color: #007dbb;width: 30px; background: #fff; margin-top:-8px;opacity: 1;}
        #ipmModal .modal-content{border-radius:3px;height:100%;}
        #ipmModal .modal-body{height:90%;}
        #ipmModal .modal-dialog{margin:15px auto;}
        .dropdown-menu{min-width:246px;left:2px;}
               
        .messageBox{color:#0f81bb;background:#dbefff;border:1px solid #007DBB;position:relative;border-radius:3px;margin-left:60px;padding:7px;}
         .closeMessage{color: #000;position: absolute;right: 6px;top:7px;cursor:pointer;}
       .rHead{color: #797979;font-size: 0.8em;font-weight: normal;}
         .greyline{color:#333;font-size:1em;border-top: 1px solid #aecaab;padding:0;margin-top:10px;}
       .greyline>div {padding-top:10px;}
       .commentPanel{margin-top:10px;padding-left:0px;}
       .user{font-size:1em;font-weight:bold;color:#666666;padding-right:10px;border-right:1px solid #252525;padding-top:3px;padding-bottom:3px;margin-right:10px;}
       .action-txt{font-size:1em;font-weight:bold;color:#585858;}
       .status-date{font-size:0.8em;font-weight:normal;color:#797979;}
       .pageContent {position:relative;}
       .pageContent .initFilter {background:#fff url({!URLFOR($Resource.ipmResourceRevamp, 'images/ajax-loader.gif')}) no-repeat center 40px; width:100%; height:100%; padding: 20px; color:#000;  text-align:center; position:absolute; z-index:100; display:block; opacity:0.9; -moz-opacity:0.9; -webkit-opacity:0.9; filter:alpha(opacity=90); }
        .circular.ipmImage {border-radius: 500rem !important;}
        .message .messageText h4{display:none;}

    .heading3{text-transform:none!important;padding:10px;margin-top:10px;}
    .staticLabel2{padding-left:10px;}
    tr.innertd td{padding-left:11px;font-weight:Bold;font-size:15px;color:#3b516d;}
    .ipmFinancetable thead th{height:40px;background-color:#dceefa;}
    .ipmFinancetable tr{height:35px;}
    .finproject{font-weight:Bold;font-size:15px;color:#3b516d;}
    .fintotal{font-weight:Bold;font-size:19px;color:#253b78;}
    .fintable td{font-size:15px;color:#364354;}
    .fintlegreenbg{background-color:#f3ffe7;}
    .fintlegrybg{background-color:#f8f8f8;}
    .fintleblubg{background-color:#f2f8fc !important;}
    .fininnertable td + td{font-weight:Bold;font-size:15px;color:#666666;}
    .greenplus{font-weight:bold;font-size:15px;color:#81bf42 !important;} 
    .redminus{font-weight:bold;font-size:15px;color:#d01620 !important;} 
    .fa-angle-left:before{content: "\f104";font-size: 28px;background-color: #e5f8ff;padding: 10px;color: #007dbb;}
    .blockPos{position: relative;text-align: right;top: 38px;}
    .drpfield{padding:6px;border-radius:4px;}
    .table-bordered>thead>tr>th, .table-bordered>thead>tr>td {border-bottom-width: 0px;}
    .fa-star-o:before{font-size:18px;}
    .leftsidemenu{font-weight:bold;font-size:16px;color:#3b516d;}
    .initAccordian {cursor:pointer;}
    .progresscode{border-left:3px solid #e98824;}
    .submitcode{border-left:3px solid #81bf42;}
    .notstartedcode{border-left:3px solid #666;}
    .docFilter li:first-child{background-color:#f8f8f8 !important;}
    .docFilter li:first-child + li{background-color:#eee;}
    .docFilter li:first-child + li + li{background-color:#d8dce6;}
    .fa-minus:before{font-size:16px;}
    .substatus{color:#e98824;}
    .progresstatus{color:#81bf42;}
    .notstarted{color:#666;}
    .ipmfinHeading1{font-weight:bold;font-size:1.2em;color:#253b78;padding:10px 0px;}
    .ipmfinHeading2{font-weight:bold;font-size:1.2em;color:#364354;padding:10px 0px;}
    .tab-panel{position: relative;bottom: 44px;}
    .nav-tabs>li.active>a, .nav-tabs>li.active>a:hover, .nav-tabs>li.active>a:focus {
color: #007dbb !important;font-size:1em !important;font-weight:bold;}
.nav-tabs>li>a{color: #666 !important;font-size:1em !important;font-weight:bold;}
          .finwrapper{position: relative;bottom: 0px;}
    <!--Header css-->
    
    <!-- MISALIGNMENT CSS -->
    .fintabbg{background-color: #edfaff;margin-top:20px;}
    .bluehr{border-bottom:1px solid #9eceea;width:75%;}
    .finuploadbutton{width:76%;}
.finuploadbutton div{float:left;padding-right:30px;}
.finupldheader{color:#0f81bb;font-size:1em;font-weight:bold;padding-top:10px;}
.icoexcel{display:block;width:50px;height:50px;margin-top: 18px;}
.upldtext{font-size:1.2em;font-weight:bold;margin-bottom:10px;color:#abb9be;width:76%;border: 1px dotted #007DBB;background-color: #edfaff;text-align:center;border-radius:4px;}
.upldtext > span {display:block; text-align:center; padding:20px 0;}
.chooseFile{position: relative;top: 1px;left: 1px;background-color: #fff;padding: 6px;border: 1px solid #ddd;}
.icoclose{display: block;width: 32px;height: 32px;float:right;margin-right: 17px;cursor:pointer;}
</style>    
    <apex:composition template="ipmTemplateRevamp2">
        <apex:define name="body">
            <apex:form >
                <div class="gradientbg">
                    <div class="row">
                        <c:ipmProjectDetailsRevampNew />
                    </div>
                    <div class="row">
                        <c:ipmNavMenuRevamp2 activeItem="financials"/>
                    </div>
                </div>

                <!-- Page Head & Toolbar -->
                <div class="row finwrapper">
                    <div class="col-sm-12">
                        <div class="panel-group pageHeadToolbar clearfix">
                            <div class="row">
                                <div class="pull-left">
                                    <h2 class="pageTitle">Download Template - {!project.IPM_Project_Name__c}</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--/ Page Head & Toolbar -->
                
                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel-group pageContent clearfix">
                            <apex:outputPanel id="downloadPanel">
                                <apex:actionFunction name="receiveZip" action="{!receiveZipFile}" rerender="downloadPanel">
                                    <apex:param name="zipdata" assignTo="{!zipFileData}" value="0"/>
                                </apex:actionFunction>
                                <apex:pageMessages />
                                <c:ipmFinancialZipFile name="someZipfile" state="{!fileId}" oncomplete="receiveZip(data);"
                                    getzipfileentry="{!$RemoteAction.ipmDownloadTemplateController.getZipFileEntry}">
                                    <apex:repeat value="{!paths}" var="path">
                                        <c:ipmFinancialZipEntry path="{!path}" base64="true"/>
                                    </apex:repeat>
                                </c:ipmFinancialZipFile>
                                <script>
                                    // Start zip file generation
                                    someZipfileGenerate();
                                </script>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
            </apex:form>
        </apex:define>
    </apex:composition>
</apex:page>