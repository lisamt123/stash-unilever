<apex:page controller="FS_MonthlyPlanningRussia_CX" showHeader="false" contentType="application/vnd.ms-excel#MonthlyPlannerRussiaReport.xls">
      
    <apex:outputPanel rendered="{!isVisible}" id="monthlyPlanner">
    <apex:pageBlock title="Russia Monthly Planner Report">
        <apex:pageBlock title="Month detailed data">
        <apex:pageBlockSection >        
        <apex:outputLabel >Selected Date : </apex:outputLabel>
        <apex:outputText >{!dateName}</apex:outputText>
        <apex:outputLabel >Month start date : </apex:outputLabel>
        <apex:outputText >{!monthStartDate}</apex:outputText>        
        <apex:outputLabel >Month End date : </apex:outputLabel>
        <apex:outputText >{!monthEnddate}</apex:outputText>        
        <apex:outputLabel >No of days in this month : </apex:outputLabel>
        <apex:outputText >{!noofDays}</apex:outputText>
        <apex:outputLabel >Working days excluding weenends and holidays : </apex:outputLabel>
        <apex:outputText >{!workingDays}</apex:outputText>
        <apex:outputLabel >Non working days in this month : </apex:outputLabel>
        <apex:outputText >{!noofWeekends}</apex:outputText>
        <apex:outputLabel >Working days till date</apex:outputLabel>
        <apex:outputText >{!workingDaysTillDate}</apex:outputText>
        <apex:outputLabel >Non Working days till date</apex:outputLabel>
        <apex:outputText >{!noofHolidaysTillDate}</apex:outputText>
            <br/><br/>
    </apex:pageBlockSection>
    </apex:pageBlock>
    <apex:pageblock title="Monthly planner detail for each user">
    <apex:pageBlockSection >
    <apex:pageBlockTable value="{!listMonthlyPlanner}" var="monthlyPlanner">
    <apex:column headervalue="User" value="{!monthlyPlanner.userName}"/>    
    <apex:column headervalue="Monthly Event Plan" value="{!monthlyPlanner.plan}"/>
    <apex:column headervalue="Actual" value="{!monthlyPlanner.actual}"/>
    <apex:column headervalue="Avg" value="{!monthlyPlanner.average} "/>    
    <apex:column headervalue="Actual Working Days Till Date" value="{!monthlyPlanner.actualWorkingDays}"/>
    <apex:column headervalue="Min % which needed to achive today" value="{!monthlyPlanner.target}"/>
    <apex:column headervalue="Critical % which needed to achive today" value="{!monthlyPlanner.criticalTarget}"/>
    </apex:pageBlockTable>
    </apex:pageBlockSection>
        </apex:pageblock>
    </apex:pageBlock>
    </apex:outputPanel>       
    
</apex:page>