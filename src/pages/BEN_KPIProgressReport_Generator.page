<apex:page controller="BEN_KPIProgress_Generator_Controller" standardStylesheets="false" showHeader="false" sidebar="false" renderAs="{!renderAsVar}" action="{!getKPIProgressReport}">
    <div>
        <h3>
            -- KPI Progressing Report --
        </h3>
    </div>
    
    <div align="right" style="font-weight: 500">  Generated By:  {!$User.FirstName} {!$User.LastName}</div>
    <div align="right" style="font-weight: 500">  Date:  {!DAY(Today())} {!CASE(MONTH(Today()), 1, 'January', 2, 'February', 3, 'March', 4, 'April', 5, 'May', 6, 'June', 7, 'July', 8, 'August', 9, 'September', 10, 'October', 11, 'November', 12, 'December', 'Unknown')} {!YEAR(Today())}</div>
    
    <div align="left" style="font-weight: 500; padding-top:40px; padding-bottom:12px;">For period Year/Quarter :   {!selectedInputs}</div>
    
    <p style="font-weight: 600;">  {!allCategories.CategoryName} </p> 
    
    <table cellpadding="0" cellspacing="0" style="width:100%; outline-style: groove; border:4px" title="{!allCategories.CategoryName}" >
        <tr >
            <th style="border-bottom:3px solid #000;padding: 8px;">KPI Period</th>
            <th style="background-color: green">Win</th>
            <th  style="border-bottom:3px solid #000;padding: 8px;background-color: yellow">Parity</th>
            <th  style="border-bottom:3px solid #000;padding: 8px;background-color: #f00">Loss</th>
            <th style="border-bottom:3px solid #000;padding: 8px;">Total #of studies</th>
        </tr>
        <apex:repeat value="{!allCategories.YearQuarWiseCounts}" var="yq">   
            
            <tr>
                <td style="padding: 8px; text-align: left;border: 1px dotted #ddd;">{!yq}</td>
                <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.YearQuarWiseCounts[yq]['WIN']}</td>
                <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.YearQuarWiseCounts[yq]['PARITY']}</td>
                <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.YearQuarWiseCounts[yq]['LOSS']}</td>
                <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.YearQuarWiseCounts[yq]['TOTAL']}</td>
            </tr>
            
        </apex:repeat>
        <tr>
            <td style="padding: 8px; text-align: left;border: 1px dotted #ddd;">{!allCategories.CategoryName}  YTD Results</td>
            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.totalWinPerc}</td>
            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.totalParityPerc}</td>
            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.totalLossPerc}</td>
            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!allCategories.totalsCount}</td> 
        </tr>
    </table>
    <p> </p>
    
    <div>
        <apex:repeat value="{!catWiseDetails}" var="catName">  
            <div>
                <ul>                
                    <p style="font-weight: 600;"> {!catWiseDetails[catName].CategoryName} </p>  </ul>
                <table cellpadding="0" cellspacing="0" style="width:100%; outline-style: groove;" title="{!catWiseDetails[catName].CategoryName}" >
                    <tr >
                        <th style="border-bottom:3px solid #000;padding: 8px;">KPI Period</th>
                        <th style="border-bottom:3px solid #000;padding: 8px;background-color: green">Win</th>
                        <th style="border-bottom:3px solid #000;padding: 8px;background-color: yellow">Parity</th>
                        <th style="border-bottom:3px solid #000;padding: 8px;background-color: #f00">Loss</th>
                        <th style="border-bottom:3px solid #000;padding: 8px;">Total #of studies</th>
                    </tr>
                    <apex:repeat value="{!catWiseDetails[catName].YearQuarWiseCounts}" var="yq">   
                        
                        <tr>
                            <td style="padding: 8px; text-align: left;border: 1px dotted #ddd;">{!yq}</td>
                            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].YearQuarWiseCounts[yq]['WIN']}</td>
                            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].YearQuarWiseCounts[yq]['PARITY']}</td>
                            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].YearQuarWiseCounts[yq]['LOSS']}</td>
                            <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].YearQuarWiseCounts[yq]['TOTAL']}</td>
                        </tr>
                        
                    </apex:repeat>
                    <tr>
                        <td style="padding: 8px; text-align: left;border: 1px dotted #ddd;">{!catWiseDetails[catName].CategoryName}  YTD Results</td>
                        <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].totalWinPerc}</td>
                        <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].totalParityPerc}</td>
                        <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].totalLossPerc}</td>
                        <td style="padding: 8px; text-align: center;border: 1px dotted #ddd;">{!catWiseDetails[catName].totalsCount}</td> 
                    </tr>
                    
                </table>
            </div>
            <p>    </p>
        </apex:repeat>
    </div>
      <p>Disclaimer:  </p>
 <footer style="bottom:0; font-size: 12px; font-family: arial;">
  <p>This file contains confidential and privileged information. Any unauthorized review, use, disclosure or distribution is prohibited. If you are not the intended recipient, please contact the sender by e-mail and destroy all copies of the original.  If you receive this transmission in error, please contact the sender immediately and delete the material from your system.</p>
  </footer>
</apex:page>