<apex:page controller="IPM_RolloutPlansTableController" sidebar="false" showHeader="false" >
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/jquery-ui.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/bootstrap.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Buttons.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'assets/font-awesome/css/font-awesome.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_DropDown.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Modal1.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Table.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Header-new.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_Table.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_RolloutPlans.css')}"/>
    <apex:form >
        <c:IPM_LoadingStatus ></c:IPM_LoadingStatus>
        <apex:outputPanel id="addRolloutUrlStrPanel" styleClass="addRolloutUrlStrClass" >{!addRolloutUrlStr}</apex:outputPanel>
        <apex:outputPanel id="deleteMCORolloutUrlStrPanel" styleClass="deleteMCORolloutUrlStrClass">{!deleteMCORolloutUrlStr}</apex:outputPanel>
        <apex:outputPanel id="cancelRolloutUrlStrPanel" styleClass="cancelRolloutUrlStrClass">{!cancelRolloutUrlStr}</apex:outputPanel>
        <apex:outputPanel id="saveRolloutUrlStrPanel" styleClass="saveRolloutUrlStrClass">{!saveRolloutUrlStr}</apex:outputPanel>
        <apex:outputPanel id="editRolloutUrlStrPanel" styleClass="editRolloutUrlStrClass">{!editRolloutUrlStr}</apex:outputPanel>
        <apex:pageMessages />
        
        <apex:outputPanel rendered="{!isError}">
            <div class="finGreyBG">
                <apex:outputText value="{!errorMessage}" />
            </div>
        </apex:outputPanel> 
        
        <apex:actionStatus startText="" id="Loading2" startStyleClass="proInitLoader"/>  
        <apex:outputPanel id="ParentPanel">
            <div class="row">
                <apex:outputPanel id="topButtonPanel"> 
                    <div class="col-sm-6 pull-left mSpacing">
                        <apex:commandLink reRender="addRolloutUrlStrPanel" styleClass="ipmButton" value="{!$Label.IPM_ADD_EDIT_ROLLOUTS}" action="{!addRollout}" rendered="{!AND(isEditMode,isEditable)}" status="loadingStatus" oncomplete="movetoaddrollouts()" />
                    </div>
                    <div class="col-sm-6 pull-right mSpacing">
                        <apex:commandLink oncomplete="editRolloutFunc();" reRender="editRolloutUrlStrPanel" styleClass="ipmButton primary pull-right" value="{!$Label.IPM_EDIT}" action="{!editRollout}" rendered="{! AND(NOT(isEditMode),isEditable,OR(project.IPM_Phase__c == 'Ideas',project.IPM_Phase__c == 'Feasibility',project.IPM_Phase__c == 'Capability'))}" status="loadingStatus">       
                        </apex:commandLink>
                        
                        <apex:outputPanel rendered="{!AND(isEditMode,projectType.IPM_CreateLocalProjects__c ) }" layout="block"> 
                            <a class="ipmButton primary pull-right focusRolloutmodal" data-toggle="modal" data-target="#ipmRegionalRollout" data-backdrop="static" data-keyboard="false">{!$Label.IPM_SAVE}</a>
                        </apex:outputPanel>
                         
                        <apex:commandLink oncomplete="saveRolloutFuncJs();" reRender="validationErrorPanel,saveRolloutUrlStrPanel" styleClass="ipmButton primary pull-right" value="{!$Label.IPM_SAVE}" action="{!saveRollout}" rendered="{!AND(isEditMode,isEditable,NOT(projectType.IPM_CreateLocalProjects__c))}" status="loadingStatus" onclick="skipValidation();">
                            <apex:param name="p1" assignTo="{!isEditMode}" value="{!$Label.IPM_FALSE}"/>
                        </apex:commandLink>
                        
                        <apex:commandLink reRender="cancelRolloutUrlStrPanel" styleClass="ipmButton pull-right mr10" value="{!$Label.IPM_CANCEL}" action="{!cancelRollout}" rendered="{!AND(isEditable,isEditMode)}" onComplete="aftercancel();" status="loadingStatus" onclick="skipValidation();">
                            <apex:param name="p1" assignTo="{!isEditMode}" value="{!$Label.IPM_FALSE}"/>
                        </apex:commandLink>
                    </div>
                </apex:outputPanel>
            </div>

            <apex:outputPanel id="validationErrorMsg" rendered="{!AND(NOT(ISNULL(validationError)),NOT(ISBLANK(validationError)))}" > 
                <apex:outputText styleClass="rolloutErrorBox" value="{!validationError}" />
            </apex:outputPanel>
            
            <!-- ---- Table Heading for GKM8 starts here  ---------->
            <apex:outputPanel >
                <table class="ipmTable table table-bordered myListTable">
                    <thead class="">
                        <tr>
                            <th width="5px" scope="col" colspan="1"> 
                                <div>
                                    <div class="colCompleted incHeight"><span> </span></div>
                                </div>
                            </th>
                            <th scope="col" width="150px" colspan="1">
                                <div>
                                    <div class="colProject incHeight"><span>{!$Label.IPM_ROLLOUT_NAME}</span></div>
                                </div>              
                            </th>
                            
                            <th scope="col" width="50px" colspan="1">
                                <div>
                                    <div class="colCategory incHeight"><span>{!$Label.IPM_TARGET_LAUNCH_DATE}</span></div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                </table>
            </apex:outputPanel>
            <!-- ---- Table Heading for GKM8 ends here  ---------->

            <apex:outputPanel id="rolloutsPanel" > 
                <apex:outputPanel id="rolloutPanel" rendered="{!!countryListEmpty}">
                    <div class="tableAccrdion">
                        <div class="ipmAccordion"> 
                                    <div class="projectContainer">
                                        <!-- Regional Rollout Header -->
                                        <div class="pHead">
                                            <table class="rollouttable">   
                                                <thead class="">
                                                    <tr>
                                                        <th scope="col" width="8px" colspan=""> 
                                                            <div class="incHeight">
                                                                <span class="expico fa fa-minus"></span>
                                                            </div>
                                                        </th>
                                                        <th scope="col" width="150px" colspan="">                                                    
                                                            <span class="rollsubhead">
                                                                <strong>
                                                                       {!Project.Name}
                                                                </strong>
                                                            </span>                                        
                                                        </th>
                                                    <th scope="col" width="50px" colspan="1">
                                           <div class="incHeight">
                                                <apex:outputField value="{!project.IPM_Target_Launch_Dates__c}" rendered="{!NOT(isEditMode)}"/>   
                                                <apex:inputField value="{!project.IPM_Target_Launch_Dates__c}" styleClass="dateInputBox calendar" rendered="{!isEditMode}" onchange="checkTLDDate(this)"/>
                                           </div>
                                        </th>     
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="ipmAcrdnExpand">
                                <div class="pt20">
                                    <table class="rollouttable editable">                                 
                                        <tr>
                                            <td scope="col" width="2.3%">
                                                <div class="incHeight">
                                                    <span class="rollsubhead">
                                                    </span>
                                                </div>
                                            </td>
                                           <td width="15%"> 
                                                <strong>MCO: </strong>{!MCOLocalOriginal} 
                                            </td>
                                            <td scope="col" colspan="3" width="40%" class="noBorder">
                                              <span class="separator">
                                                  <strong>{!$Label.IPM_INCLUDED_COUNTRIES}: </strong>
                                                  <apex:variable var="countryString" value="" />
                                                    
                                                  <apex:repeat value="{!localProjectToCountryMap[project.id]}" var="country"> 
                                                      <apex:variable var="countryString" value="{!countryString +','+country.Country_Name__c}" rendered="{!LEN(countryString) > 0}"/>
                                                      <apex:variable var="countryString" value="{!country.Country_Name__c}" rendered="{!LEN(countryString) == 0}"/>
                                                  </apex:repeat>
                                                  <apex:outputText value="{!countryString}"/> 
                                              </span>
                                          </td>
                                      </tr> 
                                  </table>                        
                             </div>                       
                        </div>
                    </div>                                
                </div>
            </div>
        </apex:outputPanel>
        </apex:outputPanel> 
          
            <div class="row"> 
                <apex:outputPanel id="bottomButtonPanel">     
                    <div class="col-sm-6 pull-left mSpacing"> 
                    </div>
                    <div class="col-sm-6 pull-right mSpacing">
                        <apex:outputPanel rendered="{!AND(isEditMode,projectType.IPM_CreateLocalProjects__c) }" layout="block"> 
                            <a class="ipmButton primary pull-right" data-toggle="modal" data-target="#ipmRegionalRollout" data-backdrop="static" data-keyboard="false">{!$Label.IPM_SAVE}</a>
                        </apex:outputPanel> 
                        
                        <apex:commandLink oncomplete="saveRolloutFuncJs();" reRender="validationErrorPanel,saveRolloutUrlStrPanel" styleClass="ipmButton primary pull-right" value="{!$Label.IPM_SAVE}" action="{!saveRollout}" rendered="{!AND(isEditMode,isEditable,NOT(projectType.IPM_CreateLocalProjects__c))}" status="loadingStatus" onclick="skipValidation();">
                            <apex:param name="p1" assignTo="{!isEditMode}" value="{!$Label.IPM_FALSE}"/>
                        </apex:commandLink>
                        
                        <apex:commandLink oncomplete="editRolloutFunc();" reRender="editRolloutUrlStrPanel" styleClass="ipmButton primary pull-right" value="{!$Label.IPM_EDIT}" action="{!editRollout}" rendered="{!AND(NOT(isEditMode),isEditable,OR(project.IPM_Phase__c == 'Ideas',project.IPM_Phase__c == 'Feasibility',project.IPM_Phase__c == 'Capability'))}" status="loadingStatus">
                            <apex:param name="p1" assignTo="{!isEditMode}" value="{!$Label.IPM_TRUE}"/>
                        </apex:commandLink>
                        
                        <apex:commandLink reRender="cancelRolloutUrlStrPanel" onComplete="aftercancel();" styleClass="ipmButton pull-right mr10" value="{!$Label.IPM_CANCEL}" action="{!cancelRollout}" rendered="{!AND(isEditable,isEditMode)}" status="loadingStatus" onclick="skipValidation();">
                            <apex:param name="p1" assignTo="{!isEditMode}" value="{!$Label.IPM_FALSE}"/>
                        </apex:commandLink>
                    </div>
                </apex:outputPanel>
            </div>
            <apex:actionFunction name="reRenderPanels" reRender="topButtonPanel,ParentPanel,bottomButtonPanel,hideUser,reRenderPanels,validationErrorMsg" status="loadingStatus" oncomplete="selectDrpdown();"/>
            
        </apex:outputPanel>
        
    </apex:form>
    <apex:includeScript value="{!URLFOR($Resource.IPM_Resource, 'js/jquery.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.IPM_Resource, 'js/bootstrap.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.IPM_Resource, 'js/IPM_functions.js')}"/>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/iframeResizer.contentWindow.min.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_Accordion.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_RolloutPlansjs.js')}" type="text/javascript"></script>
    
    <apex:outputpanel id="validationErrorPanel" >
        <script>
            var IPMProAppRP = {wmessage:'{!$Label.IPM_Unsaved_Alert}'};
            var validationErrorJs = '{!validationError}';
        </script>   
    </apex:outputpanel>
    
</apex:page>