<!-- Created By : Pratyusha Penugondla
     Description:This is a demo page ,
     will make it as a component after analyzing the usage of this functionality
     -->     
<apex:page controller="IPM_CommentsListController" title="COMMENTS" sidebar="false" showHeader="false">
<apex:form >
<apex:stylesheet value="{!URLFOR($Resource.ipmResourceRevamp, 'css/bootstrap.min.css')}"/>
<apex:stylesheet value="{!URLFOR($Resource.ipmResourceRevamp, 'css/ipmStyles.css')}"/>
<apex:stylesheet value="{!URLFOR($Resource.ipmResourceRevamp, 'css/ipmButtons.css')}"/>
<apex:includeScript value="{!URLFOR($Resource.ipmResourceRevamp, 'js/jquery.js')}"/>
<style>
.secUsersComments {color:#636363;}
.secUsersComments .right {text-align:right;}
.secUsersComments .listComments .row {margin-left: -5px!important;margin-right: -5px!important; margin-top:10px;}
.secUsersComments .listComments .rowList {border-bottom:1px solid #ddd; margin-bottom:10px; padding-bottom:10px;} 
.secUsersComments .listComments .cTime {text-align:right;font-size:0.9em;}
.secUsersComments .listComments .delete {text-align:right;}
.secUsersComments .listComments .secName {font-weight:bold;}
.secUsersComments .listComments .panel-group {margin-bottom:0!important;}
.secUsersComments .panel{-webkit-box-shadow:none!important; box-shadow: none!important;word-wrap:break-word;}
.secUsersComments textarea {width:100%; border: 1px solid #929292; padding:5px; margin:15px 0 10px; height:100px;}
.secUsersComments .secButtonSet {text-align:right;}
.secUsersComments .btn {padding:.8em!important;}
.secUsersComments .SecButtonSet {display:inline-block; text-align:right; margin-top:7px;}
.secUsersComments .SecButtonSet .icoButton {display:inline-block;width:30px; margin: 0 5px; height:30px;border:1px solid #1568b6;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;}
.secUsersComments .col-xs-11{padding:0 0 0 5px!important;}
.secUsersComments .col-xs-1 {padding:0 5px 0 10px!important;}
.secUsersComments .col-xs-1 img {border: 1px solid #1568b6;}
</style>
<!-- To display the text area to input the comments and a button to add the comments -->
<div class="col-xs-12 secUsersComments">
<div class="panel">
 <apex:pagemessages id="pgmsg"/>
<div class="row">
    <div class="col-xs-12">
        <div class="panel" id="CommentText">
       
        <apex:inputTextarea value="{!CommentRecord.Body}" html-placeholder="Add your comments here" />
        <!--<apex:inputField value="{!CommentRecord.Body}" />-->
    </div>
    </div>
   </div>
   <div class="row clearfix">
    <div class="col-xs-6 secButtonSet pull-right">
        <div class="panel">
        <apex:commandButton value="Add Comment" styleClass="ipmButton primary"  action="{!AddComment}" reRender="onLoadComments1,pgmsg,viewall" onComplete="window.location.reload()"/>
        </div>
    </div>
  </div>  

<!-- To display the records on load and also on click of viewOtherComments -->
<apex:outputPanel id="onLoadComments1">
<!--<apex:dataTable value="{!CommentsWrapper}" var="Cmnts">
<apex:column >
    <apex:image url="{!Cmnts.smallphotoUrl}" id="plImage" styleClass="circular ipmImage"  /> 
    <apex:outputField value="{!Cmnts.feedItem.CreatedBy.name}"/><br/>
    <apex:outputField value="{!Cmnts.feedItem.body}"/><br/>
    <apex:outputText value="Commented On"/>
    <apex:outputField value="{!Cmnts.feedItem.CreatedDate}"/>
    <apex:commandLink value="Delete" action="{!doDelete}" onComplete="window.location.reload()">
    <apex:param name="CommentID" value="{!Cmnts.feedItem.Id}" assignTo="{!CommentsID}"/>
    </apex:commandLink> 
</apex:column>
</apex:dataTable>-->

<div class="row listComments">
    <div class="col-xs-12">
        <div class="panel-group">

<apex:repeat value="{!CommentsWrapper}" var="cmnts">
        <div class="row rowList clearfix">
        <div class="col-xs-1">
        <div class="row">
        <div class="panel">
        <apex:image url="{!cmnts.smallphotoUrl}" id="plImage" styleClass="circular ipmImage"  /> 
        </div>
        </div>
        </div>
        <div class="col-xs-11">
        <div class="panel-group">
        <div class="row">        
        <div class="col-xs-5">       
        <div class="panel secName ">
        <apex:outputText value="{!cmnts.feedItem.CreatedBy.name}"/>
        </div>
        </div>
        <div class="col-xs-7"> 
        <div class="panel cTime">
        Commented on: &nbsp;<apex:outputText value="{!cmnts.feedItem.CreatedDate}"/>
        </div>
        </div>
        </div>
        <div class="row">        
        <div class="col-xs-10">       
        <div class="panel">
        <apex:outputText value="{!cmnts.feedItem.body}" />
        </div>
        </div>
        <div class="col-xs-2 right">       
        <div class="panel SecButtonSet delete">
        <apex:commandLink styleClass="icoButton delete" action="{!doDelete}" onComplete="window.location.reload()">
            <apex:param name="CommentID" value="{!cmnts.feedItem.Id}" assignTo="{!CommentsID}"/>
        </apex:commandLink> 
        </div>
        </div>
        </div>
        </div>
        </div> 
        </div>          
</apex:repeat>
 </div>
  </div>
</div>
</apex:outputPanel>
<div class="row">
    <div class="col-xs-12">
        <div class="panel">
<apex:commandLink id="viewall" value="View Other Comments" reRender="onLoadComments" action="{!onLoadComments}"  rendered="{! If(countOfComments>5,'true','false')}"/> 
         </div>
      </div> 
      </div>
    </div>
  </div>
<script>
var jq= jQuery.noConflict();
jq("textarea[placeholder]").each(function () {
        var $this = jq(this);
        $this.css({"color":"#ddd","font-style":"italic"});
        if($this.text() != "Add your comments here"){
            $this.text($this.attr("placeholder")).focus(function(){
                if($this.text() == $this.attr("placeholder")) {
                    $this.text("").removeAttr("style");
                }
            }).blur(function(){
                if($this.text() == "Add your comments here") {
                    $this.text($this.attr("placeholder")).css({"color":"#ddd","font-style":"italic"});
                }
            });
        }
    });
</script>
</apex:form>
</apex:page>