<apex:page docType="html-5.0" title="File Uploader" controller="BET_MultiUploadAssetsController" showHeader="false">
  <apex:stylesheet value="{!$Resource.BET}/css/BETMultiUploadAssets.css" />

  <h3>{!$Label.BET_Select_Files}</h3>
  <form >
    <input id="multiplefiles" type="file" multiple="multiple" onchange="filesSelected()"/>
  </form>
  <p class="form-errors"></p> 
  <br />

  <table width="100%" class="multiFileUploadTable" id="inputFiles">
    <th class="multiFileUploadTableHeaderStyle" style="width:120px;">{!$Label.BET_Upload_Status}</th>
    <th class="multiFileUploadTableHeaderStyle" style="">{!$Label.BET_File_Name}</th>
    <th class="multiFileUploadTableHeaderStyle" style="">{!$Label.BET_Asset_Name}</th>
    <th class="multiFileUploadTableHeaderStyle" style="width:100px;">{!$Label.BET_Asset_Type}</th>
    <th class="multiFileUploadTableHeaderStyle" style="">{!$Label.BET_Asset_Media_Type}</th>
    <th class="multiFileUploadTableHeaderStyle" style="">{!$Label.BET_Asset_Country}</th>
    <th class="multiFileUploadTableHeaderStyle" style="">{!$Label.BET_Asset_Status}</th>
  </table>

  <br />  
  <input id="resultFileId" type="hidden" name="resultFileId" />
  <button onclick="loadFiles(); return false;" style="background: #e6007e;color:white;width:120px;height:30px;font-size:15px;">{!$Label.BET_Upload_Files}</button> 
  
  <apex:includeScript value="{!$Resource.BET}/scripts/jquery.min.js" />   
  

  <script type="text/javascript">
    var __sfdcSessionId = '{!GETSESSIONID()}';
    var groupId = "{!chatterGroupId}"; 
    var betId = "{!betId}";
    var liMediaType = {!AvailableMediaTypes};
    var liCountries = {!AvailableCountries};
    var liStatus = {!AvailableStatus};
    var NO_ASSET_NAME = "{!$Label.BET_Asset_Name_Mandatory}";
    var NO_COUNTRY_SELECTED = "{!$Label.BET_Asset_Country_Mandatory}";
    var NO_FILE_SELECTED = "{!$Label.BET_Asset_No_Files_Selected}";

    function labelFile(idx,assetName,mediaType,country,status,betId,index){
      Visualforce.remoting.Manager.invokeAction(
        '{!$RemoteAction.BET_MultiUploadAssetsController.saveFileAndConnect}',
        idx,
        assetName,
        mediaType,
        country,
        status,
        betId,
        function(result, event){
          if (event.status) {
            if(result == null) {
              jQuery(".uploadStatusCell:eq("+index+")").html('{!$Label.BET_Asset_Uploaded}');
            } else {
              jQuery(".uploadStatusCell:eq("+index+")").html('{!$Label.BET_Asset_Not_Uploaded}');
              jQuery('.form-errors').html(result);
              jQuery('.form-errors').show();
            }
          } else {
            jQuery(".uploadStatusCell:eq("+index+")").html('{!$Label.BET_Asset_Not_Uploaded}');
            jQuery('.form-errors').html(result);
            jQuery('.form-errors').show();
          }
        },
        {escape: true}
      );
    }

  </script>

  <apex:includeScript value="{!$Resource.BET}/scripts/BETMultiUploadAssets.js" />

</apex:page>