<!-- 
*************************************************
*@Description: To use in project cluster standard page. This page is used to show included projects in 
current cluster and also to add new projects in the current cluster
*@Author: Cognizant
*@Created Date: 01-02-2017
*************************************************
-->

<apex:page standardController="IPM_Clusters__c" extensions="IPM_ProjectsClustersMappingController" >
    <apex:stylesheet value="{!URLFOR($Resource.IPM_Resource, 'css/IPM_ProjectsClustersMapping.css')}"/>
    <apex:form >
        <apex:outputPanel id="fullDataPanel">
            <apex:pageMessages />
            <table width="100%">
                <tr>
                    <td width="50%" valign="top" align="center">
                        
                        <!-- PANEL FOR AVAILABLE PROJECTS -->
                        <apex:outputPanel id="available_projects_list">
                            
                            <!-- BUTTONS ON TOP FOR AVAILABLE PROJECTS -->
                            <apex:outputPanel layout="block">
                                <apex:commandButton styleClass="uniformbtnwidthtop" action="{!clearSelectedProjects}" rerender="available_projects_list" value="{!$Label.IPM_Clusters_Clear_Selection}" status="addProjectsStatus"/>
                                <apex:commandButton styleClass="uniformbtnwidthtop" action="{!processSelectedProjects}" rerender="fullDataPanel" value="{!$Label.IPM_Clusters_Add_Projects}{!IF(AND(selectedProjectMap!=null, selectedProjectMapSize>0),' - ','')}{!IF(AND(selectedProjectMap!=null, selectedProjectMapSize>0),selectedProjectMapSize,'')}" status="addProjectsStatus" />
                                <apex:inputText styleClass="uniformbtnwidthtop searchinputclass" value="{!searchProjectName}" onkeypress="return handleKeyPress(event);" html-placeholder="Search" />
                                <apex:image styleClass="srchImage" value="{!URLFOR($Resource.IPM_Resource, 'images/search.svg')}" onclick="searchAf();" />
                                <apex:actionFunction name="searchAf" rerender="available_projects_list" action="{!searchProjects}" status="addProjectsStatus" />
                                <apex:actionStatus id="addProjectsStatus" startText="Please wait..." stopText="">
                                    <apex:facet name="start">
                                        <img src="/img/loading.gif" />
                                    </apex:facet>
                                    <apex:facet name="stop">
                                        <input class="statusplaceholderclass"/>
                                    </apex:facet>
                                </apex:actionStatus>
                            </apex:outputPanel>
                            
                            <!-- TABLE FOR AVAILABLE PROJECTS -->
                            <apex:outputPanel styleClass="blockheightclass" layout="block">
                                <apex:pageblock >
                                    <apex:pageblockSection title="{!$Label.IPM_Clusters_Available_Projects}" columns="1" >
                                        <apex:pageBlockTable value="{! projects}" var="p" >
                                            <apex:column headerValue="Select" >
                                                <apex:inputCheckbox value="{! p.isSelected}" disabled="{!p.projectrecord.IPM_Cluster__c!=''}" />
                                            </apex:column>
                                            <apex:column value="{! p.projectrecord.IPM_Project_Name__c}" />
                                            <apex:column value="{! p.projectrecord.IPMProject_Span__c}" />
                                            <apex:column value="{! p.projectrecord.IPM_Project_Y3iTO__c}" />
                                        </apex:pageBlockTable>
                                    </apex:pageblockSection>
                                </apex:pageblock>
                            </apex:outputPanel>
                            
                            <!-- NAVIGATION FOR AVAILABLE PROJECTS -->
                            <apex:outputPanel layout="block" html-align="center">
                                
                                <apex:commandButton id="first" status="fetchStatus" styleClass="uniformbtnwidthbottom" reRender="available_projects_list" value="{!$Label.IPM_First}" action="{!first}" disabled="{!!hasPrevious}" title="First Page"/>
                                <apex:commandButton id="prev" status="fetchStatus" styleClass="uniformbtnwidthbottom" reRender="available_projects_list" value="{!$Label.IPM_Previous}" action="{!previous}" disabled="{!!hasPrevious}" title="Previous Page"/>
                                <apex:outputText id="pageno" >&nbsp; Records {!IF(AND(size!=Null,noOfRecords!=Null,noOfRecords>0),(pageNumber * size)+1-size,0)}-{!IF(AND(size!=Null,noOfRecords!=Null,(pageNumber * size)>noOfRecords), noOfRecords,(pageNumber * size))} of {!noOfRecords} &nbsp;</apex:outputText>
                                <apex:commandButton id="next" status="fetchStatus" styleClass="uniformbtnwidthbottom" reRender="available_projects_list" value="{!$Label.IPM_Next}" action="{!next}" disabled="{!!hasNext}" title="Next Page"/>
                                <apex:commandButton id="last" status="fetchStatus" styleClass="uniformbtnwidthbottom"  reRender="available_projects_list" value="{!$Label.IPM_Last}" action="{!last}" disabled="{!!hasNext}" title="Last Page"/>
                                
                                <apex:outputPanel styleClass="statusPadding">
                                    <apex:actionStatus id="fetchStatus" startText="Fetching..." stopText="">
                                        <apex:facet name="start">
                                            <img src="/img/loading.gif" />
                                        </apex:facet>
                                        <apex:facet name="stop">
                                            <input class="statusplaceholderclass"/>
                                        </apex:facet>
                                    </apex:actionStatus>
                                </apex:outputPanel>
                                
                            </apex:outputPanel>
                            
                        </apex:outputPanel>
                        
                    </td>
                    
                    <td width="50%" valign="top" align="center">
                        
                        <!-- PANEL FOR EXISTING PROJECTS -->
                        <apex:outputPanel id="projects_list_in_cluster">
                            
                            <!-- BUTTONS ON TOP FOR EXISTING PROJECTS -->
                            <apex:outputPanel layout="block">
                                <apex:outputPanel styleClass="ythreeiTOStyle">Y3iTO = {!CurrentClusterY3ito}</apex:outputPanel>
                                <apex:commandButton styleClass="uniformbtnwidthtop" action="{!clearRemovalProjects}" rerender="projects_list_in_cluster" value="{!$Label.IPM_Clusters_Clear_Selection}" status="removeProjectsStatus" />
                                <apex:commandButton styleClass="uniformbtnwidthtop" action="{!processRemovalProjects}" rerender="fullDataPanel" value="{!$Label.IPM_Clusters_Remove_Projects}{!IF(AND(removalProjectMap!=null, removalProjectMapSize>0),' - ','')}{!IF(AND(removalProjectMap!=null, removalProjectMapSize>0),removalProjectMapSize,'')}" status="removeProjectsStatus" />
                                <apex:outputPanel styleClass="statusPadding">
                                    <apex:actionStatus id="removeProjectsStatus" startText="Please wait..." stopText="">
                                        <apex:facet name="start">
                                            <img src="/img/loading.gif" />
                                        </apex:facet>
                                        <apex:facet name="stop">
                                            <input class="statusplaceholderclass"/>
                                        </apex:facet>
                                    </apex:actionStatus>
                                </apex:outputPanel>                                
                            </apex:outputPanel>
                            
                            <!-- TABLE FOR EXISTING PROJECTS -->
                            <apex:outputPanel styleClass="blockheightclass" layout="block">
                                <apex:pageblock >
                                    <apex:pageblockSection title="{!$Label.IPM_Clusters_Existing_Projects}" columns="1" >
                                        <apex:pageBlockTable value="{! ProjectsInCurrentCluster}" var="p" >
                                            <apex:column headerValue="Select" rendered="{!AND(cnoOfRecords!=Null,cnoOfRecords>0)}" >
                                                <apex:inputCheckbox value="{! p.isSelected}" disabled="{!p.projectrecord.IPM_Cluster__c==''}"/>
                                            </apex:column>
                                            <apex:column value="{! p.projectrecord.IPM_Project_Name__c}" />
                                            <apex:column value="{! p.projectrecord.IPMProject_Span__c}" />
                                            <apex:column value="{! p.projectrecord.IPM_Project_Y3iTO__c}" />
                                        </apex:pageBlockTable>
                                    </apex:pageblockSection>
                                </apex:pageblock>
                            </apex:outputPanel>
                            
                            <!-- NAVIGATION FOR EXISTING PROJECTS -->
                            <apex:outputPanel layout="block" html-align="center">
                                <apex:commandButton id="cfirst" status="cfetchStatus" styleClass="uniformbtnwidthbottom" reRender="projects_list_in_cluster" value="{!$Label.IPM_First}" action="{!cfirst}" disabled="{!!chasPrevious}" title="First Page"/>
                                <apex:commandButton id="cprev" status="cfetchStatus" styleClass="uniformbtnwidthbottom" reRender="projects_list_in_cluster" value="{!$Label.IPM_Previous}" action="{!cprevious}" disabled="{!!chasPrevious}" title="Previous Page"/>
                                <apex:outputText id="cpageno" >&nbsp; Records {!IF(AND(size!=Null,cnoOfRecords!=Null,cnoOfRecords>0),(cpageNumber * size)+1-size,0)}-{!IF(AND(size!=Null,cnoOfRecords!=Null,(cpageNumber * size)>cnoOfRecords), cnoOfRecords,(cpageNumber * size))} of {!cnoOfRecords} &nbsp;</apex:outputText>
                                <apex:commandButton id="cnext" status="cfetchStatus" styleClass="uniformbtnwidthbottom" reRender="projects_list_in_cluster" value="{!$Label.IPM_Next}" action="{!cnext}" disabled="{!!chasNext}" title="Next Page"/>
                                <apex:commandButton id="clast" status="cfetchStatus" styleClass="uniformbtnwidthbottom" reRender="projects_list_in_cluster" value="{!$Label.IPM_Last}" action="{!clast}" disabled="{!!chasNext}" title="Last Page"/>
                                <apex:outputPanel styleClass="statusPadding">
                                    <apex:actionStatus id="cfetchStatus" startText="Fetching..." stopText="">
                                        <apex:facet name="start">
                                            <img src="/img/loading.gif" />
                                        </apex:facet>
                                        <apex:facet name="stop">
                                            <input class="statusplaceholderclass"/>
                                        </apex:facet>
                                    </apex:actionStatus>
                                </apex:outputPanel>
                            </apex:outputPanel>
                            
                        </apex:outputPanel>
                        
                    </td>
                </tr>
            </table>
            
        </apex:outputPanel>
        
    </apex:form>
    <script src="{!URLFOR($Resource.IPM_Resource, 'js/IPM_ProjectsClustersMapping.js')}" type="text/javascript"></script>
</apex:page>